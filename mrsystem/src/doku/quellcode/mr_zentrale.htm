<HTML>
<HEAD>
<TITLE>Zentrale</TITLE>
</HEAD>
<BODY>
<H1>Zentrale</H1>
<P>
Die Zentrale kennt 2 Betriebsmodi. F&uuml;r beide Betriebsmodi gibt es eine
eigene State Machine. Die verschiedenen States dienen dem Abfragen der CFG
Daten (cs2 Dateien, ...).
<P>
<UL>
<LI><A HREF="#proxy">Proxy Mode</A>
<LI><A HREF="#zentrale">MS2 und Software sind Zentrale</A>
</UL>
<P>
<H2>Die Dateien</H2>
<P>
Der quellcode der Zentrale ist auf die folgenden Dateien aufgeteilt:
<P>
<TABLE BORDER="1">
<TR>
<TD>canmember.c<BR>canmember.h</TD>
<TD>Verwaltung der am CAN Bus erkannten Ger&auml;te</TD>
</TR>
<TR>
<TD>cron.c<BR>cron.h</TD>
<TD>Verwaltung zeitgesteuerter Abl&auml;ufe</TD>
</TR>
<TR>
<TD>cs2cfg.c<BR>cs2cfg.h</TD>
<TD>Behandlung des CFG Data Streams</TD>
</TR>
<TR>
<TD>fahrstrasse.c<BR>fahrstrasse.h</TD>
<TD>Verwaltung der Fahrstra&szlig;en</TD>
</TR>
<TR>
<TD>fsstat.c<BR>fsstat.h</TD>
<TD>Verwaltung des Fahrstra&szlig;enstatus</TD>
</TR>
<TR>
<TD>gbsstat.c<BR>gbsstat.h</TD>
<TD>Verwaltung des Gleisbildstatus</TD>
</TR>
<TR>
<TD>gleisbild.c<BR>gleisbild.h</TD>
<TD>Verwaltung der Gleisbilder</TD>
</TR>
<TR>
<TD>gleisbildpage.c<BR>gleisbildpage.h</TD>
<TD>Verwaltung einer Gleisbildseite</TD>
</TR>
<TR>
<TD>lok.c<BR>lok.h</TD>
<TD>Verwaltung der Lokomotiven</TD>
</TR>
<TR>
<TD>lokstatus.c<BR>lokstatus.h</TD>
<TD>Verwaltung des Loksttaus</TD>
</TR>
<TR>
<TD>magnetartikel.c<BR>magnetartikel.h</TD>
<TD>Verwaltung der Magnetartikel</TD>
</TR>
<TR>
<TD>magstat.c<BR>magstat.h</TD>
<TD>Verwaltung des Magnetartikelstatus</TD>
</TR>
<TR>
<TD>main.c</TD>
<TD>Start des Programms und Einlesen der Konfiguration</TD>
</TR>
<TR>
<TD>states.c</TD>
<TD>Die State Machines f&uuml;r den Ablauf</TD>
</TR>
<TR>
<TD>zentrale.c<BR>zentrale.h</TD>
<TD>Die Hauptschleife mit Empfang der Nachrichten und Aufruf der State
Machine</TD>
</TR>
<TR>
<TD>zfile.c<BR>zfile.h</TD>
<TD>Packen/Entpacken des CFG Data Streams</TD>
</TR>
</TABLE>
<P>
<H2><A NAME="proxy">Proxy Mode</A></H2>
<P>
Die Zentrale verh&auml;lt sich passiv und versendet keine Ping <VAL>"member
request"</VAL> Nachrichten. Wenn eine CS2 bzw. eine Software erkannt wird, die
einen CAN Ping mit der Kennung einer CS2 beantwortet, werden die "*.cs2"
Konfigurationsdateien abgefragt.
<P>
<H3>state machine f&uuml;r Proxy Modus</H3>
<P>
<IMG SRC="mrzentrale_z0.png">
<P>
<H2><A NAME="zentrale">MS2 und Software sind Zentrale</A></H2>
<P>
Die Zentrale versendet aktiv Ping <VAL>"member request"</VAL> Nachrichten. Wenn
eine MS2 erkannt wird, werden die Loks und die Lokinfos abgefragt.
<P>
<H3>state machine f&uuml;r MS2 Zentrale Modus</H3>
<P>
<IMG SRC="mrzentrale_z1.png">
</BODY>
</HTML>
