gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  1


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can Device
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 RADIX   DEC
                      00018 
                      00019 ;------------------------------------------------------------------------------
                      00020 ; Device
                      00021 ;------------------------------------------------------------------------------
                      00022 
                      00023                 PROCESSOR   18f45k80
                      00024 
                      00025 ;------------------------------------------------------------------------------
                      00026 ; Device constants
                      00027 ;------------------------------------------------------------------------------
                      00028 
                      00029                 ERRORLEVEL  -302,-1301
                      00030                 LIST        P=PIC18F45K80
                      00031 #INCLUDE        "p18f45k80.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Aug 13 2015
                      00005 ;  MPASM PIC18F45K80 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2015 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      05438         LIST
                      00032                 LIST
                      00033 
                      00034 ;------------------------------------------------------------------------------
                      00035 ; Device settings
                      00036 ;------------------------------------------------------------------------------
                      00037 
                      00038 ; Clock Rate
                      00039 #DEFINE         CLOCK       64000000
                      00040 
                      00041 ; UART PORTC, PORTB or PORTD
                      00042 #DEFINE         UART        PORTD
                      00043 
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  2


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00044 ; UART Baud Rate
                      00045 #DEFINE         BAUDRATE    500000
                      00046 
                      00047 ; I2C Rate
                      00048 #DEFINE         I2CRATE     400000
                      00049 
                      00050 ; CAN PORTB or PORTC
                      00051 #DEFINE         CAN         PORTB
                      00052 
                      00053 ; CAN Bus Rate
                      00054 #DEFINE         CANRATE     250
                      00055 
                      00056 ;------------------------------------------------------------------------------
                      00057 ; Device hardware
                      00058 ;------------------------------------------------------------------------------
                      00059 
                      00060 ; LED1 RB6 CAN  OVERFLOW
                      00061 ; LED2 RB7 UART OVERFLOW
                      00062 ; RTS  RB4 CLEAR TO SEND
                      00063 ;
                      00064 #DEFINE         GPIO        LATB
                      00065 #DEFINE         DDR         DDRB
                      00066 #DEFINE         PIO         1
                      00067 #DEFINE         LEDHIGH     1
                      00068 #DEFINE         PIOINVERT   1
                      00069 
                      00070 ;------------------------------------------------------------------------------
                      00071 ; Device firmware
                      00072 ;------------------------------------------------------------------------------
                      00073 
                      00074 
                      00075 #INCLUDE        "18f4xk80-mcu-config.inc"
                      00001 ; VREG Sleep Enable bit:
                      00002                 CONFIG    RETEN=ON
                      00003 ; LF-INTOSC Low-power Enable bit:
                      00004 ;               CONFIG    INTOSCSEL=LOW
                      00005 ; SOSC Power Selection and mode Configuration bits:
                      00006                 CONFIG    SOSCSEL=DIG
                      00007 ; Extended Instruction Set:
                      00008                 CONFIG    XINST=OFF
                      00009 ; Oscillator:
                      00010                 CONFIG    FOSC=HS2
                      00011 ; PLL x4 Enable bit:
                      00012                 CONFIG    PLLCFG=ON
                      00013 ; Fail-Safe Clock Monitor:
                      00014                 CONFIG    FCMEN=OFF
                      00015 ; Internal External Oscillator Switch Over Mode:
                      00016                 CONFIG    IESO=OFF
                      00017 ; Power-up Timer:
                      00018                 CONFIG    PWRTEN=OFF
                      00019 ; Brown-out Detect:
                      00020                 CONFIG    BOREN=OFF
                      00021 ; Brown-out Reset Voltage bits:
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  3


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00022                 CONFIG    BORV=1
                      00023 ; BORMV Power level:
                      00024 ;               CONFIG    BORPWR=LOW
                      00025 ; Watchdog Timer:
                      00026                 CONFIG    WDTEN=OFF
                      00027 ; Watchdog Postscaler:
                      00028                 CONFIG    WDTPS=1024
                      00029 ; ECAN Mux bit:
                      00030                 CONFIG    CANMX=PORTB
                      00031 ; MSSP address masking:
                      00032                 CONFIG    MSSPMSK=MSK5
                      00033 ; Master Clear Enable:
                      00034                 CONFIG    MCLRE=ON
                      00035 ; Stack Overflow Reset:
                      00036                 CONFIG    STVREN=ON
                      00037 ; Boot Block Size:
                      00038                 CONFIG    BBSIZ=BB1K
                      00039 ; Code Protect 00800-03FFF:
                      00040                 CONFIG    CP0=OFF
                      00041 ; Code Protect 04000-07FFF:
                      00042                 CONFIG    CP1=OFF
                      00043 ; Code Protect 08000-0BFFF:
                      00044                 CONFIG    CP2=OFF
                      00045 ; Code Protect 0C000-0FFFF:
                      00046                 CONFIG    CP3=OFF
                      00047 ; Code Protect Boot:
                      00048                 CONFIG    CPB=OFF
                      00049 ; Data EE Read Protect:
                      00050                 CONFIG    CPD=OFF
                      00051 ; Table Write Protect 00800-03FFF:
                      00052                 CONFIG    WRT0=OFF
                      00053 ; Table Write Protect 04000-07FFF:
                      00054                 CONFIG    WRT1=OFF
                      00055 ; Table Write Protect 08000-0BFFF:
                      00056                 CONFIG    WRT2=OFF
                      00057 ; Table Write Protect 0C000-0FFFF:
                      00058                 CONFIG    WRT3=OFF
                      00059 ; Config. Write Protect:
                      00060                 CONFIG    WRTC=OFF
                      00061 ; Table Write Protect Boot:
                      00062                 CONFIG    WRTB=OFF
                      00063 ; Data EE Write Protect:
                      00064                 CONFIG    WRTD=OFF
                      00065 ; Table Read Protect 00800-03FFF:
                      00066                 CONFIG    EBTR0=OFF
                      00067 ; Table Read Protect 04000-07FFF:
                      00068                 CONFIG    EBTR1=OFF
                      00069 ; Table Read Protect 08000-0BFFF:
                      00070                 CONFIG    EBTR2=OFF
                      00071 ; Table Read Protect 0C000-0FFFF:
                      00072                 CONFIG    EBTR3=OFF
                      00073 ; Table Read Protect Boot:
                      00074                 CONFIG    EBTRB=OFF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  4


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00076 #INCLUDE        "can-can.inc"
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can Firmware
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; Macros
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024 ; Decrement REG, goto LOC if result not ZERO
                      00025 DJNZ            MACRO   REG,LOC
                      00026                 DECFSZ  REG,F
                      00027                 BRA     LOC
                      00028                 ENDM
                      00029 
                      00030 CANOVFL         MACRO
                      00031 #IFDEF LEDHIGH
                      00032                 BSF     GPIO,6              ; LED1 CAN Packet dropped
                      00033 #ELSE
                      00034                 BCF     GPIO,6
                      00035 #ENDIF
                      00036                 ENDM
                      00037 
                      00038 CANRECV         MACRO
                      00039 #IFDEF LEDHIGH
                      00040                 BCF     GPIO,6              ; LED1 CAN Packet received
                      00041 #ELSE
                      00042                 BSF     GPIO,6
                      00043 #ENDIF
                      00044                 ENDM
                      00045 
                      00046 UARTOVFL        MACRO
                      00047 #IFDEF LEDHIGH
                      00048                 BSF     GPIO,7              ; LED2 UART Packet dropped
                      00049 #ELSE
                      00050                 BCF     GPIO,7
                      00051 #ENDIF
                      00052                 ENDM
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  5


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00053 
                      00054 UARTRECV        MACRO
                      00055 #IFDEF LEDHIGH
                      00056                 BCF     GPIO,7              ; LED2 UART Packet received
                      00057 #ELSE
                      00058                 BCF     GPIO,7
                      00059 #ENDIF
                      00060                 ENDM
                      00061 
                      00062 RTSCLR          MACRO
                      00063                 BCF     GPIO,4              ; RTS/CTS CLEAR TO SEND
                      00064                 ENDM
                      00065 
                      00066 RTSSET          MACRO
                      00067                 BSF     GPIO,4              ; RTS/CTS NOT CLEAR TO SEND
                      00068                 ENDM
                      00069 
                      00070 ;------------------------------------------------------------------------------
                      00071 ; Variables
                      00072 ;------------------------------------------------------------------------------
                      00073 
                      00074                 CBLOCK  0x0000              ; ACCESS RAM 0x00..0x5F
  00000000            00075                 B_SAVE  : 1                 ; ISR BANK SELECT REGISTER
  00000001            00076                 S_SAVE  : 1                 ; ISR STATUS REGISTER
  00000002            00077                 W_SAVE  : 1                 ; ISR WORKING REGISTER
                      00078                 ENDC
                      00079 
                      00080 ;------------------------------------------------------------------------------
                      00081 ; Reset/ISR
                      00082 ;------------------------------------------------------------------------------
                      00083 
000000                00084                 ORG     0x0000
000000 EF0E F000      00085                 GOTO    INIT
000008                00086                 ORG     0x0008
000008 EF5D F000      00087                 GOTO    ISRHIGH             ; When IPEN = 0 or 1
000018                00088                 ORG     0x0018
000018 EF7A F000      00089                 GOTO    ISRLOW              ; When IPEN = 1
                      00090 
                      00091 ;------------------------------------------------------------------------------
                      00092 ; Init.
                      00093 ;------------------------------------------------------------------------------
                      00094 
00001C                00095 INIT
00001C 010F           00096                 MOVLB   0x0F                ; Default to Bank 15
                      00097 
00001E 6AF2           00098                 CLRF    INTCON              ; Reset ISR
                      00099 #IF UART == PORTB || UART == PORTD
000020 6AA3           00100                 CLRF    PIE3
000022 6AA4           00101                 CLRF    PIR3
                      00102 #ELSE
                      00103                 CLRF    PIE1
                      00104                 CLRF    PIR1
                      00105 #ENDIF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  6


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00106 
                      00107                 ; switch off A/Ds, D/As and comaprators
000024 6AC2           00108                 CLRF    ADCON0          ;D
000026 6AC1           00109                 CLRF    ADCON1          ;D
000028 6AC0           00110                 CLRF    ADCON2          ;D
00002A 6B5D           00111                 CLRF    ANCON0          ;N
00002C 6B5C           00112                 CLRF    ANCON1          ;N
00002E 6B5F           00113                 CLRF    CM1CON          ;C
000030 6B5E           00114                 CLRF    CM2CON          ;C
                      00115 
000032 6A8C           00116                 CLRF    LATD
000034 6A8B           00117                 CLRF    LATC
000036 9494           00118                 BCF     TRISC, 2
000038 6A8A           00119                 CLRF    GPIO                ; Init. LED
                      00120                 RTSCLR                      ; Init. RTS
00003A 988A               M                 BCF     LATB,4              ; RTS/CTS CLEAR TO SEND
00003C 6A93           00121                 CLRF    DDR                 ; All O/P
                      00122 
00003E EC43 F000      00123                 CALL    INITUART            ; Init. UART
000042 EC8A F000      00124                 CALL    INITRING            ; Init. Rx/Tx Ring Buffer
000046 ECBD F000      00125                 CALL    INITCAN             ; Init. CAN Bus
00004A ECF7 F001      00126                 CALL    TIMER0INIT          ; Init. TIMER
00004E EC1C F002      00127                 CALL    I2CINIT             ; Init. I2C
000052 ECA2 F002      00128                 CALL    PIOINIT             ; Init. PIO
000056 EC73 F003      00129                 CALL    INITEVENTRING       ; Init. Event Ring Buffer
00005A EC08 F003      00130                 CALL    PWMINIT
00005E EC5E F002      00131                 CALL    READUID
                      00132 
000062 8ED0           00133                 BSF     RCON,IPEN           ; Enable priority interrupts
000064 8CF2           00134                 BSF     INTCON,PEIE         ; Init. ISR
000066 8EF2           00135                 BSF     INTCON,GIE
                      00136                
                      00137 ;------------------------------------------------------------------------------
                      00138 ; Main
                      00139 ;------------------------------------------------------------------------------
000068                00140 MAIN
000068 EC58 F000      00141                 CALL    RESETUART           ; UART RESET
00006C ECEE F000      00142                 CALL    RXCAN               ; RECEIVE CAN
000070 EC35 F004      00143                 CALL    CANINSPECT
000074 EC76 F001      00144                 CALL    TXCAN               ; SEND CAN
000078 EC35 F004      00145                 CALL    CANINSPECT
00007C EC32 F003      00146                 CALL    PWM_TEST
000080 B4F2           00147                 BTFSC   INTCON, TMR0IF
000082 D9BB           00148                 RCALL   SCHEDULE
000084 D7F1           00149                 BRA     MAIN
                      00150 
                      00151 ;------------------------------------------------------------------------------
                      00152 ; Includes
                      00153 ;------------------------------------------------------------------------------
                      00154 
                      00155 #INCLUDE        "uart.inc"                  ; UART
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  7


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00003 ; Can-Can UART
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; UART settings
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024 #IF UART != PORTD
                      00025     #IF UART != PORTC
                      00026         #IF UART != PORTB
                      00027             ERROR   "UART port not configured"
                      00028         #ENDIF
                      00029     #ENDIF
                      00030 #ENDIF
                      00031 
                      00032 #IFNDEF BAUDRATE
                      00033     ERROR       "UART baud rate not defined"
                      00034 #ENDIF
                      00035 
                      00036 #IF UART == PORTC
                      00037     #IFNDEF TXSTA1
                      00038         #DEFINE UPIR        PIR1
                      00039         #DEFINE URCIF       RCIF
                      00040         #DEFINE UTXIF       TXIF
                      00041 
                      00042         #DEFINE UPIE        PIE1
                      00043         #DEFINE URCIE       RCIE
                      00044         #DEFINE UTXIE       TXIE
                      00045 
                      00046         #DEFINE UIPR        IPR1
                      00047         #DEFINE URCIP       RCIP
                      00048         #DEFINE UTXIP       TXIP
                      00049 
                      00050         #DEFINE UTXSTA      TXSTA
                      00051         #DEFINE URCSTA      RCSTA
                      00052         #DEFINE UTXREG      TXREG
                      00053         #DEFINE URCREG      RCREG
                      00054 
                      00055         #DEFINE UBAUDCON    BAUDCON
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  8


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00056         #DEFINE USPBRGH     SPBRGH
                      00057         #DEFINE USPBRG      SPBRG
                      00058     #ELSE
                      00059         #DEFINE UPIR        PIR1
                      00060         #DEFINE URCIF       RC1IF
                      00061         #DEFINE UTXIF       TX1IF
                      00062 
                      00063         #DEFINE UPIE        PIE1
                      00064         #DEFINE URCIE       RC1IE
                      00065         #DEFINE UTXIE       TX1IE
                      00066 
                      00067         #DEFINE UIPR        IPR1
                      00068         #DEFINE URCIP       RC1IP
                      00069         #DEFINE UTXIP       TX1IP
                      00070 
                      00071         #DEFINE UTXSTA      TXSTA1
                      00072         #DEFINE URCSTA      RCSTA1
                      00073         #DEFINE UTXREG      TXREG1
                      00074         #DEFINE URCREG      RCREG1
                      00075 
                      00076         #DEFINE UBAUDCON    BAUDCON1
                      00077         #DEFINE USPBRGH     SPBRGH1
                      00078         #DEFINE USPBRG      SPBRG1
                      00079     #ENDIF
                      00080 #ENDIF
                      00081 
                      00082 #IF UART == PORTB || UART == PORTD
                      00083         #DEFINE UPIR        PIR3
                      00084         #DEFINE URCIF       RC2IF
                      00085         #DEFINE UTXIF       TX2IF
                      00086 
                      00087         #DEFINE UPIE        PIE3
                      00088         #DEFINE URCIE       RC2IE
                      00089         #DEFINE UTXIE       TX2IE
                      00090 
                      00091         #DEFINE UIPR        IPR3
                      00092         #DEFINE URCIP       RC2IP
                      00093         #DEFINE UTXIP       TX2IP
                      00094 
                      00095         #DEFINE UTXSTA      TXSTA2
                      00096         #DEFINE URCSTA      RCSTA2
                      00097         #DEFINE UTXREG      TXREG2
                      00098         #DEFINE URCREG      RCREG2
                      00099 
                      00100         #DEFINE UBAUDCON    BAUDCON2
                      00101         #DEFINE USPBRGH     SPBRGH2
                      00102         #DEFINE USPBRG      SPBRG2
                      00103 #ENDIF
                      00104 
                      00105 ;------------------------------------------------------------------------------
                      00106 ; UART Baud Rate Generator (FOSC / BAUDRATE / 4 - 1)
                      00107 ;------------------------------------------------------------------------------
                      00108 
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE  9


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00109 #DEFINE UBAUD   ((((CLOCK / BAUDRATE) / 2) - 1) / 2)
                      00110 #IF UBAUD > 65535
                      00111     ERROR       "UART BRG overflow"
                      00112 #ENDIF
                      00113 #IF UBAUD == 0
                      00114     ERROR       "UART BRG zero"
                      00115 #ENDIF
                      00116 
                      00117 ;------------------------------------------------------------------------------
                      00118 ; Init. UART
                      00119 ;------------------------------------------------------------------------------
000086                00120 INITUART
                      00121 
                      00122 #IF UART == PORTB
                      00123                 BCF     TRISB,6             ; UART2 TX
                      00124                 BSF     TRISB,7             ; UART2 RX
                      00125 #ENDIF
                      00126 #IF UART == PORTC
                      00127                 BCF     TRISC,6             ; UART1 TX
                      00128                 BSF     TRISC,7             ; UART1 RX
                      00129 #ENDIF
                      00130 #IF UART == PORTD
000086 9C95           00131                 BCF     TRISD,6             ; UART2 TX
000088 8E95           00132                 BSF     TRISD,7             ; UART2 RX
                      00133 #ENDIF
                      00134 
00008A 8AA5           00135                 BSF     UIPR,URCIP          ; Rx high priority
00008C 98A5           00136                 BCF     UIPR,UTXIP          ; Tx low priority
                      00137 
00008E 0E08           00138                 MOVLW   (1 << BRG16)
000090 6EB9           00139                 MOVWF   UBAUDCON
                      00140 
000092 0E00           00141                 MOVLW   HIGH (UBAUD)
000094 6E7C           00142                 MOVWF   USPBRGH
000096 0E1F           00143                 MOVLW   LOW  (UBAUD)
000098 6E7B           00144                 MOVWF   USPBRG
                      00145 
                      00146                 ; Enable 9-bit Mode + Enable Transmit + High Speed Mode + BIT9 = 1
00009A 0E65           00147                 MOVLW   (1 << TX9) + (1 << TXEN) + (1 << BRGH) + (1 << TX9D)
00009C 6EBA           00148                 MOVWF   UTXSTA
00009E                00149 INITUARTAGAIN
                      00150                 ; Disable Rx ring ISR
00009E 9AA3           00151                 BCF     UPIE,URCIE
                      00152 
                      00153                 ; Enable Serial Port + Disable Receiver
0000A0 0E80           00154                 MOVLW   (1 << SPEN)
0000A2 6EA6           00155                 MOVWF   URCSTA
                      00156 
                      00157                 ; Enable Receiver
0000A4 88A6           00158                 BSF     URCSTA,CREN
                      00159 
                      00160                 ; Flush Receiver
0000A6 507A           00161                 MOVF    URCREG,W
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 10


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

0000A8 507A           00162                 MOVF    URCREG,W
0000AA 507A           00163                 MOVF    URCREG,W
                      00164                 
                      00165                 ; Enable Rx ring ISR
0000AC 8AA3           00166                 BSF     UPIE,URCIE
                      00167 
0000AE 0012           00168                 RETURN
                      00169 
                      00170 ;------------------------------------------------------------------------------
                      00171 ; Reset UART Conditionally
                      00172 ;------------------------------------------------------------------------------
0000B0                00173 RESETUART
0000B0 B2A6           00174                 BTFSC   URCSTA,OERR         ; Detect UART Overrun Error
0000B2 D7F5           00175                 BRA     INITUARTAGAIN
                      00176 
0000B4 B4A6           00177                 BTFSC   URCSTA,FERR         ; Detect UART Framing Error
0000B6 D7F3           00178                 BRA     INITUARTAGAIN
                      00179 
0000B8 0012           00180                 RETURN
                      00181 
                      00182 ;------------------------------------------------------------------------------
                      00183 ;
                      00184 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00185 ;
                      00156 #INCLUDE        "ring.inc"                  ; Rx/Tx Ring
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can Rx/Tx ring
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; Rx/Tx ring settings
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024 ; End of Line Character
                      00025 #DEFINE         EOLNCHAR    0x0D            ; CR
                      00026 
                      00027 ; Rx/Tx ring Flow Control
                      00028 #DEFINE         OVERFLOW    (256 / 27)      ; Rx/Tx ring size / Max slcan size
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 11


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00029 #DEFINE         CONTROL     (3)             ; Flow Control
                      00030 
                      00031 ;------------------------------------------------------------------------------
                      00032 ; Rx/Tx ring variables
                      00033 ;------------------------------------------------------------------------------
                      00034 
                      00035                 CBLOCK
  00000002            00036                 ; Rx ring
  00000003            00037                 RXGET   : 1                 ; GETC Main
  00000004            00038                 RXPUT   : 1                 ; PUTC ISR
  00000005            00039                 RXOVF   : 1                 ; ISR Overflow
  00000006            00040                 RXCNT   : 1                 ; Rx packet counter
  00000006            00041                 ; Tx ring
  00000007            00042                 TXGET   : 1                 ; GETC ISR
  00000008            00043                 TXPUT   : 1                 ; PUTC Main
  00000009            00044                 TXTEMP  : 1                 ; PUTC Temp
  0000000A            00045                 TXCNT   : 1                 ; Tx packet counter
                      00046                 ENDC
                      00047 
                      00048 ;------------------------------------------------------------------------------
                      00049 ; Rx/Tx ring
                      00050 ;------------------------------------------------------------------------------
                      00051 
  00000180            00052 RXBUF           EQU     0x0180              ; Rx ring FSR1
                      00053 
                      00054 ;0100:  80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f    ................
                      00055 ;0110:  90 91 92 93 94 95 96 97 98 99 9a 9b 9c 9d 9e 9f    ................
                      00056 ;0120:  a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 aa ab ac ad ae af    ................
                      00057 ;0130:  b0 b1 b2 b3 b4 b5 b6 b7 b8 b9 ba bb bc bd be bf    ................
                      00058 ;0140:  c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cb cc cd ce cf    ................
                      00059 ;0150:  d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 da db dc dd de df    ................
                      00060 ;0160:  e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef    ................
                      00061 ;0170:  f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff    ................
                      00062 ;0180:  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f    ................
                      00063 ;0190:  10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f    ................
                      00064 ;01a0:  20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f     !"#$%&'()*+,-./
                      00065 ;01b0:  30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f    0123456789:;<=>?
                      00066 ;01c0:  40 41 42 43 44 45 46 47 48 49 4a 4b 4c 4d 4e 4f    @ABCDEFGHIJKLMNO
                      00067 ;01d0:  50 51 52 53 54 55 56 57 58 59 5a 5b 5c 5d 5e 5f    PQRSTUVWXYZ[\]^_
                      00068 ;01e0:  60 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f    `abcdefghijklmno
                      00069 ;01f0:  70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f    pqrstuvwxyz.....
                      00070 
  00000280            00071 TXBUF           EQU     0x0280              ; Tx ring FSR2
                      00072 
                      00073 ;------------------------------------------------------------------------------
                      00074 ; Rx/Tx ring macros
                      00075 ;------------------------------------------------------------------------------
                      00076 
                      00077 GETC            MACRO
                      00078                 MOVF    RXGET,W
                      00079                 MOVF    PLUSW1,W
                      00080                 INCF    RXGET,F             ; RXGET++
                      00081                 ENDM
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 12


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00082 
                      00083 PUTC            MACRO
                      00084                 MOVWF   TXTEMP
                      00085                 MOVF    TXPUT,W
                      00086                 MOVFF   TXTEMP,PLUSW2
                      00087                 INCF    TXPUT,F             ; TXPUT++
                      00088                 ENDM
                      00089 
                      00090 ;------------------------------------------------------------------------------
                      00091 ; Rx ring ISR
                      00092 ; 
                      00093 ;  Affects RXPUT & uses FSR1; do not use these elsewhere.
                      00094 ;------------------------------------------------------------------------------
0000BA                00095 ISRHIGH
                      00096                 ; Read Rx Data & Flush IRQ
0000BA 5004           00097                 MOVF    RXPUT,W
0000BC CF7A FFE3      00098                 MOVFF   URCREG,PLUSW1       ; Won't clobber with Overflow On
                      00099 
                      00100                 ; If Rx packet counter = trigger Then Drop Data
0000C0 5006           00101                 MOVF    RXCNT,W
0000C2 0A09           00102                 XORLW   OVERFLOW
0000C4 E103           00103                 BNZ     ISRHIGH1
                      00104 
                      00105                 ; Overflow On
0000C6 6805           00106                 SETF    RXOVF
                      00107 
                      00108                 UARTOVFL                    ; UART packet status LED
                          M #IFDEF LEDHIGH
0000C8 8E8A               M                 BSF     LATB,7              ; LED2 UART Packet dropped
                          M #ELSE
                          M                 BCF     LATB,7
                          M #ENDIF
0000CA 0011           00109                 RETFIE  FAST
                      00110 
                      00111 ;------------------------------------------------------------------------------
0000CC                00112 ISRHIGH1
                      00113                 ; If Overflow On Then Drop Data
0000CC 5005           00114                 MOVF    RXOVF,W             ; Overflow On?
0000CE E006           00115                 BZ      ISRHIGH3            ; No...
                      00116 
                      00117                 ; Disable Overflow When End of Line
0000D0 5004           00118                 MOVF    RXPUT,W
0000D2 50E3           00119                 MOVF    PLUSW1,W            ; EOLN?
0000D4 0A0D           00120                 XORLW   EOLNCHAR
0000D6 E101           00121                 BNZ     ISRHIGH2
                      00122 
                      00123                 ; Overflow Off
0000D8 6A05           00124                 CLRF    RXOVF
0000DA                00125 ISRHIGH2
0000DA 0011           00126                 RETFIE  FAST
                      00127                 
                      00128 ;------------------------------------------------------------------------------
0000DC                00129 ISRHIGH3
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 13


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00130                 ; Save Rx Data
0000DC 5004           00131                 MOVF    RXPUT,W
0000DE 2A04           00132                 INCF    RXPUT,F             ; PUTC++
                      00133 
0000E0 50E3           00134                 MOVF    PLUSW1,W            ; EOLN?
0000E2 0A0D           00135                 XORLW   EOLNCHAR
0000E4 E105           00136                 BNZ     ISRHIGHEND
                      00137 
0000E6 2A06           00138                 INCF    RXCNT,F             ; Rx packet counter++
0000E8 5006           00139                 MOVF    RXCNT,W             ; Flow control on?
0000EA 0803           00140                 SUBLW   CONTROL
0000EC E201           00141                 BC      ISRHIGHEND
                      00142 
                      00143                 ; Not Clear to Send; RXCNT > CONTROL
                      00144                 RTSSET
0000EE 888A               M                 BSF     LATB,4              ; RTS/CTS NOT CLEAR TO SEND
0000F0                00145 ISRHIGHEND
                      00146                 UARTRECV                    ; UART packet status LED
                          M #IFDEF LEDHIGH
0000F0 9E8A               M                 BCF     LATB,7              ; LED2 UART Packet received
                          M #ELSE
                          M                 BCF     LATB,7
                          M #ENDIF
0000F2 0011           00147                 RETFIE  FAST
                      00148 
                      00149 ;------------------------------------------------------------------------------
                      00150 ; Tx ring ISR
                      00151 ; 
                      00152 ;  Affects TXGET & uses FSR2; do not use these elsewhere.
                      00153 ;------------------------------------------------------------------------------
0000F4                00154 ISRLOW
0000F4 CFD8 F001      00155                 MOVFF   STATUS,S_SAVE       ; SAVE STATUS
0000F8 6E02           00156                 MOVWF   W_SAVE              ; SAVE WORKING REGISTER
                      00157 
0000FA 5007           00158                 MOVF    TXGET,W
0000FC 50DB           00159                 MOVF    PLUSW2,W
0000FE 2A07           00160                 INCF    TXGET,F
                      00161 
000100 6E79           00162                 MOVWF   UTXREG
000102 0A0D           00163                 XORLW   EOLNCHAR
000104 E103           00164                 BNZ     ISRLOWEND
                      00165 
000106 060A           00166                 DECF    TXCNT,F             ; Tx packet counter--
000108 E101           00167                 BNZ     ISRLOWEND
00010A 98A3           00168                 BCF     UPIE,UTXIE          ; Disable Tx ring ISR
00010C                00169 ISRLOWEND
00010C 5002           00170                 MOVF    W_SAVE,W            ; RESTORE WORKING REGISTER
00010E C001 FFD8      00171                 MOVFF   S_SAVE,STATUS       ; RESTORE STATUS
                      00172 
000112 0010           00173                 RETFIE
                      00174 
                      00175 ;------------------------------------------------------------------------------
                      00176 ; Init. Rx/Tx ring
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 14


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00177 ;------------------------------------------------------------------------------
000114                00178 INITRING
000114 EE11 F080      00179                 LFSR    FSR1,RXBUF          ; FSR1 H/L Reserved for Rx ring
000118 EE22 F080      00180                 LFSR    FSR2,TXBUF          ; FSR2 H/L Reserved for Tx ring
                      00181 
00011C 6A03           00182                 CLRF    RXGET               ; Rx index = 0
00011E 6A04           00183                 CLRF    RXPUT
000120 6A05           00184                 CLRF    RXOVF
                      00185 
000122 6A07           00186                 CLRF    TXGET               ; Tx index = 0
000124 6A08           00187                 CLRF    TXPUT
                      00188 
000126 6A06           00189                 CLRF    RXCNT               ; Reset Rx packet counter
000128 6A0A           00190                 CLRF    TXCNT               ; Reset Tx packet counter
                      00191 
00012A 0012           00192                 RETURN
                      00193 
                      00194 ;------------------------------------------------------------------------------
                      00195 ;
                      00196 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00197 ;
                      00157 #INCLUDE        "ascii.inc"                 ; ASCII I/O
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can ASCII I/O
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; ASCII I/O variables
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024                 CBLOCK
  0000000B            00025                 ASCTEMP : 1
                      00026                 ENDC
                      00027 
                      00028 ;------------------------------------------------------------------------------
                      00029 ; Convert ASCII Hex Byte or Nibble in <RXBUF> to Binary, Store In <FSR0> or W
                      00030 ;
                      00031 ; Nibble: RXGET += 1
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 15


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00032 ; Byte  : RXGET += 2, FSR0 += 1
                      00033 ;------------------------------------------------------------------------------
00012C                00034 ASC2BIN
00012C D805           00035                 RCALL   ASC2NIB
00012E 6EEF           00036                 MOVWF   INDF0
000130 3AEF           00037                 SWAPF   INDF0,F
000132 D802           00038                 RCALL   ASC2NIB
000134 12EE           00039                 IORWF   POSTINC0,F
000136 0012           00040                 RETURN               
000138                00041 ASC2NIB
                      00042                 GETC                        ; W = <RXBUF>,RXGET++
000138 5003               M                 MOVF    RXGET,W
00013A 50E3               M                 MOVF    PLUSW1,W
00013C 2A03               M                 INCF    RXGET,F             ; RXGET++
00013E 6E0B           00043                 MOVWF   ASCTEMP
000140 0B0F           00044                 ANDLW   0x0F
000142 AC0B           00045                 BTFSS   ASCTEMP,6
000144 0012           00046                 RETURN
000146 0F09           00047                 ADDLW   9
000148 0012           00048                 RETURN
                      00049 
                      00050 ;------------------------------------------------------------------------------
                      00051 ; Convert Binary in W to ASCII Hex Nibble or Byte, Store in <TXBUF>
                      00052 ;
                      00053 ; Nibble: TXPUT += 1
                      00054 ; Byte  : TXPUT += 2
                      00055 ;------------------------------------------------------------------------------
                      00056 NIB2ASC         MACRO
                      00057                 ANDLW   0x0F
                      00058                 ADDLW   6
                      00059                 BTFSC   STATUS,DC
                      00060                 ADDLW   7
                      00061                 ADDLW   42
                      00062                 PUTC                        ; <TXBUF> = W,TXPUT++
                      00063                 ENDM
                      00064 
00014A                00065 BIN2ASC
00014A 6E0B           00066                 MOVWF   ASCTEMP
00014C 380B           00067                 SWAPF   ASCTEMP,W
                      00068                 NIB2ASC
00014E 0B0F               M                 ANDLW   0x0F
000150 0F06               M                 ADDLW   6
000152 B2D8               M                 BTFSC   STATUS,DC
000154 0F07               M                 ADDLW   7
000156 0F2A               M                 ADDLW   42
                          M                 PUTC                        ; <TXBUF> = W,TXPUT++
000158 6E09               M                 MOVWF   TXTEMP
00015A 5008               M                 MOVF    TXPUT,W
00015C C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
000160 2A08               M                 INCF    TXPUT,F             ; TXPUT++
000162 500B           00069                 MOVF    ASCTEMP,W
                      00070                 NIB2ASC
000164 0B0F               M                 ANDLW   0x0F
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 16


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000166 0F06               M                 ADDLW   6
000168 B2D8               M                 BTFSC   STATUS,DC
00016A 0F07               M                 ADDLW   7
00016C 0F2A               M                 ADDLW   42
                          M                 PUTC                        ; <TXBUF> = W,TXPUT++
00016E 6E09               M                 MOVWF   TXTEMP
000170 5008               M                 MOVF    TXPUT,W
000172 C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
000176 2A08               M                 INCF    TXPUT,F             ; TXPUT++
000178 0012           00071                 RETURN
                      00072 
                      00073 ;------------------------------------------------------------------------------
                      00074 ;
                      00075 ; vim: set shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00076 ;
                      00158 #INCLUDE        "can.inc"                   ; CAN
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can CAN
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; CAN Bus variables
                      00022 ;------------------------------------------------------------------------------
                      00023     
                      00024                 CBLOCK
  0000000C            00025                 CANCMD  : 1
  0000000D            00026                 CANID   : 1
  0000000E            00027                 CANCNT  : 1
                      00028                 ENDC
                      00029 
                      00030 ;------------------------------------------------------------------------------
                      00031 ; CAN Bus settings
                      00032 ;------------------------------------------------------------------------------
                      00033 
                      00034 #IF CAN != PORTB
                      00035     #IF CAN != PORTC
                      00036         ERROR   "CAN port not configured"
                      00037     #ENDIF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 17


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00038 #ENDIF
                      00039 
                      00040 #IFNDEF REQOP0
                      00041 REQOP0          EQU     H'0005'
                      00042 REQOP1          EQU     H'0006'
                      00043 REQOP2          EQU     H'0007'
                      00044 #ENDIF
                      00045 #IFNDEF RXB0DBEN
                      00046 RXB0DBEN        EQU     H'0002'
                      00047 #ENDIF
                      00048 
                      00049 #DEFINE         CAN_WIN_OFF  0x00           ; 000X
                      00050 #DEFINE         CAN_WIN_RXB0 0x0C           ; 110X
                      00051 #DEFINE         CAN_WIN_RXB1 0x0A           ; 101X
                      00052 #DEFINE         CAN_WIN_TXB0 0x08           ; 100X
                      00053 #DEFINE         CAN_WIN_TXB1 0x06           ; 011X
                      00054 #DEFINE         CAN_WIN_TXB2 0x04           ; 010X
                      00055 
                      00056 #INCLUDE        "canrates.inc"
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can CAN rates
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 
                      00022 #IFNDEF CANRATE
                      00023     ERROR       "CAN Bus rate not defined"
                      00024 #ENDIF
                      00025 
                      00026 #IF CLOCK != 16000000
                      00027     #IF CLOCK != 40000000
                      00028         #IF CLOCK != 48000000
                      00029             #IF CLOCK != 60000000
                      00030                 #IF CLOCK != 64000000
                      00031                      ERROR   "CAN Bus rate not calculated"
                      00032                 #ENDIF
                      00033             #ENDIF
                      00034         #ENDIF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 18


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00035     #ENDIF
                      00036 #ENDIF
                      00037 
                      00038 #IF CLOCK == 16000000
                      00039     #IF CANRATE == 1000
                      00040         #DEFINE BRG1 0x00
                      00041         #DEFINE BRG2 0x84
                      00042         #DEFINE BRG3 0x00
                      00043     #ENDIF
                      00044     #IF CANRATE == 500
                      00045         #DEFINE BRG1 0x00
                      00046         #DEFINE BRG2 0xBC
                      00047         #DEFINE BRG3 0x01
                      00048     #ENDIF
                      00049     #IF CANRATE == 250
                      00050         #DEFINE BRG1 0x01
                      00051         #DEFINE BRG2 0xBC
                      00052         #DEFINE BRG3 0x01
                      00053     #ENDIF
                      00054     #IF CANRATE == 125
                      00055         #DEFINE BRG1 0x03
                      00056         #DEFINE BRG2 0xBC
                      00057         #DEFINE BRG3 0x01
                      00058     #ENDIF
                      00059     #IF CANRATE == 100
                      00060         #DEFINE BRG1 0x04
                      00061         #DEFINE BRG2 0xBC
                      00062         #DEFINE BRG3 0x01
                      00063     #ENDIF
                      00064     #IF CANRATE == 50
                      00065         #DEFINE BRG1 0x09
                      00066         #DEFINE BRG2 0xBC
                      00067         #DEFINE BRG3 0x01
                      00068     #ENDIF
                      00069     #IF CANRATE == 20
                      00070         #DEFINE BRG1 0x18
                      00071         #DEFINE BRG2 0xBC
                      00072         #DEFINE BRG3 0x01
                      00073     #ENDIF
                      00074     #IF CANRATE == 10
                      00075         #DEFINE BRG1 0x31
                      00076         #DEFINE BRG2 0xBC
                      00077         #DEFINE BRG3 0x01
                      00078     #ENDIF
                      00079 #ENDIF
                      00080 
                      00081 #IF CLOCK == 40000000
                      00082     #IF CANRATE == 500
                      00083         #DEFINE BRG1 0x04
                      00084         #DEFINE BRG2 0x84
                      00085         #DEFINE BRG3 0x00
                      00086     #ENDIF
                      00087     #IF CANRATE == 250
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 19


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00088         #DEFINE BRG1 0x04
                      00089         #DEFINE BRG2 0xBC
                      00090         #DEFINE BRG3 0x01
                      00091     #ENDIF
                      00092     #IF CANRATE == 125
                      00093         #DEFINE BRG1 0x09
                      00094         #DEFINE BRG2 0xBC
                      00095         #DEFINE BRG3 0x01
                      00096     #ENDIF
                      00097     #IF CANRATE == 100
                      00098         #DEFINE BRG1 0x18
                      00099         #DEFINE BRG2 0x84
                      00100         #DEFINE BRG3 0x00
                      00101     #ENDIF
                      00102     #IF CANRATE == 50
                      00103         #DEFINE BRG1 0x18
                      00104         #DEFINE BRG2 0xBC
                      00105         #DEFINE BRG3 0x01
                      00106     #ENDIF
                      00107 #ENDIF
                      00108 
                      00109 #IF CLOCK == 48000000
                      00110     #IF CANRATE == 1000
                      00111         #DEFINE BRG1 0x00
                      00112         #DEFINE BRG2 0xBF
                      00113         #DEFINE BRG3 0x06
                      00114     #ENDIF
                      00115     #IF CANRATE == 500
                      00116         #DEFINE BRG1 0x02
                      00117         #DEFINE BRG2 0xBC
                      00118         #DEFINE BRG3 0x01
                      00119     #ENDIF
                      00120     #IF CANRATE == 250
                      00121         #DEFINE BRG1 0x05
                      00122         #DEFINE BRG2 0xBC
                      00123         #DEFINE BRG3 0x01
                      00124     #ENDIF
                      00125     #IF CANRATE == 125
                      00126         #DEFINE BRG1 0x0B
                      00127         #DEFINE BRG2 0xBC
                      00128         #DEFINE BRG3 0x01
                      00129     #ENDIF
                      00130     #IF CANRATE == 100
                      00131         #DEFINE BRG1 0x0E
                      00132         #DEFINE BRG2 0xBC
                      00133         #DEFINE BRG3 0x01
                      00134     #ENDIF
                      00135     #IF CANRATE == 50
                      00136         #DEFINE BRG1 0x1D
                      00137         #DEFINE BRG2 0xBC
                      00138         #DEFINE BRG3 0x01
                      00139     #ENDIF
                      00140     #IF CANRATE == 20
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 20


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00141         #DEFINE BRG1 0x3B
                      00142         #DEFINE BRG2 0xBF
                      00143         #DEFINE BRG3 0x02
                      00144     #ENDIF
                      00145 #ENDIF
                      00146 
                      00147 #IF CLOCK == 60000000
                      00148     #IF CANRATE == 1000
                      00149         #DEFINE BRG1 0x00
                      00150         #DEFINE BRG2 0xBB
                      00151         #DEFINE BRG3 0x01
                      00152     #ENDIF
                      00153     #IF CANRATE == 500
                      00154         #DEFINE BRG1 0x01
                      00155         #DEFINE BRG2 0xBB
                      00156         #DEFINE BRG3 0x01
                      00157     #ENDIF
                      00158     #IF CANRATE == 250
                      00159         #DEFINE BRG1 0x03
                      00160         #DEFINE BRG2 0xBB
                      00161         #DEFINE BRG3 0x01
                      00162     #ENDIF
                      00163     #IF CANRATE == 125
                      00164         #DEFINE BRG1 0x07
                      00165         #DEFINE BRG2 0xBB
                      00166         #DEFINE BRG3 0x01
                      00167     #ENDIF
                      00168     #IF CANRATE == 100
                      00169         #DEFINE BRG1 0x09
                      00170         #DEFINE BRG2 0xBB
                      00171         #DEFINE BRG3 0x01
                      00172     #ENDIF
                      00173     #IF CANRATE == 50
                      00174         #DEFINE BRG1 0x13
                      00175         #DEFINE BRG2 0xBB
                      00176         #DEFINE BRG3 0x01
                      00177     #ENDIF
                      00178     #IF CANRATE == 20
                      00179         #DEFINE BRG1 0x31
                      00180         #DEFINE BRG2 0xBB
                      00181         #DEFINE BRG3 0x01
                      00182     #ENDIF
                      00183     #IF CANRATE == 10
                      00184         #DEFINE BRG1 0x3B
                      00185         #DEFINE BRG2 0xBF
                      00186         #DEFINE BRG3 0x07
                      00187     #ENDIF
                      00188 #ENDIF
                      00189 
                      00190 #IF CLOCK == 64000000
                      00191     #IF CANRATE == 1000
                      00192         #DEFINE BRG1 0x01
                      00193         #DEFINE BRG2 0xBC
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 21


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00194         #DEFINE BRG3 0x01
                      00195     #ENDIF
                      00196     #IF CANRATE == 500
                      00197         #DEFINE BRG1 0x03
                      00198         #DEFINE BRG2 0xBC
                      00199         #DEFINE BRG3 0x01
                      00200     #ENDIF
                      00201     #IF CANRATE == 250
                      00202         #DEFINE BRG1 0x07
                      00203         #DEFINE BRG2 0xBC
                      00204         #DEFINE BRG3 0x01
                      00205     #ENDIF
                      00206     #IF CANRATE == 125
                      00207         #DEFINE BRG1 0x0F
                      00208         #DEFINE BRG2 0xBC
                      00209         #DEFINE BRG3 0x01
                      00210     #ENDIF
                      00211     #IF CANRATE == 100
                      00212         #DEFINE BRG1 0x13
                      00213         #DEFINE BRG2 0xBC
                      00214         #DEFINE BRG3 0x01
                      00215     #ENDIF
                      00216     #IF CANRATE == 50
                      00217         #DEFINE BRG1 0x27
                      00218         #DEFINE BRG2 0xBC
                      00219         #DEFINE BRG3 0x01
                      00220     #ENDIF
                      00221 #ENDIF
                      00222 
                      00223 ;------------------------------------------------------------------------------
                      00224 ;
                      00225 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00226 ;
                      00057 #INCLUDE        "canid.inc"
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can CAN ID
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 22


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00020 ;------------------------------------------------------------------------------
                      00021 ; MCHP CAN ID
                      00022 ;------------------------------------------------------------------------------
                      00023 ;
                      00024 ; RXB0SIDH
                      00025 ; --------
                      00026 ; SID10 SID9  SID8  SID7  SID6  SID5  SID4  SID3
                      00027 ;
                      00028 ; EID28 EID27 EID26 EID25 EID24 EID23 EID22 EID21
                      00029 ;
                      00030 ; RXB0SIDL
                      00031 ; --------
                      00032 ; SID2  SID1  SID0  X    EXIDEN X     X     X
                      00033 ;
                      00034 ; EID20 EID19 EID18 X    EXIDEN X     EID17 EID16
                      00035 ;
                      00036 ; RXB0EIDH
                      00037 ; --------
                      00038 ; EID15 EID14 EID13 EID12 EID11 EID10 EID9  EID8
                      00039 ;
                      00040 ; RXB0EIDL
                      00041 ; --------
                      00042 ; EID7  EID6  EID5  EID4  EID3  EID2  EID1  EID0
                      00043 ;
                      00044 ; STANDARD ID 11-bit
                      00045 ; ------------------
                      00046 ; [XX XX XX XX XX 10 09 08]  [07 06 05 04 03 02 01 00]
                      00047 ;
                      00048 ; EXTENDED ID 29-bit
                      00049 ; ------------------
                      00050 ; [XX XX XX 28 27 26 25 24]  [23 22 21 20 19 18 17 16]
                      00051 ; [15 14 13 12 11 10 09 08]  [07 06 05 04 03 02 01 00]
                      00052 
                      00053 ;------------------------------------------------------------------------------
                      00054 ; MCHP STANDARD CAN ID macros
                      00055 ;------------------------------------------------------------------------------
                      00056 
                      00057 ; Take lower 3-bits in W and store in SID10..SID8, SID7..SID3 are RESET
                      00058 TXSID_10_8      MACRO   
                      00059                 ANDLW   b'00000111'
                      00060                 SWAPF   WREG,F
                      00061                 RLNCF   WREG,F
                      00062                 MOVWF   RXB0SIDH
                      00063                 ENDM
                      00064 
                      00065 ; Take upper 5-bits in W and store in SID7..SID3, SID10..SID8 are UNAFFECTED
                      00066 TXSID_7_3       MACRO   
                      00067                 ANDLW   b'11111000'
                      00068                 SWAPF   WREG,F
                      00069                 RLNCF   WREG,F
                      00070                 IORWF   RXB0SIDH,F
                      00071                 ENDM
                      00072 
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 23


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00073 ; Take lower 3-bits in W and store in SID2..SID0, EXIDEN is RESET
                      00074 TXSID_2_0       MACRO
                      00075                 ANDLW   b'00000111'
                      00076                 SWAPF   WREG,F
                      00077                 RLNCF   WREG,F
                      00078                 MOVWF   RXB0SIDL
                      00079                 ENDM
                      00080 
                      00081 ;------------------------------------------------------------------------------
                      00082 
                      00083 ; Take SID10..SID8 and store in lower 3-bits of W
                      00084 RXSID_10_8      MACRO
                      00085                 SWAPF   RXB0SIDH,W
                      00086                 RRNCF   WREG,F
                      00087                 ANDLW   b'00000111'
                      00088                 ENDM
                      00089 
                      00090 ; Take SID7..SID3 and store in upper 5-bits of CANID
                      00091 RXSID_7_0       MACRO
                      00092                 SWAPF   RXB0SIDH,W
                      00093                 RRNCF   WREG,F
                      00094                 ANDLW   b'11111000'
                      00095                 MOVWF   CANID
                      00096 
                      00097 ; Take SID2..SID0 and store in upper 3-bits of W, take lower 5-bits from CANID
                      00098                 SWAPF   RXB0SIDL,W
                      00099                 RRNCF   WREG,F
                      00100                 ANDLW   b'00000111'
                      00101                 IORWF   CANID,W
                      00102                 ENDM
                      00103 
                      00104 ;------------------------------------------------------------------------------
                      00105 ; MCHP EXTENDED CAN ID macros
                      00106 ;------------------------------------------------------------------------------
                      00107 
                      00108 ; Take lower 5-bits in W and store in EID28..EID24, EID23..EID21 are RESET
                      00109 TXEXT_28_24     MACRO   
                      00110                 ANDLW   b'00011111'
                      00111                 SWAPF   WREG,F
                      00112                 RRNCF   WREG,F
                      00113                 MOVWF   RXB0SIDH
                      00114                 ENDM
                      00115 
                      00116 ; Take upper 3-bits in W and store in EID23..EID21, EID28..EID24 are UNAFFECTED
                      00117 TXEXT_23_21     MACRO   
                      00118                 ANDLW   b'11100000'
                      00119                 SWAPF   WREG,F
                      00120                 RRNCF   WREG,F
                      00121                 IORWF   RXB0SIDH,F
                      00122                 ENDM
                      00123 
                      00124 ; Take 3-bits in W and store in EID20..EID18, EXIDEN & EID17..EID16 are RESET
                      00125 TXEXT_20_18     MACRO   
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 24


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00126                 ANDLW   b'00011100'
                      00127                 SWAPF   WREG,F
                      00128                 RRNCF   WREG,F
                      00129                 MOVWF   RXB0SIDL
                      00130                 ENDM
                      00131 
                      00132 ; Take lower 2-bits in W and store in EXIDEN & EID17..EID16, EID20..EID18 are UNAFFECTED
                      00133 TXEXT_17_16     MACRO   
                      00134                 ANDLW   b'00000011'
                      00135                 IORWF   RXB0SIDL,F
                      00136                 ENDM
                      00137 
                      00138 ;------------------------------------------------------------------------------
                      00139 
                      00140 ; Take EID28..EID24 and store in lower 5-bits of W
                      00141 RXEXT_28_24     MACRO
                      00142                 SWAPF   RXB0SIDH,W
                      00143                 RLNCF   WREG,F
                      00144                 ANDLW   b'00011111'
                      00145                 ENDM
                      00146 
                      00147 ; Take EID23..EID21 and store in upper 3-bits of CANID
                      00148 RXEXT_23_16     MACRO
                      00149                 SWAPF   RXB0SIDH,W
                      00150                 RLNCF   WREG,F
                      00151                 ANDLW   b'11100000'
                      00152                 MOVWF   CANID
                      00153 
                      00154 ; Take EID20..EID18 and store in W, take upper 3-bits from CANID
                      00155                 SWAPF   RXB0SIDL,W
                      00156                 RLNCF   WREG,F
                      00157                 ANDLW   b'00011100'
                      00158                 IORWF   CANID,F
                      00159 
                      00160 ; Take EID17..EID16 and store in W, take upper 6-bits from CANID
                      00161                 MOVF    RXB0SIDL,W
                      00162                 ANDLW   b'00000011'
                      00163                 IORWF   CANID,W
                      00164                 ENDM
                      00165 
                      00166 ;------------------------------------------------------------------------------
                      00167 ;
                      00168 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00169 ;
                      00058 
                      00059 ;------------------------------------------------------------------------------
                      00060 ; Init. CAN bus
                      00061 ;------------------------------------------------------------------------------
00017A                00062 INITCAN
                      00063 #IF CAN == PORTC
                      00064                 CLRF    TRISC
                      00065                 BSF     TRISC,7             ; CANRX I/P
                      00066 #ELSE
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 25


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00017A 6A93           00067                 CLRF    TRISB
00017C 8693           00068                 BSF     TRISB,3             ; CANRX I/P
                      00069 #ENDIF
                      00070                 ; Set configuration mode
00017E 0E80           00071                 MOVLW   (1 << REQOP2)
000180 6E6F           00072                 MOVWF   CANCON
000182                00073 INITCAN1
000182 506E           00074                 MOVF    CANSTAT,W
000184 0B80           00075                 ANDLW   (1 << OPMODE2)
000186 E0FD           00076                 BZ      INITCAN1
                      00077 
                      00078                 ; Set mask/filter
                      00079                 ;
                      00080                 ; Mask  Filter  Message
                      00081                 ; 0     x       x       accept
                      00082                 ; 1     0       0       accept
                      00083                 ; 1     0       1       reject
                      00084                 ; 1     1       0       reject
                      00085                 ; 1     1       1       accept
                      00086 
                      00087                 ; Set receive masks
000188 010E           00088                 BANKSEL RXM0SIDH
00018A 6BF8           00089                 CLRF    RXM0SIDH            ; RXB0 extended filters 0/1
00018C 6BF9           00090                 CLRF    RXM0SIDL
00018E 6BFA           00091                 CLRF    RXM0EIDH
000190 6BFB           00092                 CLRF    RXM0EIDL
                      00093 
000192 6BFC           00094                 CLRF    RXM1SIDH            ; RXB1 standard filters 2/3/4/5
000194 6BFD           00095                 CLRF    RXM1SIDL
                      00096 
                      00097                 ; Set extended receive filters for RXB0
000196 010E           00098                 BANKSEL RXF0SIDH
000198 6BE0           00099                 CLRF    RXF0SIDH
00019A 6BE2           00100                 CLRF    RXF0EIDH
00019C 6BE3           00101                 CLRF    RXF0EIDL
00019E 6BE4           00102                 CLRF    RXF1SIDH
0001A0 6BE6           00103                 CLRF    RXF1EIDH
0001A2 6BE7           00104                 CLRF    RXF1EIDL
0001A4 0E08           00105                 MOVLW   (1 << EXIDEN)       ; EXIDEN = 1
0001A6 6FE1           00106                 MOVWF   RXF0SIDL
0001A8 6FE5           00107                 MOVWF   RXF1SIDL
                      00108 
                      00109                 ; Set standard receive filters for RXB1
0001AA 010E           00110                 BANKSEL RXF2SIDH
0001AC 6BE8           00111                 CLRF    RXF2SIDH
0001AE 6BEC           00112                 CLRF    RXF3SIDH
0001B0 6BF0           00113                 CLRF    RXF4SIDH
0001B2 6BF4           00114                 CLRF    RXF5SIDH
0001B4 6BE9           00115                 CLRF    RXF2SIDL            ; EXIDEN = 0
0001B6 6BED           00116                 CLRF    RXF3SIDL
0001B8 6BF1           00117                 CLRF    RXF4SIDL
0001BA 6BF5           00118                 CLRF    RXF5SIDL
                      00119 
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 26


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00120                 ; Set bit rate
0001BC 010E           00121                 BANKSEL BRGCON1
0001BE 0E07           00122                 MOVLW   BRG1
0001C0 6F43           00123                 MOVWF   BRGCON1
0001C2 0EBC           00124                 MOVLW   BRG2
0001C4 6F44           00125                 MOVWF   BRGCON2
0001C6 0E01           00126                 MOVLW   BRG3
0001C8 6F45           00127                 MOVWF   BRGCON3
                      00128 
                      00129                 ; Enable CANTX
0001CA 010F           00130                 BANKSEL CIOCON
0001CC 8A70           00131                 BSF     CIOCON,ENDRHI
                      00132 
                      00133                 ; Reset receivers
0001CE 6A60           00134                 CLRF    RXB0CON
0001D0 6B30           00135                 CLRF    RXB1CON
                      00136 
                      00137                 ; Set normal mode
0001D2 6A6F           00138                 CLRF    CANCON
0001D4                00139 INITCAN2
0001D4 506E           00140                 MOVF    CANSTAT,W
0001D6 0BC0           00141                 ANDLW   (1 << OPMODE2) + (1 << OPMODE1)
0001D8 E1FD           00142                 BNZ     INITCAN2
                      00143 
0001DA 0012           00144                 RETURN
                      00145 
                      00146 ;------------------------------------------------------------------------------
                      00147 ; Serial Line CAN (SLCAN) Protocol 
                      00148 ;------------------------------------------------------------------------------
                      00149 
                      00150 ; TSSSEEEEEX1122334455667788\r
                      00151 ; |   |    |       |        |
                      00152 ; |   ID   DLC     DATA     EOLN
                      00153 ; |
                      00154 ; t--data frame with 11-bit ID
                      00155 ; r--RTR  frame with 11-bit ID
                      00156 ; T--data frame with 29-bit ID
                      00157 ; R--RTR  frame with 29-bit ID
                      00158 
                      00159 #DEFINE         STDDATA     't'             ; 0x74 0111 0100
                      00160 #DEFINE         STDRTR      'r'             ; 0x72 0111 0010
                      00161 #DEFINE         EXTDATA     'T'             ; 0x54 0101 0100
                      00162 #DEFINE         EXTRTR      'R'             ; 0x52 0101 0010
                      00163 
                      00164 ; C\r
                      00165 ; |
                      00166 ; O | C | F
                      00167 
                      00168 #DEFINE         OPENCMD     'O'
                      00169 #DEFINE         CLOSECMD    'C'
                      00170 #DEFINE         READSTATUS  'F'
                      00171 
                      00172 ;------------------------------------------------------------------------------
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 27


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00173 ; CAN bus functions
                      00174 ;------------------------------------------------------------------------------
                      00175 
                      00176 #INCLUDE        "canrx.inc"
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can CAN RX
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; CAN frame storage
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024                 CBLOCK
  0000000F            00025                 CANFRAME : 13
                      00026                 ENDC
                      00027 
                      00028 ;------------------------------------------------------------------------------
                      00029 ; Receive message on CAN bus and send on UART
                      00030 ;------------------------------------------------------------------------------
0001DC                00031 RXCAN
                      00032                 ; Find an Rx slot
0001DC 6A6F           00033                 CLRF    CANCON              ; Window mode off
0001DE BE60           00034                 BTFSC   RXB0CON,RXFUL
0001E0 D004           00035                 BRA     RXCANLIMIT
                      00036 
0001E2 0E0A           00037                 MOVLW   CAN_WIN_RXB1        ; Window mode on RXB1
0001E4 6E6F           00038                 MOVWF   CANCON
0001E6 AF30           00039                 BTFSS   RXB1CON,RXFUL
0001E8 0012           00040                 RETURN
                      00041 
                      00042 ;------------------------------------------------------------------------------
0001EA                00043 RXCANLIMIT
                      00044                 ; If Tx packet counter = trigger Then Drop Packet
0001EA 500A           00045                 MOVF    TXCNT,W
0001EC 0A09           00046                 XORLW   OVERFLOW
0001EE E103           00047                 BNZ     RXPACKET
                      00048 
                      00049                 CANOVFL                     ; CAN packet status LED
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 28


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                          M #IFDEF LEDHIGH
0001F0 8C8A               M                 BSF     LATB,6              ; LED1 CAN Packet dropped
                          M #ELSE
                          M                 BCF     LATB,6
                          M #ENDIF
0001F2 9E60           00050                 BCF     RXB0CON,RXFUL       ; Packet dropped
0001F4 0012           00051                 RETURN
                      00052 
                      00053 ;------------------------------------------------------------------------------
0001F6                00054 RXPACKET
0001F6 EE00 F00F      00055                 LFSR    FSR0,CANFRAME
0001FA B662           00056                 BTFSC   RXB0SIDL,EXID
0001FC D022           00057                 BRA     RXEXT
                      00058 
                      00059 ;------------------------------------------------------------------------------
0001FE                00060 RXSTD
0001FE 0E74           00061                 MOVLW   STDDATA             ; Standard data
000200 BC65           00062                 BTFSC   RXB0DLC,RXRTR
000202 0E72           00063                 MOVLW   STDRTR              ; Standard rtr
                      00064                 PUTC                        ; Tx
000204 6E09               M                 MOVWF   TXTEMP
000206 5008               M                 MOVF    TXPUT,W
000208 C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
00020C 2A08               M                 INCF    TXPUT,F             ; TXPUT++
                      00065  
                      00066                 RXSID_10_8                  ; Get SID10..8
00020E 3861               M                 SWAPF   RXB0SIDH,W
000210 42E8               M                 RRNCF   WREG,F
000212 0B07               M                 ANDLW   b'00000111'
000214 6EEE           00067                 MOVWF   POSTINC0
                      00068                 NIB2ASC                     ; Tx
000216 0B0F               M                 ANDLW   0x0F
000218 0F06               M                 ADDLW   6
00021A B2D8               M                 BTFSC   STATUS,DC
00021C 0F07               M                 ADDLW   7
00021E 0F2A               M                 ADDLW   42
                          M                 PUTC                        ; <TXBUF> = W,TXPUT++
000220 6E09               M                 MOVWF   TXTEMP
000222 5008               M                 MOVF    TXPUT,W
000224 C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
000228 2A08               M                 INCF    TXPUT,F             ; TXPUT++
                      00069 
                      00070                 RXSID_7_0                   ; Get SID7..0
00022A 3861               M                 SWAPF   RXB0SIDH,W
00022C 42E8               M                 RRNCF   WREG,F
00022E 0BF8               M                 ANDLW   b'11111000'
000230 6E0D               M                 MOVWF   CANID
                          M 
                          M ; Take SID2..SID0 and store in upper 3-bits of W, take lower 5-bits from CANID
000232 3862               M                 SWAPF   RXB0SIDL,W
000234 42E8               M                 RRNCF   WREG,F
000236 0B07               M                 ANDLW   b'00000111'
000238 100D               M                 IORWF   CANID,W
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 29


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00023A 6EEE           00071                 MOVWF   POSTINC0
00023C ECA5 F000      00072                 CALL    BIN2ASC             ; Tx
                      00073 
000240 D025           00074                 BRA     RXCANDLC
                      00075 
                      00076 ;------------------------------------------------------------------------------
000242                00077 RXEXT
000242 0E54           00078                 MOVLW   EXTDATA             ; Extended data
000244 BC65           00079                 BTFSC   RXB0DLC,RXRTR
000246 0E52           00080                 MOVLW   EXTRTR              ; Extended rtr
                      00081                 PUTC                        ; Tx
000248 6E09               M                 MOVWF   TXTEMP
00024A 5008               M                 MOVF    TXPUT,W
00024C C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
000250 2A08               M                 INCF    TXPUT,F             ; TXPUT++
                      00082  
                      00083                 RXEXT_28_24                 ; Get EID28..EID24
000252 3861               M                 SWAPF   RXB0SIDH,W
000254 46E8               M                 RLNCF   WREG,F
000256 0B1F               M                 ANDLW   b'00011111'
000258 6EEE           00084                 MOVWF   POSTINC0
00025A ECA5 F000      00085                 CALL    BIN2ASC             ; Tx
                      00086 
                      00087                 RXEXT_23_16                 ; Get EID23..EID16
00025E 3861               M                 SWAPF   RXB0SIDH,W
000260 46E8               M                 RLNCF   WREG,F
000262 0BE0               M                 ANDLW   b'11100000'
000264 6E0D               M                 MOVWF   CANID
                          M 
                          M ; Take EID20..EID18 and store in W, take upper 3-bits from CANID
000266 3862               M                 SWAPF   RXB0SIDL,W
000268 46E8               M                 RLNCF   WREG,F
00026A 0B1C               M                 ANDLW   b'00011100'
00026C 120D               M                 IORWF   CANID,F
                          M 
                          M ; Take EID17..EID16 and store in W, take upper 6-bits from CANID
00026E 5062               M                 MOVF    RXB0SIDL,W
000270 0B03               M                 ANDLW   b'00000011'
000272 100D               M                 IORWF   CANID,W
000274 6EEE           00088                 MOVWF   POSTINC0
000276 ECA5 F000      00089                 CALL    BIN2ASC             ; Tx
                      00090 
00027A 5063           00091                 MOVF    RXB0EIDH,W          ; Get EID15..EID8
00027C 6EEE           00092                 MOVWF   POSTINC0
00027E ECA5 F000      00093                 CALL    BIN2ASC             ; Tx
                      00094 
000282 5064           00095                 MOVF    RXB0EIDL,W          ; Get EID7..EID0
000284 6EEE           00096                 MOVWF   POSTINC0
000286 ECA5 F000      00097                 CALL    BIN2ASC             ; Tx
                      00098 
00028A 8E0F           00099                 BSF     CANFRAME,7          ; mark as extended frame
                      00100 
                      00101 ;------------------------------------------------------------------------------
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 30


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00028C                00102 RXCANDLC
00028C 8C0F           00103                 BSF     CANFRAME,6          ; mark as new frame
                      00104 
00028E 5065           00105                 MOVF    RXB0DLC,W           ; Get DLC
000290 0B0F           00106                 ANDLW   0x0F
000292 6EEE           00107                 MOVWF   POSTINC0
000294 6E0E           00108                 MOVWF   CANCNT
000296 0930           00109                 IORLW   0x30
                      00110                 PUTC                        ; Tx
000298 6E09               M                 MOVWF   TXTEMP
00029A 5008               M                 MOVF    TXPUT,W
00029C C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
0002A0 2A08               M                 INCF    TXPUT,F             ; TXPUT++
                      00111 
                      00112 ;------------------------------------------------------------------------------
                      00113 
0002A2 500E           00114                 MOVF    CANCNT,W            ; Get message
0002A4 E018           00115                 BZ      RXCANEOLN
                      00116 
0002A6 EE0F F066      00117                 LFSR    FSR0,RXB0D0
0002AA                00118 RXCANMESG
0002AA 50EE           00119                 MOVF    POSTINC0,W
0002AC DF4E           00120                 RCALL   BIN2ASC             ; Tx
                      00121                 DJNZ    CANCNT,RXCANMESG
0002AE 2E0E               M                 DECFSZ  CANCNT,F
0002B0 D7FC               M                 BRA     RXCANMESG
                      00122 
                      00123 ;------------------------------------------------------------------------------
                      00124 ;
                      00125 
0002B2 EE00 F014      00126                 LFSR    FSR0,CANFRAME+5
0002B6 CF66 FFEE      00127                 MOVFF   RXB0D0,POSTINC0
0002BA CF67 FFEE      00128                 MOVFF   RXB0D1,POSTINC0
0002BE CF68 FFEE      00129                 MOVFF   RXB0D2,POSTINC0
0002C2 CF69 FFEE      00130                 MOVFF   RXB0D3,POSTINC0
0002C6 CF6A FFEE      00131                 MOVFF   RXB0D4,POSTINC0
0002CA CF6B FFEE      00132                 MOVFF   RXB0D5,POSTINC0
0002CE CF6C FFEE      00133                 MOVFF   RXB0D6,POSTINC0
0002D2 CF6D FFEE      00134                 MOVFF   RXB0D7,POSTINC0
                      00135 
                      00136 ;------------------------------------------------------------------------------
0002D6                00137 RXCANEOLN
                      00138 
0002D6 0E0D           00139                 MOVLW   EOLNCHAR
                      00140                 PUTC                        ; Tx
0002D8 6E09               M                 MOVWF   TXTEMP
0002DA 5008               M                 MOVF    TXPUT,W
0002DC C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
0002E0 2A08               M                 INCF    TXPUT,F             ; TXPUT++
                      00141 
0002E2 2A0A           00142                 INCF    TXCNT,F             ; Tx packet counter++
0002E4 88A3           00143                 BSF     UPIE,UTXIE          ; Enable Tx ring ISR
                      00144 
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 31


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00145 ;------------------------------------------------------------------------------
                      00146 
                      00147                 CANRECV                     ; CAN packet status LED
                          M #IFDEF LEDHIGH
0002E6 9C8A               M                 BCF     LATB,6              ; LED1 CAN Packet received
                          M #ELSE
                          M                 BSF     LATB,6
                          M #ENDIF
0002E8 9E60           00148                 BCF     RXB0CON,RXFUL       ; Packet received
0002EA 0012           00149                 RETURN
                      00150 
                      00151 ;------------------------------------------------------------------------------
                      00152 ;
                      00153 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00154 ;
                      00177 #INCLUDE        "cantx.inc"
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can CAN TX
                      00004 ;
                      00005 ; Copyright (c) 2014 Darron M Broad
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; Receive message on UART and send on CAN bus
                      00022 ;------------------------------------------------------------------------------
0002EC                00023 TXCAN
0002EC 5006           00024                 MOVF    RXCNT,W             ; If Rx packet counter > 0
0002EE E101           00025                 BNZ     TXCAN1
0002F0 0012           00026                 RETURN
                      00027 
                      00028 ;------------------------------------------------------------------------------
0002F2                00029 TXCAN1
                      00030                 ; Find a Tx slot
0002F2 0E08           00031                 MOVLW   CAN_WIN_TXB0        ; Window mode on TXB0
0002F4 6E6F           00032                 MOVWF   CANCON
0002F6 A720           00033                 BTFSS   TXB0CON,TXREQ
0002F8 D008           00034                 BRA     TXCAN2
                      00035 
0002FA 0E06           00036                 MOVLW   CAN_WIN_TXB1        ; Window mode on TXB1
0002FC 6E6F           00037                 MOVWF   CANCON
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 32


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

0002FE A710           00038                 BTFSS   TXB1CON,TXREQ
000300 D004           00039                 BRA     TXCAN2
                      00040 
000302 0E04           00041                 MOVLW   CAN_WIN_TXB2        ; Window mode on TXB2
000304 6E6F           00042                 MOVWF   CANCON
000306 B700           00043                 BTFSC   TXB2CON,TXREQ
000308 0012           00044                 RETURN
                      00045 
                      00046 ;------------------------------------------------------------------------------
00030A                00047 TXCAN2
                      00048                 GETC                        ; W = <RXBUF>,RXGET++
00030A 5003               M                 MOVF    RXGET,W
00030C 50E3               M                 MOVF    PLUSW1,W
00030E 2A03               M                 INCF    RXGET,F             ; RXGET++
                      00049 
000310 6E0C           00050                 MOVWF   CANCMD              ; t?
000312 0A74           00051                 XORLW   STDDATA
000314 E00A           00052                 BZ      TXCANSTD
000316 500C           00053                 MOVF    CANCMD,W            ; r?
000318 0A72           00054                 XORLW   STDRTR
00031A E007           00055                 BZ      TXCANSTD
                      00056 
00031C 500C           00057                 MOVF    CANCMD,W            ; T?
00031E 0A54           00058                 XORLW   EXTDATA
000320 E019           00059                 BZ      TXCANEXT
000322 500C           00060                 MOVF    CANCMD,W            ; r?
000324 0A52           00061                 XORLW   EXTRTR
000326 E016           00062                 BZ      TXCANEXT
                      00063 
000328 D058           00064                 BRA     TXCANEND            ; Unsupported
                      00065 
                      00066 ;------------------------------------------------------------------------------
00032A                00067 TXCANSTD
00032A DF06           00068                 RCALL   ASC2NIB             ; GETC
00032C 6E0F           00069                 MOVWF   CANFRAME
                      00070                 TXSID_10_8                  ; Set SID10..8
00032E 0B07               M                 ANDLW   b'00000111'
000330 3AE8               M                 SWAPF   WREG,F
000332 46E8               M                 RLNCF   WREG,F
000334 6E61               M                 MOVWF   RXB0SIDH
                      00071 
000336 EE00 F00D      00072                 LFSR    FSR0,CANID
00033A DEF8           00073                 RCALL   ASC2BIN             ; GETC, GETC
                      00074 
00033C 500D           00075                 MOVF    CANID,W
00033E 6E10           00076                 MOVWF   CANFRAME+1
                      00077                 TXSID_7_3                   ; Set SID7..3
000340 0BF8               M                 ANDLW   b'11111000'
000342 3AE8               M                 SWAPF   WREG,F
000344 46E8               M                 RLNCF   WREG,F
000346 1261               M                 IORWF   RXB0SIDH,F
                      00078 
000348 500D           00079                 MOVF    CANID,W
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 33


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00080                 TXSID_2_0                   ; Set SID2..0
00034A 0B07               M                 ANDLW   b'00000111'
00034C 3AE8               M                 SWAPF   WREG,F
00034E 46E8               M                 RLNCF   WREG,F
000350 6E62               M                 MOVWF   RXB0SIDL
                      00081 
000352 D024           00082                 BRA     TXCAN3
                      00083 
                      00084 ;------------------------------------------------------------------------------
000354                00085 TXCANEXT
000354 EE00 F00D      00086                 LFSR    FSR0,CANID
000358 DEE9           00087                 RCALL   ASC2BIN             ; GETC, GETC
                      00088 
00035A 500D           00089                 MOVF    CANID,W
00035C 6E0F           00090                 MOVWF   CANFRAME
00035E 8E0F           00091                 BSF     CANFRAME,7          ; mark as extended frame
                      00092                 TXEXT_28_24                 ; Set EID28..24
000360 0B1F               M                 ANDLW   b'00011111'
000362 3AE8               M                 SWAPF   WREG,F
000364 42E8               M                 RRNCF   WREG,F
000366 6E61               M                 MOVWF   RXB0SIDH
                      00093 
000368 EE00 F00D      00094                 LFSR    FSR0,CANID
00036C DEDF           00095                 RCALL   ASC2BIN             ; GETC, GETC
                      00096 
00036E 500D           00097                 MOVF    CANID,W
000370 6E10           00098                 MOVWF   CANFRAME+1
                      00099                 TXEXT_23_21                 ; Set EID23..21
000372 0BE0               M                 ANDLW   b'11100000'
000374 3AE8               M                 SWAPF   WREG,F
000376 42E8               M                 RRNCF   WREG,F
000378 1261               M                 IORWF   RXB0SIDH,F
                      00100 
00037A 500D           00101                 MOVF    CANID,W
                      00102                 TXEXT_20_18                 ; Set EID20..18
00037C 0B1C               M                 ANDLW   b'00011100'
00037E 3AE8               M                 SWAPF   WREG,F
000380 42E8               M                 RRNCF   WREG,F
000382 6E62               M                 MOVWF   RXB0SIDL
                      00103 
000384 500D           00104                 MOVF    CANID,W
                      00105                 TXEXT_17_16                 ; Set EID17..16
000386 0B03               M                 ANDLW   b'00000011'
000388 1262               M                 IORWF   RXB0SIDL,F
                      00106 
00038A 8662           00107                 BSF     RXB0SIDL,EXIDEN     ; Enable Extended Id
                      00108 
00038C EE0F F063      00109                 LFSR    FSR0,RXB0EIDH       ; Set EID15..8
000390 DECD           00110                 RCALL   ASC2BIN             ; GETC, GETC
000392 6E11           00111                 MOVWF   CANFRAME+2
                      00112 
000394 EE0F F064      00113                 LFSR    FSR0,RXB0EIDL       ; Set EID7..0
000398 DEC9           00114                 RCALL   ASC2BIN             ; GETC, GETC
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 34


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00039A 6E12           00115                 MOVWF   CANFRAME+3
                      00116 
                      00117 ;------------------------------------------------------------------------------
00039C                00118 TXCAN3
00039C 6A13           00119                 CLRF    CANFRAME+4
00039E 6A65           00120                 CLRF    RXB0DLC             ; Set RTR
0003A0 B20C           00121                 BTFSC   CANCMD,1            ; r or R?
0003A2 8C65           00122                 BSF     RXB0DLC,TXRTR
                      00123 
0003A4 DEC9           00124                 RCALL   ASC2NIB             ; GETC
0003A6 E018           00125                 BZ      TXCAN5
                      00126 
0003A8 6E0E           00127                 MOVWF   CANCNT
0003AA 6E13           00128                 MOVWF   CANFRAME+4
0003AC 1265           00129                 IORWF   RXB0DLC,F           ; Set DLC
                      00130 
                      00131 ;------------------------------------------------------------------------------
                      00132 
0003AE EE0F F066      00133                 LFSR    FSR0,RXB0D0
0003B2                00134 TXCAN4
0003B2 DEBC           00135                 RCALL   ASC2BIN             ; Set data
                      00136                 DJNZ    CANCNT,TXCAN4
0003B4 2E0E               M                 DECFSZ  CANCNT,F
0003B6 D7FD               M                 BRA     TXCAN4
                      00137 
0003B8 CF66 F014      00138                 MOVFF   RXB0D0,CANFRAME+5
0003BC CF67 F015      00139                 MOVFF   RXB0D1,CANFRAME+6
0003C0 CF68 F016      00140                 MOVFF   RXB0D2,CANFRAME+7
0003C4 CF69 F017      00141                 MOVFF   RXB0D3,CANFRAME+8
0003C8 CF6A F018      00142                 MOVFF   RXB0D4,CANFRAME+9
0003CC CF6B F019      00143                 MOVFF   RXB0D5,CANFRAME+10
0003D0 CF6C F01A      00144                 MOVFF   RXB0D6,CANFRAME+11
0003D4 CF6D F01B      00145                 MOVFF   RXB0D7,CANFRAME+12
                      00146 
                      00147 ;------------------------------------------------------------------------------
0003D8                00148 TXCAN5
0003D8 8660           00149                 BSF     RXB0CON,TXREQ       ; Tx
                      00150 
                      00151 ;------------------------------------------------------------------------------
0003DA                00152 TXCANEND
0003DA 8C0F           00153                 BSF     CANFRAME,6          ; mark as new frame
                      00154                 GETC                        ; W = <RXBUF>,RXGET++
0003DC 5003               M                 MOVF    RXGET,W
0003DE 50E3               M                 MOVF    PLUSW1,W
0003E0 2A03               M                 INCF    RXGET,F             ; RXGET++
0003E2 0A0D           00155                 XORLW   EOLNCHAR
0003E4 E1FA           00156                 BNZ     TXCANEND
                      00157 
0003E6 0606           00158                 DECF    RXCNT,F             ; Rx packet counter--
0003E8 E101           00159                 BNZ     TXCANRET            ; Flow control off?
                      00160 
                      00161                 ; Clear to Send; RXCNT = 0
                      00162                 RTSCLR
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 35


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

0003EA 988A               M                 BCF     LATB,4              ; RTS/CTS CLEAR TO SEND
0003EC                00163 TXCANRET
0003EC 0012           00164                 RETURN
                      00165 
                      00166 ;------------------------------------------------------------------------------
                      00167 ;
                      00168 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00169 ;
                      00178 
                      00179 ;------------------------------------------------------------------------------
                      00180 ;
                      00181 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00182 ;
                      00159 #INCLUDE        "timer.inc"                 ; Timer
                      00001 ;
                      00002 ; Can-Can TIMER
                      00003 ;
                      00004 ; Copyright (c) 2015 Gerhard Bertelsmann
                      00005 ;
                      00006 ;------------------------------------------------------------------------------
                      00007 ;
                      00008 ; This file is part of the Can-Can CAN bus interface project.
                      00009 ;
                      00010 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00011 ;
                      00012 ; See file /LICENSE for details.
                      00013 ; 
                      00014 ;------------------------------------------------------------------------------
                      00015 
                      00016                 LIST
                      00017                 RADIX   DEC
                      00018 
                      00019 ;------------------------------------------------------------------------------
                      00020 ; Timer variables
                      00021 ;------------------------------------------------------------------------------
                      00022 
                      00023                 CBLOCK
  0000001C            00024                 TCOUNTER : 1
  0000001D            00025                 PIOTCOUNTER : 1
  0000001E            00026                 HEARTBEAT : 1
                      00027                 ENDC
                      00028 
                      00029 ;------------------------------------------------------------------------------
                      00030 ; settings
                      00031 ;------------------------------------------------------------------------------
                      00032 
                      00033 #define PCBV    2
                      00034 
                      00035 #IF PCBV == 1
                      00036   #DEFINE       LED         2
                      00037 #ELSE
                      00038   #DEFINE       LED         1
                      00039 #ENDIF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 36


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00040 
                      00041 
                      00042 ;------------------------------------------------------------------------------
                      00043 ; Init. Timer
                      00044 ;------------------------------------------------------------------------------
0003EE                00045 TIMER0INIT
                      00046                 ; timer period = 1/16MHz = 0.0625 us
                      00047                 ; prescaler period = .0625us * 32 = 2 us
                      00048                 ; overflow period  = 2 us * 256 = 512 us
                      00049 
0003EE 0EC4           00050                 MOVLW   (1 << TMR0ON) + (1 << T08BIT) + (1 << T0PS2)
0003F0 6ED5           00051                 MOVWF   T0CON
0003F2 6A1E           00052                 CLRF    HEARTBEAT
0003F4 0E14           00053                 MOVLW   20              ; 20 * 512us = 10ms
0003F6 6E1D           00054                 MOVWF   PIOTCOUNTER
0003F8 0012           00055                 RETURN
                      00056 
0003FA                00057 SCHEDULE
                      00058                 ; must reset Timer0 overflow flag
0003FA 94F2           00059                 BCF     INTCON, TMR0IF
0003FC 4A1C           00060                 INFSNZ  TCOUNTER,F      ; heartbeat routine
0003FE D809           00061                 RCALL   DO_HEARTBEAT
                      00062 
000400 4E1D           00063                 DCFSNZ  PIOTCOUNTER,F   ; PIO routine
000402 D802           00064                 RCALL   DO_PIO
                      00065 
                      00066                 ; look for events in the buffer
000404 D9AE           00067                 RCALL   SENDEVENT
000406 0012           00068                 RETURN
                      00069 
000408                00070 DO_PIO
000408 D8EF           00071                 RCALL   PIOGET          ; PIO service routine - any PIO change ?
00040A D8D1           00072                 RCALL   GENEVENT        ; buffer events
00040C 0E14           00073                 MOVLW   20              ; 20 * 512us  - check PIO state in 10 ms next time
                      00074                 ; MOVF    SCAN_INTERVAL,W       ; x * 512us  - check PIO state in X ms next time
00040E 6E1D           00075                 MOVWF   PIOTCOUNTER
000410 0012           00076                 RETURN
                      00077 
                      00078 
                      00079 
000412                00080 DO_HEARTBEAT
                      00081                 ; 512 us * 256 = 131 ms
                      00082                 ; limit to 8 * 131 ms = 1.049 s
000412 2A1E           00083                 INCF    HEARTBEAT,F
000414 0E07           00084                 MOVLW   7
000416 161E           00085                 ANDWF   HEARTBEAT,F
                      00086                 ; doing heartbeat - sequence starts on 1 to enable resetting HEARTBEAT var
                      00087                 ; for other blinking events
000418 0E00           00088                 MOVLW   0
00041A 641E           00089                 CPFSGT  HEARTBEAT
00041C D00B           00090                 BRA     STATUS_LED_ON
00041E 0E01           00091                 MOVLW   1
000420 641E           00092                 CPFSGT  HEARTBEAT
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 37


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000422 D006           00093                 BRA     STATUS_LED_OFF
000424 0E02           00094                 MOVLW   2
000426 641E           00095                 CPFSGT  HEARTBEAT
000428 D005           00096                 BRA     STATUS_LED_ON
00042A 0E03           00097                 MOVLW   3
00042C 641E           00098                 CPFSGT  HEARTBEAT
00042E D000           00099                 BRA     STATUS_LED_OFF
                      00100 
000430                00101 STATUS_LED_OFF
000430 828B           00102                 BSF     LATC, LED
000432 0012           00103                 RETURN
                      00104 
000434                00105 STATUS_LED_ON
000434 928B           00106                 BCF     LATC, LED
000436 0012           00107                 RETURN
                      00108 
                      00109 ;
                      00110 ; vim: set shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00111 ;
                      00160 #INCLUDE        "i2c.inc"                   ; I2C
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; Can-Can I2C
                      00004 ;
                      00005 ; Copyright (c) 2015 Gerhard Bertelsmann
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the Can-Can CAN bus interface project.
                      00010 ;
                      00011 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; I2C settings
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024 #DEFINE I2CBAUD ((((CLOCK / I2CRATE) / 2) - 1) / 2)
                      00025 
                      00026 ;------------------------------------------------------------------------------
                      00027 ; Init. I2C
                      00028 ;------------------------------------------------------------------------------
000438                00029 I2CINIT
                      00030                 ; clear the upper two bits
000438 0E3F           00031                 MOVLW   0x3F
00043A 16C7           00032                 ANDWF   SSPSTAT,F
                      00033                 ; set I2C rate
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 38


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00043C 0E27           00034                 MOVLW   I2CBAUD
00043E 6EC8           00035                 MOVWF   SSPADD
000440 6AC6           00036                 CLRF    SSPCON1
000442 6AC5           00037                 CLRF    SSPCON2
000444 9EC7           00038                 BCF     SSPSTAT,SMP
000446 8CC7           00039                 BSF     SSPSTAT,CKE
                      00040                 ; configure SCL and SDL as input
000448 8694           00041                 BSF     TRISC,3
00044A 8894           00042                 BSF     TRISC,4
                      00043                 ; master mode
00044C 0E28           00044                 MOVLW   (1 << SSPEN) + (1 << SSPM3)
00044E 12C6           00045                 IORWF   SSPCON1,F
000450 0012           00046                 RETURN
                      00047 
                      00048 ;
                      00049 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00050 ;
                      00161 #INCLUDE        "id.inc"                    ; UID
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; CANBuster ID routines
                      00004 ;
                      00005 ; Copyright (c) 2016 Gerhard Bertelsmann
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the CANBuster project.
                      00010 ;
                      00011 ; CANBuster is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 
                      00021 ;------------------------------------------------------------------------------
                      00022 ; Generic Flash routines
                      00023 ;------------------------------------------------------------------------------
                      00024 
000452                00025 EEPROM_REFRESH
000452 6A74           00026                 CLRF    EEADR           ; Start at address 0
000454 6A75           00027                 CLRF    EEADRH
000456 9C7F           00028                 BCF     EECON1, CFGS    ; Set for memory
000458 9E7F           00029                 BCF     EECON1, EEPGD   ; Set for Data EEPROM
00045A 9EF2           00030                 BCF     INTCON, GIE     ; Disable interrupts
00045C 847F           00031                 BSF     EECON1, WREN    ; Enable writes
                      00032 
00045E                00033 EEPROM_REFRESH_LOOP     ; Loop to refresh array
00045E 807F           00034                 BSF     EECON1, RD      ; Read current address
000460 0E55           00035                 MOVLW   55h
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 39


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000462 6E7E           00036                 MOVWF   EECON2
000464 0EAA           00037                 MOVLW   0AAh
000466 6E7E           00038                 MOVWF   EECON2
000468 827F           00039                 BSF     EECON1, WR      ; Set WR bit to begin write
00046A B27F           00040                 BTFSC   EECON1, WR      ; Wait for write to complete
00046C D7FE           00041                 BRA $-2
00046E 3E74           00042                 INCFSZ  EEADR, F        ; Increment address
000470 D7F6           00043                 BRA     EEPROM_REFRESH_LOOP     ; Not zero, do it again
000472 3E75           00044                 INCFSZ  EEADRH, F       ; Increment the high address
000474 D7F4           00045                 BRA     EEPROM_REFRESH_LOOP     ; Not zero, do it again
000476 947F           00046                 BCF     EECON1, WREN    ; Disable writes
000478 8EF2           00047                 BSF     INTCON, GIE     ; Enable interrupts
00047A 0012           00048                 RETURN
                      00049 
                      00050 
00047C                00051 ERASE_DATA
00047C 8E7F           00052                 BSF     EECON1, EEPGD   ; point to Flash program memory
00047E 9C7F           00053                 BCF     EECON1, CFGS    ; access Flash program memory
000480 847F           00054                 BSF     EECON1, WREN    ; enable write to memory
000482 887F           00055                 BSF     EECON1, FREE
                      00056 
000484 9EF2           00057                 BCF     INTCON, GIE     ; disable interrupts
000486 0E55           00058                 MOVLW   0x55
000488 6E7E           00059                 MOVWF   EECON2
00048A 0EAA           00060                 MOVLW   0xAA
00048C 6E7E           00061                 MOVWF   EECON2
00048E 827F           00062                 BSF     EECON1, WR      ; start program (CPU stall)
000490 0000           00063                 NOP
                      00064 
000492 8EF2           00065                 BSF     INTCON, GIE     ; enable interrupts
000494 947F           00066                 BCF     EECON1, WREN    ; Disable writes on write complete (EEIF set)
000496 0012           00067                 RETURN
                      00068 
000498                00069 FIN_WRITE_DATA
000498 8E7F           00070                 BSF     EECON1, EEPGD   ; point to Flash program memory
00049A 9C7F           00071                 BCF     EECON1, CFGS    ; access Flash program memory
00049C 847F           00072                 BSF     EECON1, WREN    ; enable write to memory
00049E 987F           00073                 BCF     EECON1, FREE
                      00074 
0004A0 9EF2           00075                 BCF     INTCON, GIE     ; disable interrupts
0004A2 0E55           00076                 MOVLW   0x55
0004A4 6E7E           00077                 MOVWF   EECON2
0004A6 0EAA           00078                 MOVLW   0xAA
0004A8 6E7E           00079                 MOVWF   EECON2
0004AA 827F           00080                 BSF     EECON1, WR      ; start program (CPU stall)
                      00081 
0004AC 8EF2           00082                 BSF     INTCON, GIE     ; enable interrupts
0004AE 947F           00083                 BCF     EECON1, WREN    ; Disable writes on write complete (EEIF set)
0004B0 0012           00084                 RETURN
                      00085 
                      00086 ;------------------------------------------------------------------------------
                      00087 ; Location ID routines
                      00088 ;------------------------------------------------------------------------------
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 40


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00089 ;------------------------------------------------------------------------------
                      00090 ; Location ID
                      00091 ; 0x200000      UID High
                      00092 ; 0x200001      UID Low
                      00093 ; 0x200002      Start counting at X-High for event
                      00094 ; 0x200003      Start counting at X-Low for event
                      00095 ; 0x200004      Start counting at X-High for event - S88
                      00096 ; 0x200005      Start counting at X-Low for event - S88
                      00097 ; 0x200006      Scan Interval (in 512us steps)
                      00098 ; 0x200007      free
                      00099 ;------------------------------------------------------------------------------
                      00100 
0004B2                00101 SETLOCIDP
0004B2 6EF6           00102                 MOVWF   TBLPTRL
0004B4 6AF7           00103                 CLRF    TBLPTRH
0004B6 0E20           00104                 MOVLW   20h
0004B8 6EF8           00105                 MOVWF   TBLPTRU
0004BA 0012           00106                 RETURN
                      00107 
0004BC                00108 READUID
                      00109                 ; read ID and counting numbers
0004BC 0E00           00110                 MOVLW   0
0004BE DFF9           00111                 RCALL   SETLOCIDP
0004C0 0009           00112                 TBLRD*+
0004C2 CFF5 F042      00113                 MOVFF   TABLAT,ID_H
0004C6 0009           00114                 TBLRD*+
0004C8 CFF5 F043      00115                 MOVFF   TABLAT,ID_L
0004CC 0009           00116                 TBLRD*+
0004CE CFF5 F044      00117                 MOVFF   TABLAT,PIOC_H
0004D2 0009           00118                 TBLRD*+
0004D4 CFF5 F045      00119                 MOVFF   TABLAT,PIOC_L
0004D8 0009           00120                 TBLRD*+
0004DA CFF5 F046      00121                 MOVFF   TABLAT,S88C_H
0004DE 0009           00122                 TBLRD*+
0004E0 CFF5 F047      00123                 MOVFF   TABLAT,S88C_L
0004E4 0009           00124                 TBLRD*+
0004E6 CFF5 F048      00125                 MOVFF   TABLAT,SCAN_INTERVAL
0004EA 0012           00126                 RETURN
                      00127 
0004EC                00128 SETUID
                      00129                 ; set ID and counting numbers
0004EC 0E00           00130                 MOVLW   0
0004EE DFE1           00131                 RCALL   SETLOCIDP
0004F0 DFC5           00132                 RCALL   ERASE_DATA
                      00133 
0004F2 C042 FFF5      00134                 MOVFF   ID_H,TABLAT
0004F6 000D           00135                 TBLWT*+
0004F8 C043 FFF5      00136                 MOVFF   ID_L,TABLAT
0004FC 000D           00137                 TBLWT*+
0004FE C044 FFF5      00138                 MOVFF   PIOC_H,TABLAT
000502 000D           00139                 TBLWT*+
000504 C045 FFF5      00140                 MOVFF   PIOC_L,TABLAT
000508 000D           00141                 TBLWT*+
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 41


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00050A C046 FFF5      00142                 MOVFF   S88C_H,TABLAT
00050E 000D           00143                 TBLWT*+
000510 C047 FFF5      00144                 MOVFF   S88C_L,TABLAT
000514 000D           00145                 TBLWT*+
000516 C048 FFF5      00146                 MOVFF   SCAN_INTERVAL,TABLAT
00051A 000D           00147                 TBLWT*+
                      00148 
00051C 0E00           00149                 MOVLW   0
00051E DFC9           00150                 RCALL   SETLOCIDP
000520 DFBB           00151                 RCALL   FIN_WRITE_DATA
                      00152 
000522 0012           00153                 RETURN
                      00154 
                      00155 ;------------------------------------------------------------------------------
                      00156 ; Set CAN Hash according to Maerklin documentation
                      00157 ;------------------------------------------------------------------------------
000524                00158 READCANHASH
000524 DFCB           00159                 RCALL   READUID
000526 0E43           00160                 MOVLW   'C'
000528 1842           00161                 XORWF   ID_H,W
00052A 6E41           00162                 MOVWF   CANHASH_HIGH
                      00163                 ; shift left 3
00052C 3A41           00164                 SWAPF   CANHASH_HIGH,F
00052E 4241           00165                 RRNCF   CANHASH_HIGH,F
                      00166                 ; set two lower bits
000530 8041           00167                 BSF     CANHASH_HIGH,0
000532 8241           00168                 BSF     CANHASH_HIGH,1
                      00169 
000534 0E42           00170                 MOVLW   'B'
000536 1843           00171                 XORWF   ID_L,W
000538 6E40           00172                 MOVWF   CANHASH_LOW
00053A 8441           00173                 BSF     CANHASH_HIGH,2
00053C AE43           00174                 BTFSS   ID_L,7
00053E 9441           00175                 BCF     CANHASH_HIGH,2
000540 9E40           00176                 BCF     CANHASH_LOW,7
000542 0012           00177                 RETURN
                      00178 
                      00179 ;
                      00180 ; vim: set shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00181 ;
                      00162 #INCLUDE        "pio.inc"                   ; PIO
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; CANBuster PIO
                      00004 ;
                      00005 ; Copyright (c) 2016 Gerhard Bertelsmann
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the CANBuster project.
                      00010 ;
                      00011 ; CANBuster is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 42


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; PIO variables
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024                 CBLOCK
  0000001F            00025                 PIOTIME : 16
  0000002F            00026                 PIOTEMP : 1
  00000030            00027                 MASK : 1
  00000031            00028                 ACTUAL : 1
  00000032            00029                 PIOTEMP16 : 2
  00000034            00030                 BUT_CT0 : 1
  00000035            00031                 DEBUG_BUT : 1
  00000036            00032                 BUT_CT1 : 1
  00000037            00033                 TOP_CT0 : 1
  00000038            00034                 DEBUG_TOP : 1
  00000039            00035                 TOP_CT1 : 1
  0000003A            00036                 BUT_VAL_NEW : 1
  0000003B            00037                 BUT_VAL_CHG : 1
  0000003C            00038                 BUT_VAL_STATE : 1
  0000003D            00039                 TOP_VAL_NEW : 1
  0000003E            00040                 TOP_VAL_CHG : 1
  0000003F            00041                 TOP_VAL_STATE : 1
  00000040            00042                 CANHASH_LOW : 1
  00000041            00043                 CANHASH_HIGH: 1
  00000042            00044                 ID_H : 1
  00000043            00045                 ID_L : 1
  00000044            00046                 PIOC_H : 1
  00000045            00047                 PIOC_L : 1
  00000046            00048                 S88C_H : 1
  00000047            00049                 S88C_L : 1
  00000048            00050                 SCAN_INTERVAL : 1
                      00051                 ENDC
                      00052 
                      00053 ;------------------------------------------------------------------------------
                      00054 ; Init. PIO
                      00055 ;------------------------------------------------------------------------------
                      00056 
000544                00057 PIOINIT
                      00058                 ; set ports as inputs
                      00059 
                      00060                 ; RA0-3, RA5
000544 0E2F           00061                 MOVLW   b'00101111'
000546 1292           00062                 IORWF   TRISA,F
                      00063 
                      00064                 ; RB0, RB1
000548 0E03           00065                 MOVLW   b'00000011'
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 43


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00054A 1293           00066                 IORWF   TRISB,F
                      00067 
                      00068 #IFDEF PIO
                      00069                 ; RDO-5
00054C 0E3F           00070                 MOVLW   b'00111111'
00054E 1295           00071                 IORWF   TRISD,F
                      00072 
                      00073                 ; RE0-2
000550 0E07           00074                 MOVLW   b'00000111'
000552 1296           00075                 IORWF   TRISE,F
                      00076 #ENDIF
                      00077                 ; set vars to 0xff
000554 683A           00078                 SETF    BUT_VAL_NEW
000556 683B           00079                 SETF    BUT_VAL_CHG
000558 683C           00080                 SETF    BUT_VAL_STATE
00055A 683D           00081                 SETF    TOP_VAL_NEW
00055C 683E           00082                 SETF    TOP_VAL_CHG
00055E 683F           00083                 SETF    TOP_VAL_STATE
000560 6834           00084                 SETF    BUT_CT0
000562 6836           00085                 SETF    BUT_CT1
000564 6837           00086                 SETF    TOP_CT0
000566 6839           00087                 SETF    TOP_CT1
                      00088 
                      00089                 ; delete timers
000568 0E10           00090                 MOVLW   16
00056A 6E2F           00091                 MOVWF   PIOTEMP
00056C EE00 F01F      00092                 LFSR    FSR0,PIOTIME
000570                00093 PTIMECLLOOP
000570 6AEE           00094                 CLRF    POSTINC0
000572 2E2F           00095                 DECFSZ  PIOTEMP,F
000574 D7FD           00096                 BRA     PTIMECLLOOP
                      00097 
000576 D7D6           00098                 BRA     READCANHASH
                      00099 
                      00100                 ; debouncing code from Peter Danegger
000578                00101 PIODEBOUNCE
000578 1C3D           00102                 COMF    TOP_VAL_NEW,W
00057A 183F           00103                 XORWF   TOP_VAL_STATE,W         ; port changed ?
00057C 6E2F           00104                 MOVWF   PIOTEMP
00057E 1637           00105                 ANDWF   TOP_CT0,F               ; reset or count ct0
000580 1E37           00106                 COMF    TOP_CT0,F
000582 5039           00107                 MOVF    TOP_CT1,W               ; reset or count ct1
000584 142F           00108                 ANDWF   PIOTEMP,W
000586 1837           00109                 XORWF   TOP_CT0,W
000588 6E39           00110                 MOVWF   TOP_CT1
00058A 1437           00111                 ANDWF   TOP_CT0,W
00058C 142F           00112                 ANDWF   PIOTEMP,W
00058E 6E3E           00113                 MOVWF   TOP_VAL_CHG
000590 1A3F           00114                 XORWF   TOP_VAL_STATE,F
                      00115 
000592 1C3A           00116                 COMF    BUT_VAL_NEW,W
000594 183C           00117                 XORWF   BUT_VAL_STATE,W         ; port changed ?
000596 6E2F           00118                 MOVWF   PIOTEMP
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 44


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000598 1634           00119                 ANDWF   BUT_CT0,F               ; reset or count ct0
00059A 1E34           00120                 COMF    BUT_CT0,F
00059C 5036           00121                 MOVF    BUT_CT1,W               ; reset or count ct1
00059E 142F           00122                 ANDWF   PIOTEMP,W
0005A0 1834           00123                 XORWF   BUT_CT0,W
0005A2 6E36           00124                 MOVWF   BUT_CT1
0005A4 1434           00125                 ANDWF   BUT_CT0,W
0005A6 142F           00126                 ANDWF   PIOTEMP,W
0005A8 6E3B           00127                 MOVWF   BUT_VAL_CHG
0005AA 1A3C           00128                 XORWF   BUT_VAL_STATE,F
                      00129 
0005AC 0012           00130                 RETURN
                      00131 
0005AE                00132 GENEVENT
0005AE EC5E F002      00133                 CALL    READUID
0005B2 C044 F032      00134                 MOVFF   PIOC_H,PIOTEMP16
0005B6 C045 F033      00135                 MOVFF   PIOC_L,PIOTEMP16+1
                      00136 
0005BA C03A F031      00137                 MOVFF   BUT_VAL_NEW,ACTUAL
0005BE 0E01           00138                 MOVLW   1
0005C0 6E30           00139                 MOVWF   MASK
0005C2 C03B F02F      00140                 MOVFF   BUT_VAL_CHG,PIOTEMP
                      00141 
0005C6 D806           00142                 RCALL   GENEVENTLOOP
                      00143 
0005C8 C03D F031      00144                 MOVFF   TOP_VAL_NEW,ACTUAL
0005CC 0E01           00145                 MOVLW   1
0005CE 6E30           00146                 MOVWF   MASK
0005D0 C03E F02F      00147                 MOVFF   TOP_VAL_CHG,PIOTEMP
                      00148 
                      00149                 ; CALL  GENEVENTLOOP
                      00150 
0005D4                00151 GENEVENTLOOP
0005D4 4A33           00152                 INFSNZ  PIOTEMP16+1,F
0005D6 2A32           00153                 INCF    PIOTEMP16,F
0005D8 502F           00154                 MOVF    PIOTEMP,W
0005DA 1430           00155                 ANDWF   MASK,W
0005DC A4D8           00156                 BTFSS   STATUS,Z
0005DE D88F           00157                 RCALL   PUTEVENT
                      00158 
0005E0 90D8           00159                 BCF     STATUS,C
0005E2 3630           00160                 RLCF    MASK,F
0005E4 E3F7           00161                 BNC     GENEVENTLOOP
                      00162 
0005E6 0012           00163                 RETURN
                      00164 
                      00165 
                      00166 ;------------------------------------------------------------------------------
                      00167 ; get status
                      00168 ;------------------------------------------------------------------------------
0005E8                00169 PIOGET
                      00170                 ; RA5 is IO5
0005E8 4080           00171                 RRNCF   PORTA,W
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 45


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

0005EA 0B10           00172                 ANDLW   b'00010000'
0005EC 6E3A           00173                 MOVWF   BUT_VAL_NEW
                      00174                 ; RA0-RA3 are IO1-4
0005EE 5080           00175                 MOVF    PORTA,W
0005F0 0B0F           00176                 ANDLW   b'00001111'
0005F2 123A           00177                 IORWF   BUT_VAL_NEW,F
                      00178                 ; RE0-2 are IO6-8
0005F4 3884           00179                 SWAPF   PORTE,W
0005F6 46E8           00180                 RLNCF   WREG,F
0005F8 0BE0           00181                 ANDLW   b'11100000'
0005FA 123A           00182                 IORWF   BUT_VAL_NEW,F
                      00183 
                      00184                 ; RD0-5 are IO9-14
0005FC 5083           00185                 MOVF    PORTD,W
0005FE 0B3F           00186                 ANDLW   b'00111111'
000600 6E3D           00187                 MOVWF   TOP_VAL_NEW
                      00188                 ; RB0-1 are IO15-16
000602 4081           00189                 RRNCF   PORTB,W
000604 40E8           00190                 RRNCF   WREG,W
000606 0BC0           00191                 ANDLW   b'11000000'
000608 123D           00192                 IORWF   TOP_VAL_NEW,F
                      00193 
                      00194 #IFDEF PIOINVERT
00060A 1E3A           00195                 COMF    BUT_VAL_NEW,F
00060C 1E3D           00196                 COMF    TOP_VAL_NEW,F
                      00197 #ENDIF
                      00198 
00060E D7B4           00199                 BRA     PIODEBOUNCE
                      00200 
                      00201 ;
                      00202 ; vim: set shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00203 ;
                      00163 #INCLUDE        "pwm.inc"                   ; PWM
                      00001 ;
                      00002 ; Can-Can PWM
                      00003 ;
                      00004 ; Copyright (c) 2015 Gerhard Bertelsmann
                      00005 ;
                      00006 ;------------------------------------------------------------------------------
                      00007 ;
                      00008 ; This file is part of the Can-Can CAN bus interface project.
                      00009 ;
                      00010 ; Can-Can is licensed under the CC BY-NC-SA 4.0.
                      00011 ;
                      00012 ; See file /LICENSE for details.
                      00013 ; 
                      00014 ;------------------------------------------------------------------------------
                      00015 
                      00016                 LIST
                      00017                 RADIX   DEC
                      00018 
                      00019 ;------------------------------------------------------------------------------
                      00020 ; PWM variables
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 46


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00021 ;------------------------------------------------------------------------------
                      00022 
                      00023                 CBLOCK
  00000049            00024                 PWM_VALUE1 : 2
  0000004B            00025                 PWM_VALUE2 : 2
  0000004D            00026                 PWM_VALUE3 : 2
  0000004F            00027                 PWM_VALUE4 : 2
  00000051            00028                 PWM_CHANNEL : 1
                      00029                 ENDC
                      00030 
  00000800            00031 PWM_VALUE1_LOW    EQU     0x800
  00000801            00032 PWM_VALUE1_HIGH   EQU     0x801
  00000802            00033 PWM_VALUE2_LOW    EQU     0x802
  00000803            00034 PWM_VALUE2_HIGH   EQU     0x803
  00000804            00035 PWM_VALUE3_LOW    EQU     0x804
  00000805            00036 PWM_VALUE3_HIGH   EQU     0x805
  00000806            00037 PWM_VALUE4_LOW    EQU     0x806
  00000807            00038 PWM_VALUE5_HIGH   EQU     0x807
                      00039 
                      00040 #DEFINE         PWM_PERIOD      (40000)
                      00041 
                      00042 #DEFINE         PWM_10_HIGH     ((PWM_PERIOD * 50) / 1000)
                      00043 #DEFINE         PWM_10_LOW      (PWM_PERIOD - PWM_10_HIGH)
                      00044 
                      00045 #DEFINE         PWM_15_HIGH     ((PWM_PERIOD * 75) / 1000)
                      00046 #DEFINE         PWM_15_LOW      (PWM_PERIOD - PWM_15_HIGH)
                      00047 
                      00048 #DEFINE         PWM_20_HIGH     ((PWM_PERIOD * 100) / 1000)
                      00049 #DEFINE         PWM_20_LOW      (PWM_PERIOD - PWM_20_HIGH)
                      00050 
                      00051 ;------------------------------------------------------------------------------
                      00052 ; PWM settings
                      00053 ;------------------------------------------------------------------------------
                      00054 
000610                00055 PWMINIT
                      00056 #IF PCBV == 2
000610 9494           00057                 BCF     TRISC,2         ; CCP2 PWM1
                      00058 #ENDIF
000612 9C94           00059                 BCF     TRISC,6         ; CCP3 PWM2
000614 9E94           00060                 BCF     TRISC,7         ; CCP4 PWM3
000616 9A93           00061                 BCF     TRISB,5         ; CCP5 PWM4
                      00062 #IF PCBV ==  2
000618 848B           00063                 BSF     LATC,2          ; CCP2 PWM1
                      00064 #ENDIF
00061A 8C8B           00065                 BSF     LATC,6          ; CCP3 PWM2
00061C 8E8B           00066                 BSF     LATC,7          ; CCP4 PWM3
00061E 8A8A           00067                 BSF     LATB,5          ; CCP5 PWM4
                      00068 
                      00069 #IF PCBV ==  2
000620 94A4           00070                 BCF     PIR3,CCP2IF
                      00071 #ENDIF
000622 90B7           00072                 BCF     PIR4,CCP3IF
000624 92B7           00073                 BCF     PIR4,CCP4IF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 47


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000626 94B7           00074                 BCF     PIR4,CCP5IF
                      00075 
000628 6A51           00076                 CLRF    PWM_CHANNEL
00062A 6A49           00077                 CLRF    PWM_VALUE1
00062C 6A4A           00078                 CLRF    PWM_VALUE1+1
00062E 6A4B           00079                 CLRF    PWM_VALUE2
000630 6A4C           00080                 CLRF    PWM_VALUE2+1
000632 6A4D           00081                 CLRF    PWM_VALUE3
000634 6A4E           00082                 CLRF    PWM_VALUE3+1
000636 6A4F           00083                 CLRF    PWM_VALUE4
000638 6A50           00084                 CLRF    PWM_VALUE4+1
                      00085 
                      00086                 ; using Timer1 as Compare
00063A 6ACF           00087                 CLRF    TMR1H
00063C 6ACE           00088                 CLRF    TMR1L
                      00089 
                      00090                 ; TEST TEST
00063E 0EA0           00091                 MOVLW   LOW PWM_20_LOW
000640 6F51           00092                 MOVWF   CCPR2L
000642 6F4E           00093                 MOVWF   CCPR3L
000644 6F4B           00094                 MOVWF   CCPR4L
000646 6F48           00095                 MOVWF   CCPR5L
000648 0E8C           00096                 MOVLW   HIGH PWM_20_LOW
00064A 6F52           00097                 MOVWF   CCPR2H
00064C 6F4F           00098                 MOVWF   CCPR3H
00064E 6F4C           00099                 MOVWF   CCPR4H
000650 6F49           00100                 MOVWF   CCPR5H
                      00101 
                      00102                 ; CCP setup
                      00103 
                      00104                 ; use Timer1 for all CCPs
000652 6A99           00105                 CLRF    CCPTMRS
                      00106                 ; Compare Mode
000654 0E09           00107                 MOVLW   (1 << CCP2M3) + (1 << CCP2M0)
                      00108 #IF PCBV ==  2
000656 6F50           00109                 MOVWF   CCP2CON
                      00110 #ENDIF
000658 6F4D           00111                 MOVWF   CCP3CON
00065A 6F4A           00112                 MOVWF   CCP4CON
00065C 6F47           00113                 MOVWF   CCP5CON
                      00114 
                      00115                 ; using Fosc/4 and 1:8 prescaler
                      00116                 ; timer period = (4*8)/64MHz = 0.5 us
                      00117 
00065E 0E31           00118                 MOVLW   (1 << TMR1ON) + (1 << T1CKPS1) + (1 << T1CKPS0)
000660 6ECD           00119                 MOVWF   T1CON
                      00120 
000662 0012           00121                 RETURN
                      00122 
000664                00123 PWM_TEST
                      00124 #IF PCBV < 2
                      00125                 BRA     PWM_TEST2
                      00126 #ENDIF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 48


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000664 A4A4           00127                 BTFSS   PIR3,CCP2IF
000666 D00E           00128                 BRA     PWM_TEST2
000668 94A4           00129                 BCF     PIR3,CCP2IF
00066A B150           00130                 BTFSC   CCP2CON,CCP2M0
00066C D006           00131                 BRA     PWM1_LOAD_LOW
00066E 8150           00132                 BSF     CCP2CON,CCP2M0          ; clear bit next time
000670 0ED0           00133                 MOVLW   LOW PWM_10_HIGH
000672 2751           00134                 ADDWF   CCPR2L,F
000674 0E07           00135                 MOVLW   HIGH PWM_10_HIGH
000676 2352           00136                 ADDWFC  CCPR2H,F
000678 D005           00137                 BRA     PWM_TEST2
00067A                00138 PWM1_LOAD_LOW
00067A 9150           00139                 BCF     CCP2CON,CCP2M0          ; set bit next time
00067C 0E70           00140                 MOVLW   LOW PWM_10_LOW
00067E 2751           00141                 ADDWF   CCPR2L,F
000680 0E94           00142                 MOVLW   HIGH PWM_10_LOW
000682 2352           00143                 ADDWFC  CCPR2H,F
                      00144 
000684                00145 PWM_TEST2
000684 A0B7           00146                 BTFSS   PIR4,CCP3IF
000686 D00E           00147                 BRA     PWM_TEST3
000688 90B7           00148                 BCF     PIR4,CCP3IF
00068A B14D           00149                 BTFSC   CCP3CON,CCP3M0
00068C D006           00150                 BRA     PWM2_LOAD_LOW
00068E 814D           00151                 BSF     CCP3CON,CCP3M0          ; clear bit next time
000690 0ED0           00152                 MOVLW   LOW PWM_10_HIGH
000692 274E           00153                 ADDWF   CCPR3L,F
000694 0E07           00154                 MOVLW   HIGH PWM_10_HIGH
000696 234F           00155                 ADDWFC  CCPR3H,F
000698 D005           00156                 BRA     PWM_TEST3
00069A                00157 PWM2_LOAD_LOW
00069A 914D           00158                 BCF     CCP3CON,CCP3M0          ; set bit next time
00069C 0E70           00159                 MOVLW   LOW PWM_10_LOW
00069E 274E           00160                 ADDWF   CCPR3L,F
0006A0 0E94           00161                 MOVLW   HIGH PWM_10_LOW
0006A2 234F           00162                 ADDWFC  CCPR3H,F
                      00163 
0006A4                00164 PWM_TEST3
0006A4 A2B7           00165                 BTFSS   PIR4,CCP4IF
0006A6 D00E           00166                 BRA     PWM_TEST4
0006A8 92B7           00167                 BCF     PIR4,CCP4IF
0006AA B14A           00168                 BTFSC   CCP4CON,CCP4M0
0006AC D006           00169                 BRA     PWM3_LOAD_LOW
0006AE 814A           00170                 BSF     CCP4CON,CCP4M0          ; clear bit next time
0006B0 0EB8           00171                 MOVLW   LOW PWM_15_HIGH
0006B2 274B           00172                 ADDWF   CCPR4L,F
0006B4 0E0B           00173                 MOVLW   HIGH PWM_15_HIGH
0006B6 234C           00174                 ADDWFC  CCPR4H,F
0006B8 D005           00175                 BRA     PWM_TEST4
0006BA                00176 PWM3_LOAD_LOW
0006BA 914A           00177                 BCF     CCP4CON,CCP4M0          ; set bit next time
0006BC 0E88           00178                 MOVLW   LOW PWM_15_LOW
0006BE 274B           00179                 ADDWF   CCPR4L,F
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 49


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

0006C0 0E90           00180                 MOVLW   HIGH PWM_15_LOW
0006C2 234C           00181                 ADDWFC  CCPR4H,F
                      00182 
0006C4                00183 PWM_TEST4
0006C4 A4B7           00184                 BTFSS   PIR4,CCP5IF
0006C6 D00E           00185                 BRA     PWM_END
0006C8 94B7           00186                 BCF     PIR4,CCP5IF
0006CA B147           00187                 BTFSC   CCP5CON,CCP5M0
0006CC D006           00188                 BRA     PWM4_LOAD_LOW
0006CE 8147           00189                 BSF     CCP5CON,CCP5M0          ; clear bit next time
0006D0 0EA0           00190                 MOVLW   LOW PWM_20_HIGH
0006D2 2748           00191                 ADDWF   CCPR5L,F
0006D4 0E0F           00192                 MOVLW   HIGH PWM_20_HIGH
0006D6 2349           00193                 ADDWFC  CCPR5H,F
0006D8 D005           00194                 BRA     PWM_END
0006DA                00195 PWM4_LOAD_LOW
0006DA 9147           00196                 BCF     CCP5CON,CCP5M0          ; set bit next time
0006DC 0EA0           00197                 MOVLW   LOW PWM_20_LOW
0006DE 2748           00198                 ADDWF   CCPR5L,F
0006E0 0E8C           00199                 MOVLW   HIGH PWM_20_LOW
0006E2 2349           00200                 ADDWFC  CCPR5H,F
0006E4                00201 PWM_END
0006E4 0012           00202                 RETURN
                      00203 
                      00204 ;
                      00205 ; vim: set shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00206 ;
                      00164 #INCLUDE        "event-ring.inc"            ; Event ring
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
                      00003 ; CAN frames send ring
                      00004 ;
                      00005 ; Copyright (c) 2016 Gerhard Bertelsmann
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the CANBuster project.
                      00010 ;
                      00011 ; CANBuster is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020 ;------------------------------------------------------------------------------
                      00021 ; event ring variables
                      00022 ;------------------------------------------------------------------------------
                      00023 
                      00024                 CBLOCK
  00000052            00025                 EVENTTMP : 1            ; tmp buffer
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 50


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

  00000053            00026                 EVENTCNT : 1            ; event counter
  00000054            00027                 EVENTPP : 2             ; event pointer
  00000056            00028                 EVENTPG : 2             ; event pointer
                      00029                 ENDC
                      00030 
                      00031 ;------------------------------------------------------------------------------
                      00032 ; Event ring
                      00033 ;------------------------------------------------------------------------------
                      00034 
  00000400            00035 EVENTBUF        EQU 0x400               ; event ring
                      00036                 CBLOCK 0x400
  00000400            00037                 EVENTBUFFER : 1024
                      00038                 ENDC
                      00039 
                      00040 ;------------------------------------------------------------------------------
                      00041 ; Event ring macros
                      00042 ;------------------------------------------------------------------------------
                      00043 
0006E6                00044 INITEVENTRING
0006E6 6A53           00045                 CLRF    EVENTCNT        ; event counter
0006E8 EE04 F000      00046                 LFSR    FSR0,EVENTBUF
0006EC CFEA F054      00047                 MOVFF   FSR0H,EVENTPP
0006F0 CFEA F056      00048                 MOVFF   FSR0H,EVENTPG
0006F4 CFE9 F055      00049                 MOVFF   FSR0L,EVENTPP+1
0006F8 CFE9 F057      00050                 MOVFF   FSR0L,EVENTPG+1
0006FC 0012           00051                 RETURN
                      00052 
0006FE                00053 PUTEVENT
0006FE C054 FFEA      00054                 MOVFF   EVENTPP,FSR0H
000702 C055 FFE9      00055                 MOVFF   EVENTPP+1,FSR0L
000706 0E00           00056                 MOVLW   0x00
000708 6EEE           00057                 MOVWF   POSTINC0
                      00058                 ; mark with 0x23 as S88 event
00070A 0E23           00059                 MOVLW   0x23
00070C 6EEE           00060                 MOVWF   POSTINC0
                      00061 
00070E C041 FFEE      00062                 MOVFF   CANHASH_HIGH,POSTINC0
000712 C040 FFEE      00063                 MOVFF   CANHASH_LOW,POSTINC0
                      00064                 ; DLC
000716 0E08           00065                 MOVLW   0x8
000718 6EEE           00066                 MOVWF   POSTINC0
                      00067                 ; DATA
00071A 5042           00068                 MOVF    ID_H,W
00071C 0FAB           00069                 ADDLW   -'U'
00071E 6EEE           00070                 MOVWF   POSTINC0
000720 5043           00071                 MOVF    ID_L,W
000722 0FAD           00072                 ADDLW   -'S'
000724 6EEE           00073                 MOVWF   POSTINC0
000726 C032 FFEE      00074                 MOVFF   PIOTEMP16,POSTINC0
00072A C033 FFEE      00075                 MOVFF   PIOTEMP16+1,POSTINC0
00072E 5031           00076                 MOVF    ACTUAL,W
000730 1430           00077                 ANDWF   MASK,W
000732 A4D8           00078                 BTFSS   STATUS,Z
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 51


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000734 0E01           00079                 MOVLW   1               ; either W is zero or it's set to one
                      00080 
000736 0A01           00081                 XORLW   1
000738 6EEE           00082                 MOVWF   POSTINC0
00073A 0A01           00083                 XORLW   1
00073C 6EEE           00084                 MOVWF   POSTINC0
00073E 6AEE           00085                 CLRF    POSTINC0        ; time - unused
000740 6AEE           00086                 CLRF    POSTINC0
                      00087 
                      00088                 ;;;;;;;;;;;;;;;;;;;;;;
000742 0E0F           00089                 MOVLW   15
000744 26E9           00090                 ADDWF   FSR0L,F
000746 E301           00091                 BNC     NORM_C1
000748 2AEA           00092                 INCF    FSR0H,F
00074A                00093 NORM_C1
00074A 0EF0           00094                 MOVLW   0xF0
00074C 16E9           00095                 ANDWF   FSR0L,F
                      00096 
00074E 0E04           00097                 MOVLW   0x04            ; make sure that FSR is in the range 0x400 - 0x7ff
000750 12EA           00098                 IORWF   FSR0H,F
000752 0E07           00099                 MOVLW   0x07
000754 16EA           00100                 ANDWF   FSR0H,F
                      00101 
000756 CFEA F054      00102                 MOVFF   FSR0H,EVENTPP
00075A CFE9 F055      00103                 MOVFF   FSR0L,EVENTPP+1
                      00104 
00075E 2A53           00105                 INCF    EVENTCNT,F
000760 0012           00106                 RETURN
                      00107 
                      00108 
                      00109 GETEVENT_P_NORM MACRO
                      00110                 MOVLW   15
                      00111                 ADDWF   FSR0L,F
                      00112                 BNC     NORM_C2
                      00113                 INCF    FSR0H,F
000762                00114 NORM_C2
                      00115                 MOVLW   0xF0
                      00116                 ANDWF   FSR0L,F
                      00117 
                      00118                 MOVLW   0x04            ; make sure that FSR is in the range 0x400 - 0x7ff
                      00119                 IORWF   FSR0H,F
                      00120                 MOVLW   0x07
                      00121                 ANDWF   FSR0H,F
                      00122                 MOVFF   FSR0H,EVENTPG
                      00123                 MOVFF   FSR0L,EVENTPG+1
                      00124 
                      00125                 RETURN
                      00126                 ENDM
                      00127 
                      00128 GETEVENT_P      MACRO
                      00129                 MOVFF   EVENTPG,FSR0H
                      00130                 MOVFF   EVENTPG+1,FSR0L
                      00131                 ENDM
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 52


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00132 
000762                00133 SENDEVENT
                      00134                 ; check if an event is in the buffer
000762 5253           00135                 MOVF    EVENTCNT,F
000764 B4D8           00136                 BTFSC   STATUS,Z
000766 0012           00137                 RETURN
                      00138                 ; check if UART send buffer is available
000768 0E04           00139                 MOVLW   OVERFLOW - 5    ; 5 buffers spare for CAN -> UART
00076A 5C0A           00140                 SUBWF   TXCNT,W 
00076C B0D8           00141                 BTFSC   STATUS,C
00076E 0012           00142                 RETURN
                      00143 
                      00144                 ; last: check for CAN buffer
                      00145                 ; Find a Tx slot - start with TX buffer 2 down to 1
000770 0E04           00146                 MOVLW   CAN_WIN_TXB2        ; Window mode on TXB2
000772 6E6F           00147                 MOVWF   CANCON
000774 A700           00148                 BTFSS   TXB2CON,TXREQ
000776 D005           00149                 BRA     EVENTTXCAN
                      00150 
000778 0E06           00151                 MOVLW   CAN_WIN_TXB1        ; Window mode on TXB1
00077A 6E6F           00152                 MOVWF   CANCON
00077C A710           00153                 BTFSS   TXB1CON,TXREQ
00077E D001           00154                 BRA     EVENTTXCAN
                      00155 
000780 0012           00156                 RETURN
                      00157 
000782                00158 EVENTTXCAN
                      00159                 GETEVENT_P
000782 C056 FFEA          M                 MOVFF   EVENTPG,FSR0H
000786 C057 FFE9          M                 MOVFF   EVENTPG+1,FSR0L
00078A 50EE           00160                 MOVF    POSTINC0,W
                      00161                 TXEXT_28_24
00078C 0B1F               M                 ANDLW   b'00011111'
00078E 3AE8               M                 SWAPF   WREG,F
000790 42E8               M                 RRNCF   WREG,F
000792 6E61               M                 MOVWF   RXB0SIDH
000794 50EF           00162                 MOVF    INDF0,W
                      00163                 TXEXT_23_21
000796 0BE0               M                 ANDLW   b'11100000'
000798 3AE8               M                 SWAPF   WREG,F
00079A 42E8               M                 RRNCF   WREG,F
00079C 1261               M                 IORWF   RXB0SIDH,F
00079E 50EF           00164                 MOVF    INDF0,W
                      00165                 TXEXT_20_18
0007A0 0B1C               M                 ANDLW   b'00011100'
0007A2 3AE8               M                 SWAPF   WREG,F
0007A4 42E8               M                 RRNCF   WREG,F
0007A6 6E62               M                 MOVWF   RXB0SIDL
0007A8 50EE           00166                 MOVF    POSTINC0,W
                      00167                 TXEXT_17_16
0007AA 0B03               M                 ANDLW   b'00000011'
0007AC 1262               M                 IORWF   RXB0SIDL,F
0007AE 8662           00168                 BSF     RXB0SIDL,EXIDEN     ; Enable Extended Id
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 53


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

0007B0 CFEE FF63      00169                 MOVFF   POSTINC0,RXB0EIDH
0007B4 CFEE FF64      00170                 MOVFF   POSTINC0,RXB0EIDL
                      00171                 ; DLC
0007B8 CFEE FF65      00172                 MOVFF   POSTINC0,RXB0DLC
                      00173                 ; DATA
0007BC CFEE FF66      00174                 MOVFF   POSTINC0,RXB0D0
0007C0 CFEE FF67      00175                 MOVFF   POSTINC0,RXB0D1
0007C4 CFEE FF68      00176                 MOVFF   POSTINC0,RXB0D2
0007C8 CFEE FF69      00177                 MOVFF   POSTINC0,RXB0D3
0007CC CFEE FF6A      00178                 MOVFF   POSTINC0,RXB0D4
0007D0 CFEE FF6B      00179                 MOVFF   POSTINC0,RXB0D5
0007D4 CFEE FF6C      00180                 MOVFF   POSTINC0,RXB0D6
0007D8 CFEE FF6D      00181                 MOVFF   POSTINC0,RXB0D7
                      00182 
                      00183                 ; test
                      00184                 ; MOVFF FSR0H,RXB0D5
                      00185                 ; MOVFF FSR0L,RXB0D6
                      00186                 ; MOVFF EVENTCNT,RXB0D7
                      00187 
0007DC 8660           00188                 BSF     RXB0CON,TXREQ       ; start CAN transmit
                      00189 
                      00190                 ; and now the SLCAN packet
                      00191                 GETEVENT_P
0007DE C056 FFEA          M                 MOVFF   EVENTPG,FSR0H
0007E2 C057 FFE9          M                 MOVFF   EVENTPG+1,FSR0L
0007E6 0E54           00192                 MOVLW   'T'
                      00193                 PUTC
0007E8 6E09               M                 MOVWF   TXTEMP
0007EA 5008               M                 MOVF    TXPUT,W
0007EC C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
0007F0 2A08               M                 INCF    TXPUT,F             ; TXPUT++
0007F2 50EE           00194                 MOVF    POSTINC0,W
0007F4 ECA5 F000      00195                 CALL    BIN2ASC
0007F8 50EE           00196                 MOVF    POSTINC0,W
0007FA ECA5 F000      00197                 CALL    BIN2ASC
0007FE 50EE           00198                 MOVF    POSTINC0,W
000800 ECA5 F000      00199                 CALL    BIN2ASC
000804 50EE           00200                 MOVF    POSTINC0,W
000806 ECA5 F000      00201                 CALL    BIN2ASC
00080A 50EE           00202                 MOVF    POSTINC0,W
00080C 0B0F           00203                 ANDLW   0x0f
00080E E107           00204                 BNZ     EVENTUARTCONT
                      00205 
000810 0E30           00206                 MOVLW   '0'
                      00207                 PUTC
000812 6E09               M                 MOVWF   TXTEMP
000814 5008               M                 MOVF    TXPUT,W
000816 C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
00081A 2A08               M                 INCF    TXPUT,F             ; TXPUT++
00081C D00D           00208                 BRA     EVENTUARTFIN
                      00209 
00081E                00210 EVENTUARTCONT
                      00211                 ; DLC
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 54


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

00081E 6E52           00212                 MOVWF   EVENTTMP
000820 0F30           00213                 ADDLW   0x30
                      00214                 PUTC
000822 6E09               M                 MOVWF   TXTEMP
000824 5008               M                 MOVF    TXPUT,W
000826 C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
00082A 2A08               M                 INCF    TXPUT,F             ; TXPUT++
00082C                00215 EVENTUARTLOOP
00082C CFEE FFE8      00216                 MOVFF   POSTINC0,WREG
000830 ECA5 F000      00217                 CALL    BIN2ASC
000834 2E52           00218                 DECFSZ  EVENTTMP,F
000836 D7FA           00219                 BRA     EVENTUARTLOOP
                      00220 
000838                00221 EVENTUARTFIN
000838 0E0D           00222                 MOVLW   EOLNCHAR
                      00223                 PUTC
00083A 6E09               M                 MOVWF   TXTEMP
00083C 5008               M                 MOVF    TXPUT,W
00083E C009 FFDB          M                 MOVFF   TXTEMP,PLUSW2
000842 2A08               M                 INCF    TXPUT,F             ; TXPUT++
                      00224 
000844 2A0A           00225                 INCF    TXCNT,F
000846 88A3           00226                 BSF     UPIE,UTXIE              ; enable Tx ring ISR
                      00227 
                      00228                 ; one event done
000848 0653           00229                 DECF    EVENTCNT,F
                      00230                 ; fix the pointer if necessary
                      00231                 GETEVENT_P_NORM
00084A 0E0F               M                 MOVLW   15
00084C 26E9               M                 ADDWF   FSR0L,F
00084E E301               M                 BNC     NORM_C2
000850 2AEA               M                 INCF    FSR0H,F
000852                    M NORM_C2
000852 0EF0               M                 MOVLW   0xF0
000854 16E9               M                 ANDWF   FSR0L,F
                          M 
000856 0E04               M                 MOVLW   0x04            ; make sure that FSR is in the range 0x400 - 0x7ff
000858 12EA               M                 IORWF   FSR0H,F
00085A 0E07               M                 MOVLW   0x07
00085C 16EA               M                 ANDWF   FSR0H,F
00085E CFEA F056          M                 MOVFF   FSR0H,EVENTPG
000862 CFE9 F057          M                 MOVFF   FSR0L,EVENTPG+1
                          M 
000866 0012               M                 RETURN
000868 0012           00232                 RETURN
                      00233 
                      00234 ;------------------------------------------------------------------------------
                      00235 ;
                      00236 ; vim: set shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00237 ;
                      00165 #INCLUDE        "can-inspect.inc"           ; CAN Inspector
                      00001 ;------------------------------------------------------------------------------
                      00002 ;
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 55


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00003 ; CANBuster CAN inspect
                      00004 ;
                      00005 ; Copyright (c) 2016 Gerhard Bertelsmann
                      00006 ;
                      00007 ;------------------------------------------------------------------------------
                      00008 ;
                      00009 ; This file is part of the CANBuster project.
                      00010 ;
                      00011 ; CANBuster is licensed under the CC BY-NC-SA 4.0.
                      00012 ;
                      00013 ; See file /LICENSE for details.
                      00014 ; 
                      00015 ;------------------------------------------------------------------------------
                      00016 
                      00017                 LIST
                      00018                 RADIX   DEC
                      00019 
                      00020                 CBLOCK
  00000800            00021                 TEMP16: 2
                      00022                 ENDC
                      00023 
                      00024 ;------------------------------------------------------------------------------
                      00025 ; inspector
                      00026 ;------------------------------------------------------------------------------
                      00027 
00086A                00028 CANINSPECT
00086A AC0F           00029                 BTFSS   CANFRAME,6      ; a new CAN frame ?
00086C 0012           00030                 RETURN
                      00031 
00086E 9C0F           00032                 BCF     CANFRAME,6      ; mark as processed
                      00033 
                      00034                 ; we are looking only for extended frames here
000870 AE0F           00035                 BTFSS   CANFRAME,7      ; extended CAN frame ?
000872 0012           00036                 RETURN
                      00037 
                      00038                 ; System CMD 0x00 ?
000874 5210           00039                 MOVF    CANFRAME+1,F
000876 B4D8           00040                 BTFSC   STATUS,Z
000878 D028           00041                 BRA     SYSYTEM_CMD
                      00042 
                      00043                 ; Switch Accessoir  0x1B (Zubehoer schalten)?
00087A 5010           00044                 MOVF    CANFRAME+1,W
00087C 0A16           00045                 XORLW   0x16
00087E B4D8           00046                 BTFSC   STATUS,Z
000880 D08A           00047                 BRA     CAN_SWITCH_ACC
                      00048 
                      00049                 ; CAN PING 0x30 ?
000882 5010           00050                 MOVF    CANFRAME+1,W
000884 0A30           00051                 XORLW   0x30
000886 B4D8           00052                 BTFSC   STATUS,Z
000888 D0B6           00053                 BRA     CAN_PING
                      00054 
00088A 0012           00055                 RETURN
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 56


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00056 
                      00057 ;------------------------------------------------------------------------------
                      00058 ; generic routines
                      00059 ;------------------------------------------------------------------------------
                      00060 
00088C                00061 CHECK_ID
00088C 5014           00062                 MOVF    CANFRAME+5,W
00088E 0A43           00063                 XORLW   'C'
000890 A4D8           00064                 BTFSS   STATUS,Z
000892 0012           00065                 RETURN
000894 5015           00066                 MOVF    CANFRAME+6,W
000896 0A42           00067                 XORLW   'B'
000898 A4D8           00068                 BTFSS   STATUS,Z
00089A 0012           00069                 RETURN
00089C 5016           00070                 MOVF    CANFRAME+7,W
00089E 1842           00071                 XORWF   ID_H,W
0008A0 A4D8           00072                 BTFSS   STATUS,Z
0008A2 0012           00073                 RETURN
0008A4 5017           00074                 MOVF    CANFRAME+8,W
0008A6 1843           00075                 XORWF   ID_L,W
                      00076                 ; return now anyway
0008A8 0012           00077                 RETURN
                      00078 
                      00079 ;------------------------------------------------------------------------------
                      00080 ; be sure the pointer is in the appropiate range
                      00081 ;------------------------------------------------------------------------------
                      00082 
0008AA                00083 EVENT_RING_NORMALIZE
0008AA 0E0F           00084                 MOVLW   15
0008AC 26E9           00085                 ADDWF   FSR0L,F
0008AE E301           00086                 BNC     NORM_POINTER1
0008B0 2AEA           00087                 INCF    FSR0H,F
0008B2                00088 NORM_POINTER1
0008B2 0EF0           00089                 MOVLW   0xF0
0008B4 16E9           00090                 ANDWF   FSR0L,F
                      00091 
0008B6 0E04           00092                 MOVLW   0x04            ; make sure that FSR is in the range 0x400 - 0x7ff
0008B8 12EA           00093                 IORWF   FSR0H,F
0008BA 0E07           00094                 MOVLW   0x07
0008BC 16EA           00095                 ANDWF   FSR0H,F
0008BE CFEA F054      00096                 MOVFF   FSR0H,EVENTPP
0008C2 CFE9 F055      00097                 MOVFF   FSR0L,EVENTPP+1
                      00098 
0008C6 2A53           00099                 INCF    EVENTCNT,F
0008C8 0012           00100                 RETURN
                      00101 
                      00102 ;------------------------------------------------------------------------------
                      00103 ; answer System Command (0x00)
                      00104 ;------------------------------------------------------------------------------
                      00105 
0008CA                00106 SYSYTEM_CMD
0008CA DFE0           00107                 RCALL   CHECK_ID
0008CC E10C           00108                 BNZ     SYSYTEM_CMD_OTHER
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 57


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00109                 ; Configuration DLC = 8 & Suc Command 0x0b
                      00110                 ; DLC = 8
0008CE 5013           00111                 MOVF    CANFRAME+4,W
0008D0 0A08           00112                 XORLW   8
0008D2 E103           00113                 BNZ     SYSYTEM_CMD_NEXT1
0008D4 5018           00114                 MOVF    CANFRAME+9,W
0008D6 0A0B           00115                 XORLW   0x0B
0008D8 E01C           00116                 BZ      SETUP_VALUE
0008DA                00117 SYSYTEM_CMD_NEXT1
                      00118                 ; Reboot ?
                      00119                 ; DLC = 6
0008DA 5013           00120                 MOVF    CANFRAME+4,W
0008DC 0A06           00121                 XORLW   6
0008DE E1FD           00122                 BNZ     SYSYTEM_CMD_NEXT1
0008E0 5018           00123                 MOVF    CANFRAME+9,W
0008E2 0A80           00124                 XORLW   0x80
0008E4 E056           00125                 BZ      CAN_REBOOT
                      00126 
                      00127                 ; for testing
0008E6                00128 SYSYTEM_CMD_OTHER
0008E6 C054 FFEA      00129                 MOVFF   EVENTPP,FSR0H
0008EA C055 FFE9      00130                 MOVFF   EVENTPP+1,FSR0L
                      00131                 ; mark with 0x01 as System CMD Response
0008EE 0E00           00132                 MOVLW   0x00
0008F0 6EEE           00133                 MOVWF   POSTINC0
0008F2 0E01           00134                 MOVLW   0x01
0008F4 6EEE           00135                 MOVWF   POSTINC0
0008F6 C041 FFEE      00136                 MOVFF   CANHASH_HIGH,POSTINC0
0008FA C040 FFEE      00137                 MOVFF   CANHASH_LOW,POSTINC0
0008FE 5013           00138                 MOVF    CANFRAME+4,W
000900 6EEE           00139                 MOVWF   POSTINC0
000902 0E00           00140                 MOVLW   0
000904 6EEE           00141                 MOVWF   POSTINC0
000906 6EEE           00142                 MOVWF   POSTINC0
000908 6EEE           00143                 MOVWF   POSTINC0
00090A 6EEE           00144                 MOVWF   POSTINC0
00090C 6EEE           00145                 MOVWF   POSTINC0
00090E 6EEE           00146                 MOVWF   POSTINC0
000910 D7CC           00147                 BRA     EVENT_RING_NORMALIZE
                      00148 
                      00149 ;------------------------------------------------------------------------------
                      00150 ; System Sub CMD Reset 0x0B -> save value
                      00151 ;------------------------------------------------------------------------------
                      00152 
000912                00153 SETUP_VALUE
                      00154                 ; setup ID request ?
000912 0E00           00155                 MOVLW   0x00
000914 1819           00156                 XORWF   CANFRAME+10,W
000916 E105           00157                 BNZ     SETUP_VALUE_CONT1
000918 C01A F042      00158                 MOVFF   CANFRAME+11,ID_H
00091C C01B F043      00159                 MOVFF   CANFRAME+12,ID_L
000920 D017           00160                 BRA     SETUP_VALUE_WRITE
000922                00161 SETUP_VALUE_CONT1
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 58


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000922 0E01           00162                 MOVLW   0x01
000924 1819           00163                 XORWF   CANFRAME+10,W
000926 E105           00164                 BNZ     SETUP_VALUE_CONT2
000928 C01A F044      00165                 MOVFF   CANFRAME+11,PIOC_H
00092C C01B F045      00166                 MOVFF   CANFRAME+12,PIOC_L
000930 D00F           00167                 BRA     SETUP_VALUE_WRITE
000932                00168 SETUP_VALUE_CONT2
000932 0E02           00169                 MOVLW   0x02
000934 1819           00170                 XORWF   CANFRAME+10,W
000936 E105           00171                 BNZ     SETUP_VALUE_CONT3
000938 C01A F046      00172                 MOVFF   CANFRAME+11,S88C_H
00093C C01B F047      00173                 MOVFF   CANFRAME+12,S88C_L
000940 D007           00174                 BRA     SETUP_VALUE_WRITE
000942                00175 SETUP_VALUE_CONT3
000942 0E03           00176                 MOVLW   0x03
000944 1819           00177                 XORWF   CANFRAME+10,W
000946 E103           00178                 BNZ     SETUP_VALUE_CONT4
000948 C01B F048      00179                 MOVFF   CANFRAME+12,SCAN_INTERVAL
00094C D001           00180                 BRA     SETUP_VALUE_WRITE
                      00181 
00094E                00182 SETUP_VALUE_CONT4
                      00183                 ; exit
00094E 0012           00184                 RETURN
                      00185 
000950                00186 SETUP_VALUE_WRITE
000950 EC76 F002      00187                 CALL    SETUID
000954 EC92 F002      00188                 CALL    READCANHASH
                      00189 
000958                00190 SETUP_VALUE_TEST
000958 C054 FFEA      00191                 MOVFF   EVENTPP,FSR0H
00095C C055 FFE9      00192                 MOVFF   EVENTPP+1,FSR0L
000960 6AEE           00193                 CLRF    POSTINC0
000962 0E01           00194                 MOVLW   0x01
000964 6EEE           00195                 MOVWF   POSTINC0
000966 C041 FFEE      00196                 MOVFF   CANHASH_HIGH,POSTINC0
00096A C040 FFEE      00197                 MOVFF   CANHASH_LOW,POSTINC0
00096E 0E07           00198                 MOVLW   7
000970 6EEE           00199                 MOVWF   POSTINC0
000972 C014 FFEE      00200                 MOVFF   CANFRAME+5,POSTINC0
000976 C015 FFEE      00201                 MOVFF   CANFRAME+6,POSTINC0
00097A C016 FFEE      00202                 MOVFF   CANFRAME+7,POSTINC0
00097E C017 FFEE      00203                 MOVFF   CANFRAME+8,POSTINC0
000982 C018 FFEE      00204                 MOVFF   CANFRAME+9,POSTINC0
000986 C019 FFEE      00205                 MOVFF   CANFRAME+10,POSTINC0
                      00206                 ; 1 -> success
00098A 0E01           00207                 MOVLW   1
00098C 6EEE           00208                 MOVWF   POSTINC0
00098E D78D           00209                 BRA     EVENT_RING_NORMALIZE
                      00210 
000990 0012           00211                 RETURN
                      00212 
                      00213 ;------------------------------------------------------------------------------
                      00214 ; System Sub CMD Reset 0x80 -> reboot - e.g. for updates
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 59


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

                      00215 ;------------------------------------------------------------------------------
                      00216 
000992                00217 CAN_REBOOT
000992 EF00 F000      00218                 GOTO    0
                      00219 
                      00220 ;
                      00221 ;   803                           ;main.c: 160: test = 40000 - pulse;
                      00222 ;   804  005B  0970                      comf    _pulse,w        ;volatile
                      00223 ;   805  005C  00FA                      movwf   ??_main
                      00224 ;   806  005D  0971                      comf    _pulse+1,w      ;volatile
                      00225 ;   807  005E  00FB                      movwf   ??_main+1
                      00226 ;   808  005F  0AFA                      incf    ??_main,f
                      00227 ;   809  0060  1903                      skipnz
                      00228 ;   810  0061  0AFB                      incf    ??_main+1,f
                      00229 ;   811  0062  087A                      movf    ??_main,w
                      00230 ;   812  0063  3E40                      addlw   64
                      00231 ;   813  0064  00F6                      movwf   _test   ;volatile
                      00232 ;   814  0065  309C                      movlw   156
                      00233 ;   815  0066  3D7B                      addwfc  ??_main+1,w
                      00234 ;   816  0067  00F7                      movwf   _test+1 ;volatile
                      00235 
                      00236 ;------------------------------------------------------------------------------
                      00237 ; Switch Accessois (0x1B)
                      00238 ;------------------------------------------------------------------------------
                      00239 
                      00240 ; TODO
                      00241 
                      00242 #DEFINE PWMMAX (40000)
                      00243 
                      00244 LOAD_PWMMAX     MACRO
                      00245                 MOVLW   HIGH PWMMAX
                      00246                 MOVWF   TEMP16
                      00247                 MOVLW   LOW PWMMAX
                      00248                 MOVWF   TEMP16+1
                      00249                 ENDM
                      00250 
000996                00251 CAN_SWITCH_ACC
                      00252                 ; if DLC != 8 -> return
000996 5013           00253                 MOVF    CANFRAME+4,W
000998 0A08           00254                 XORLW   8
00099A E001           00255                 BZ      CAN_SWITCH_ACC_NEXT1
00099C 0012           00256                 RETURN
                      00257 
00099E                00258 CAN_SWITCH_ACC_NEXT1
00099E DF76           00259                 RCALL   CHECK_ID
0009A0 A4D8           00260                 BTFSS   STATUS,Z
0009A2 0012           00261                 RETURN
                      00262 
                      00263                 ; MOVFF   CANFRAME+10,W
                      00264                 ; ANDLW   3
                      00265 
0009A4 C054 FFEA      00266                 MOVFF   EVENTPP,FSR0H
0009A8 C055 FFE9      00267                 MOVFF   EVENTPP+1,FSR0L
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 60


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

0009AC 6AEE           00268                 CLRF    POSTINC0
0009AE 0E17           00269                 MOVLW   0x17
0009B0 6EEE           00270                 MOVWF   POSTINC0
0009B2 C041 FFEE      00271                 MOVFF   CANHASH_HIGH,POSTINC0
0009B6 C040 FFEE      00272                 MOVFF   CANHASH_LOW,POSTINC0
0009BA 0E07           00273                 MOVLW   7
0009BC 6EEE           00274                 MOVWF   POSTINC0
                      00275                 ; org
                      00276 
0009BE 0E9C           00277                 MOVLW   HIGH PWMMAX
0009C0 CFE8 F800      00278                 MOVFF   WREG,TEMP16
0009C4 0E40           00279                 MOVLW   LOW PWMMAX
0009C6 CFE8 F801      00280                 MOVFF   WREG,TEMP16+1
                      00281 
0009CA C800 FFEE      00282                 MOVFF   TEMP16,POSTINC0
0009CE C801 FFEE      00283                 MOVFF   TEMP16+1,POSTINC0
                      00284 
0009D2 C01A FFEE      00285                 MOVFF   CANFRAME+11,POSTINC0
0009D6 C01B FFEE      00286                 MOVFF   CANFRAME+12,POSTINC0
                      00287 
0009DA 5101           00288                 MOVF    TEMP16+1,W
0009DC 5E1B           00289                 SUBWF   CANFRAME+12,F
0009DE 5100           00290                 MOVF    TEMP16,W
0009E0 A0D8           00291                 BTFSS   STATUS,C
0009E2 3F01           00292                 INCFSZ  TEMP16+1
0009E4 5E1A           00293                 SUBWF   CANFRAME+11,F
                      00294 
                      00295                 ; 40000 - x
0009E6 C01A FFEE      00296                 MOVFF   CANFRAME+11,POSTINC0
0009EA C01B FFEE      00297                 MOVFF   CANFRAME+12,POSTINC0
                      00298 
                      00299                 ; 01 -> success
0009EE 0E01           00300                 MOVLW   0x01
0009F0 6EEE           00301                 MOVWF   POSTINC0
0009F2 D75B           00302                 BRA     EVENT_RING_NORMALIZE
                      00303 
0009F4                00304 CAN_SWITCH_ACC_FAULT
0009F4 0012           00305                 RETURN
                      00306 ;------------------------------------------------------------------------------
                      00307 ; answer CAN Ping (0x30)
                      00308 ;------------------------------------------------------------------------------
                      00309 
0009F6                00310 CAN_PING
                      00311                 ; if DLC != 0 -> return
0009F6 5213           00312                 MOVF    CANFRAME+4,F
0009F8 E001           00313                 BZ      CAN_PING_CONT
0009FA 0012           00314                 RETURN
                      00315 
0009FC                00316 CAN_PING_CONT
0009FC C054 FFEA      00317                 MOVFF   EVENTPP,FSR0H
000A00 C055 FFE9      00318                 MOVFF   EVENTPP+1,FSR0L
                      00319                 ; mark with 0x31 as CAN Ping response
000A04 6AEE           00320                 CLRF    POSTINC0
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 61


LOC    OBJECT CODE    LINE  SOURCE TEXT
  VALUE

000A06 0E31           00321                 MOVLW   0x31
000A08 6EEE           00322                 MOVWF   POSTINC0
000A0A C041 FFEE      00323                 MOVFF   CANHASH_HIGH,POSTINC0
000A0E C040 FFEE      00324                 MOVFF   CANHASH_LOW,POSTINC0
000A12 0E08           00325                 MOVLW   0x8
000A14 6EEE           00326                 MOVWF   POSTINC0
000A16 0E43           00327                 MOVLW   'C'
000A18 6EEE           00328                 MOVWF   POSTINC0
000A1A 0E42           00329                 MOVLW   'B'
000A1C 6EEE           00330                 MOVWF   POSTINC0
000A1E C042 FFEE      00331                 MOVFF   ID_H,POSTINC0
000A22 C043 FFEE      00332                 MOVFF   ID_L,POSTINC0
000A26 0E01           00333                 MOVLW   1
000A28 6EEE           00334                 MOVWF   POSTINC0
000A2A 0E00           00335                 MOVLW   0
000A2C 6EEE           00336                 MOVWF   POSTINC0
000A2E 6EEE           00337                 MOVWF   POSTINC0
                      00338                 ; this is a back detector (german Rueckmelder)
000A30 0E40           00339                 MOVLW   0x40
000A32 6EEE           00340                 MOVWF   POSTINC0
000A34 D73A           00341                 BRA     EVENT_RING_NORMALIZE
                      00342 
                      00343 ;------------------------------------------------------------------------------
                      00344 ; Setup Command (0x3A)
                      00345 ;------------------------------------------------------------------------------
                      00346 
                      00347 ;
                      00348 ; vim: set shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00349 ;
                      00166 
                      00167 ;------------------------------------------------------------------------------
                      00168 ;
                      00169 ; vim: shiftwidth=4 tabstop=4 softtabstop=4 expandtab
                      00170 ;
                      00077 
                      00078 ;------------------------------------------------------------------------------
000A36                00079 THE
                      00080                 END
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 62


SYMBOL TABLE
  LABEL                             VALUE

A                                 00000000
ABAT                              00000004
ABDEN                             00000000
ABDOVF                            00000007
ACCESS                            00000000
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ACTUAL                            00000031
ADCMD                             00000005
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADDEN                             00000003
ADDEN1                            00000003
ADDEN2                            00000003
ADEN                              00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADMSK1                            00000001
ADMSK2                            00000002
ADMSK3                            00000003
ADMSK4                            00000004
ADMSK5                            00000005
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
ANCON0                            00000F5D
ANCON1                            00000F5C
ANSEL0                            00000000
ANSEL1                            00000001
ANSEL10                           00000002
ANSEL11                           00000003
ANSEL12                           00000004
ANSEL13                           00000005
ANSEL14                           00000006
ANSEL2                            00000002
ANSEL3                            00000003
ANSEL4                            00000004
ANSEL5                            00000005
ANSEL6                            00000006
ANSEL7                            00000007
ANSEL8                            00000000
ANSEL9                            00000001
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 63


SYMBOL TABLE
  LABEL                             VALUE 

ASC2BIN                           0000012C
ASC2NIB                           00000138
ASCTEMP                           0000000B
B0CON                             00000E80
B0D0                              00000E86
B0D00                             00000000
B0D01                             00000001
B0D02                             00000002
B0D03                             00000003
B0D04                             00000004
B0D05                             00000005
B0D06                             00000006
B0D07                             00000007
B0D1                              00000E87
B0D10                             00000000
B0D11                             00000001
B0D12                             00000002
B0D13                             00000003
B0D14                             00000004
B0D15                             00000005
B0D16                             00000006
B0D17                             00000007
B0D2                              00000E88
B0D20                             00000000
B0D21                             00000001
B0D22                             00000002
B0D23                             00000003
B0D24                             00000004
B0D25                             00000005
B0D26                             00000006
B0D27                             00000007
B0D3                              00000E89
B0D30                             00000000
B0D31                             00000001
B0D32                             00000002
B0D33                             00000003
B0D34                             00000004
B0D35                             00000005
B0D36                             00000006
B0D37                             00000007
B0D4                              00000E8A
B0D40                             00000000
B0D41                             00000001
B0D42                             00000002
B0D43                             00000003
B0D44                             00000004
B0D45                             00000005
B0D46                             00000006
B0D47                             00000007
B0D5                              00000E8B
B0D50                             00000000
B0D51                             00000001
B0D52                             00000002
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 64


SYMBOL TABLE
  LABEL                             VALUE 

B0D53                             00000003
B0D54                             00000004
B0D55                             00000005
B0D56                             00000006
B0D57                             00000007
B0D6                              00000E8C
B0D60                             00000000
B0D61                             00000001
B0D62                             00000002
B0D63                             00000003
B0D64                             00000004
B0D65                             00000005
B0D66                             00000006
B0D67                             00000007
B0D7                              00000E8D
B0D70                             00000000
B0D71                             00000001
B0D72                             00000002
B0D73                             00000003
B0D74                             00000004
B0D75                             00000005
B0D76                             00000006
B0D77                             00000007
B0DLC                             00000E85
B0EIDH                            00000E83
B0EIDL                            00000E84
B0IE                              00000002
B0SIDH                            00000E81
B0SIDL                            00000E82
B0TXEN                            00000002
B1CON                             00000E90
B1D0                              00000E96
B1D00                             00000000
B1D01                             00000001
B1D02                             00000002
B1D03                             00000003
B1D04                             00000004
B1D05                             00000005
B1D06                             00000006
B1D07                             00000007
B1D1                              00000E97
B1D10                             00000000
B1D11                             00000001
B1D12                             00000002
B1D13                             00000003
B1D14                             00000004
B1D15                             00000005
B1D16                             00000006
B1D17                             00000007
B1D2                              00000E98
B1D20                             00000000
B1D21                             00000001
B1D22                             00000002
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 65


SYMBOL TABLE
  LABEL                             VALUE 

B1D23                             00000003
B1D24                             00000004
B1D25                             00000005
B1D26                             00000006
B1D27                             00000007
B1D3                              00000E99
B1D30                             00000000
B1D31                             00000001
B1D32                             00000002
B1D33                             00000003
B1D34                             00000004
B1D35                             00000005
B1D36                             00000006
B1D37                             00000007
B1D4                              00000E9A
B1D40                             00000000
B1D41                             00000001
B1D42                             00000002
B1D43                             00000003
B1D44                             00000004
B1D45                             00000005
B1D46                             00000006
B1D47                             00000007
B1D5                              00000E9B
B1D50                             00000000
B1D51                             00000001
B1D52                             00000002
B1D53                             00000003
B1D54                             00000004
B1D55                             00000005
B1D56                             00000006
B1D57                             00000007
B1D6                              00000E9C
B1D60                             00000000
B1D61                             00000001
B1D62                             00000002
B1D63                             00000003
B1D64                             00000004
B1D65                             00000005
B1D66                             00000006
B1D67                             00000007
B1D7                              00000E9D
B1D70                             00000000
B1D71                             00000001
B1D72                             00000002
B1D73                             00000003
B1D74                             00000004
B1D75                             00000005
B1D76                             00000006
B1D77                             00000007
B1DLC                             00000E95
B1EIDH                            00000E93
B1EIDL                            00000E94
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 66


SYMBOL TABLE
  LABEL                             VALUE 

B1IE                              00000003
B1SIDH                            00000E91
B1SIDL                            00000E92
B1TXEN                            00000003
B2CON                             00000EA0
B2D0                              00000EA6
B2D00                             00000000
B2D01                             00000001
B2D02                             00000002
B2D03                             00000003
B2D04                             00000004
B2D05                             00000005
B2D06                             00000006
B2D07                             00000007
B2D1                              00000EA7
B2D10                             00000000
B2D11                             00000001
B2D12                             00000002
B2D13                             00000003
B2D14                             00000004
B2D15                             00000005
B2D16                             00000006
B2D17                             00000007
B2D2                              00000EA8
B2D20                             00000000
B2D21                             00000001
B2D22                             00000002
B2D23                             00000003
B2D24                             00000004
B2D25                             00000005
B2D26                             00000006
B2D27                             00000007
B2D3                              00000EA9
B2D30                             00000000
B2D31                             00000001
B2D32                             00000002
B2D33                             00000003
B2D34                             00000004
B2D35                             00000005
B2D36                             00000006
B2D37                             00000007
B2D4                              00000EAA
B2D40                             00000000
B2D41                             00000001
B2D42                             00000002
B2D43                             00000003
B2D44                             00000004
B2D45                             00000005
B2D46                             00000006
B2D47                             00000007
B2D5                              00000EAB
B2D50                             00000000
B2D51                             00000001
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 67


SYMBOL TABLE
  LABEL                             VALUE 

B2D52                             00000002
B2D53                             00000003
B2D54                             00000004
B2D55                             00000005
B2D56                             00000006
B2D57                             00000007
B2D6                              00000EAC
B2D60                             00000000
B2D61                             00000001
B2D62                             00000002
B2D63                             00000003
B2D64                             00000004
B2D65                             00000005
B2D66                             00000006
B2D67                             00000007
B2D7                              00000EAD
B2D70                             00000000
B2D71                             00000001
B2D72                             00000002
B2D73                             00000003
B2D74                             00000004
B2D75                             00000005
B2D76                             00000006
B2D77                             00000007
B2DLC                             00000EA5
B2EIDH                            00000EA3
B2EIDL                            00000EA4
B2IE                              00000004
B2SIDH                            00000EA1
B2SIDL                            00000EA2
B2TXEN                            00000004
B3CON                             00000EB0
B3D0                              00000EB6
B3D00                             00000000
B3D01                             00000001
B3D02                             00000002
B3D03                             00000003
B3D04                             00000004
B3D05                             00000005
B3D06                             00000006
B3D07                             00000007
B3D1                              00000EB7
B3D10                             00000000
B3D11                             00000001
B3D12                             00000002
B3D13                             00000003
B3D14                             00000004
B3D15                             00000005
B3D16                             00000006
B3D17                             00000007
B3D2                              00000EB8
B3D20                             00000000
B3D21                             00000001
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 68


SYMBOL TABLE
  LABEL                             VALUE 

B3D22                             00000002
B3D23                             00000003
B3D24                             00000004
B3D25                             00000005
B3D26                             00000006
B3D27                             00000007
B3D3                              00000EB9
B3D30                             00000000
B3D31                             00000001
B3D32                             00000002
B3D33                             00000003
B3D34                             00000004
B3D35                             00000005
B3D36                             00000006
B3D37                             00000007
B3D4                              00000EBA
B3D40                             00000000
B3D41                             00000001
B3D42                             00000002
B3D43                             00000003
B3D44                             00000004
B3D45                             00000005
B3D46                             00000006
B3D47                             00000007
B3D5                              00000EBB
B3D50                             00000000
B3D51                             00000001
B3D52                             00000002
B3D53                             00000003
B3D54                             00000004
B3D55                             00000005
B3D56                             00000006
B3D57                             00000007
B3D6                              00000EBC
B3D60                             00000000
B3D61                             00000001
B3D62                             00000002
B3D63                             00000003
B3D64                             00000004
B3D65                             00000005
B3D66                             00000006
B3D67                             00000007
B3D7                              00000EBD
B3D70                             00000000
B3D71                             00000001
B3D72                             00000002
B3D73                             00000003
B3D74                             00000004
B3D75                             00000005
B3D76                             00000006
B3D77                             00000007
B3DLC                             00000EB5
B3EIDH                            00000EB3
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 69


SYMBOL TABLE
  LABEL                             VALUE 

B3EIDL                            00000EB4
B3IE                              00000005
B3SIDH                            00000EB1
B3SIDL                            00000EB2
B3TXEN                            00000005
B4CON                             00000EC0
B4D0                              00000EC6
B4D00                             00000000
B4D01                             00000001
B4D02                             00000002
B4D03                             00000003
B4D04                             00000004
B4D05                             00000005
B4D06                             00000006
B4D07                             00000007
B4D1                              00000EC7
B4D10                             00000000
B4D11                             00000001
B4D12                             00000002
B4D13                             00000003
B4D14                             00000004
B4D15                             00000005
B4D16                             00000006
B4D17                             00000007
B4D2                              00000EC8
B4D20                             00000000
B4D21                             00000001
B4D22                             00000002
B4D23                             00000003
B4D24                             00000004
B4D25                             00000005
B4D26                             00000006
B4D27                             00000007
B4D3                              00000EC9
B4D30                             00000000
B4D31                             00000001
B4D32                             00000002
B4D33                             00000003
B4D34                             00000004
B4D35                             00000005
B4D36                             00000006
B4D37                             00000007
B4D4                              00000ECA
B4D40                             00000000
B4D41                             00000001
B4D42                             00000002
B4D43                             00000003
B4D44                             00000004
B4D45                             00000005
B4D46                             00000006
B4D47                             00000007
B4D5                              00000ECB
B4D50                             00000000
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 70


SYMBOL TABLE
  LABEL                             VALUE 

B4D51                             00000001
B4D52                             00000002
B4D53                             00000003
B4D54                             00000004
B4D55                             00000005
B4D56                             00000006
B4D57                             00000007
B4D6                              00000ECC
B4D60                             00000000
B4D61                             00000001
B4D62                             00000002
B4D63                             00000003
B4D64                             00000004
B4D65                             00000005
B4D66                             00000006
B4D67                             00000007
B4D7                              00000ECD
B4D70                             00000000
B4D71                             00000001
B4D72                             00000002
B4D73                             00000003
B4D74                             00000004
B4D75                             00000005
B4D76                             00000006
B4D77                             00000007
B4DLC                             00000EC5
B4EIDH                            00000EC3
B4EIDL                            00000EC4
B4IE                              00000006
B4SIDH                            00000EC1
B4SIDL                            00000EC2
B4TXEN                            00000006
B5CON                             00000ED0
B5D0                              00000ED6
B5D00                             00000000
B5D01                             00000001
B5D02                             00000002
B5D03                             00000003
B5D04                             00000004
B5D05                             00000005
B5D06                             00000006
B5D07                             00000007
B5D1                              00000ED7
B5D10                             00000000
B5D11                             00000001
B5D12                             00000002
B5D13                             00000003
B5D14                             00000004
B5D15                             00000005
B5D16                             00000006
B5D17                             00000007
B5D2                              00000ED8
B5D20                             00000000
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 71


SYMBOL TABLE
  LABEL                             VALUE 

B5D21                             00000001
B5D22                             00000002
B5D23                             00000003
B5D24                             00000004
B5D25                             00000005
B5D26                             00000006
B5D27                             00000007
B5D3                              00000ED9
B5D30                             00000000
B5D31                             00000001
B5D32                             00000002
B5D33                             00000003
B5D34                             00000004
B5D35                             00000005
B5D36                             00000006
B5D37                             00000007
B5D4                              00000EDA
B5D40                             00000000
B5D41                             00000001
B5D42                             00000002
B5D43                             00000003
B5D44                             00000004
B5D45                             00000005
B5D46                             00000006
B5D47                             00000007
B5D5                              00000EDB
B5D50                             00000000
B5D51                             00000001
B5D52                             00000002
B5D53                             00000003
B5D54                             00000004
B5D55                             00000005
B5D56                             00000006
B5D57                             00000007
B5D6                              00000EDC
B5D60                             00000000
B5D61                             00000001
B5D62                             00000002
B5D63                             00000003
B5D64                             00000004
B5D65                             00000005
B5D66                             00000006
B5D67                             00000007
B5D7                              00000EDD
B5D70                             00000000
B5D71                             00000001
B5D72                             00000002
B5D73                             00000003
B5D74                             00000004
B5D75                             00000005
B5D76                             00000006
B5D77                             00000007
B5DLC                             00000ED5
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 72


SYMBOL TABLE
  LABEL                             VALUE 

B5EIDH                            00000ED3
B5EIDL                            00000ED4
B5IE                              00000007
B5SIDH                            00000ED1
B5SIDL                            00000ED2
B5TXEN                            00000007
BANKED                            00000001
BAUDCON1                          00000FA7
BAUDCON2                          00000FB9
BAUDRATE                          500000
BCLIE                             00000003
BCLIF                             00000003
BCLIP                             00000003
BF                                00000000
BGVST                             00000006
BIE0                              00000E7E
BIN2ASC                           0000014A
BOR                               00000000
BRG1                              0x07
BRG16                             00000003
BRG2                              0xBC
BRG3                              0x01
BRGCON1                           00000E43
BRGCON2                           00000E44
BRGCON3                           00000E45
BRGH                              00000002
BRGH1                             00000002
BRGH2                             00000002
BRP0                              00000000
BRP1                              00000001
BRP2                              00000002
BRP3                              00000003
BRP4                              00000004
BRP5                              00000005
BSEL0                             00000E7D
BSR                               00000FE0
BUT_CT0                           00000034
BUT_CT1                           00000036
BUT_VAL_CHG                       0000003B
BUT_VAL_NEW                       0000003A
BUT_VAL_STATE                     0000003C
B_SAVE                            00000000
C                                 00000000
C1TSEL                            00000000
C2TSEL                            00000001
C3TSEL                            00000002
C4TSEL                            00000003
C5TSEL                            00000004
CAN                               PORTB
CANCAP                            00000004
CANCMD                            0000000C
CANCNT                            0000000E
CANCON                            00000F6F
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 73


SYMBOL TABLE
  LABEL                             VALUE 

CANCON_RO0                        00000F3F
CANCON_RO1                        00000F2F
CANCON_RO2                        00000F1F
CANCON_RO3                        00000F0F
CANCON_RO4                        00000EDF
CANCON_RO5                        00000ECF
CANCON_RO6                        00000EBF
CANCON_RO7                        00000EAF
CANCON_RO8                        00000E9F
CANCON_RO9                        00000E8F
CANFRAME                          0000000F
CANHASH_HIGH                      00000041
CANHASH_LOW                       00000040
CANID                             0000000D
CANINSPECT                        0000086A
CANOVFL                           
CANRATE                           250
CANRECV                           
CANSTAT                           00000F6E
CANSTAT_RO0                       00000F3E
CANSTAT_RO1                       00000F2E
CANSTAT_RO2                       00000F1E
CANSTAT_RO3                       00000F0E
CANSTAT_RO4                       00000EDE
CANSTAT_RO5                       00000ECE
CANSTAT_RO6                       00000EBE
CANSTAT_RO7                       00000EAE
CANSTAT_RO8                       00000E9E
CANSTAT_RO9                       00000E8E
CAN_PING                          000009F6
CAN_PING_CONT                     000009FC
CAN_REBOOT                        00000992
CAN_SWITCH_ACC                    00000996
CAN_SWITCH_ACC_FAULT              000009F4
CAN_SWITCH_ACC_NEXT1              0000099E
CAN_WIN_OFF                       0x00
CAN_WIN_RXB0                      0x0C
CAN_WIN_RXB1                      0x0A
CAN_WIN_TXB0                      0x08
CAN_WIN_TXB1                      0x06
CAN_WIN_TXB2                      0x04
CCH0                              00000000
CCH1                              00000001
CCP1CON                           00000FBB
CCP1IE                            00000001
CCP1IF                            00000001
CCP1IP                            00000001
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1MD                            00000003
CCP1OD                            00000002
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 74


SYMBOL TABLE
  LABEL                             VALUE 

CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           00000F50
CCP2IE                            00000002
CCP2IF                            00000002
CCP2IP                            00000002
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2MD                            00000004
CCP2OD                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCP3CON                           00000F4D
CCP3IE                            00000000
CCP3IF                            00000000
CCP3IP                            00000000
CCP3M0                            00000000
CCP3M1                            00000001
CCP3M2                            00000002
CCP3M3                            00000003
CCP3MD                            00000005
CCP3OD                            00000004
CCP3X                             00000005
CCP3Y                             00000004
CCP4CON                           00000F4A
CCP4IE                            00000001
CCP4IF                            00000001
CCP4IP                            00000001
CCP4M0                            00000000
CCP4M1                            00000001
CCP4M2                            00000002
CCP4M3                            00000003
CCP4MD                            00000006
CCP4OD                            00000005
CCP4X                             00000005
CCP4Y                             00000004
CCP5CON                           00000F47
CCP5IE                            00000002
CCP5IF                            00000002
CCP5IP                            00000002
CCP5M0                            00000000
CCP5M1                            00000001
CCP5M2                            00000002
CCP5M3                            00000003
CCP5MD                            00000007
CCP5OD                            00000006
CCP5X                             00000005
CCP5Y                             00000004
CCPR1                             00000FBC
CCPR1H                            00000FBD
CCPR1L                            00000FBC
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 75


SYMBOL TABLE
  LABEL                             VALUE 

CCPR2                             00000F51
CCPR2H                            00000F52
CCPR2L                            00000F51
CCPR3                             00000F4E
CCPR3H                            00000F4F
CCPR3L                            00000F4E
CCPR4                             00000F4B
CCPR4H                            00000F4C
CCPR4L                            00000F4B
CCPR5                             00000F48
CCPR5H                            00000F49
CCPR5L                            00000F48
CCPTMRS                           00000F99
CFGS                              00000006
CHECK_ID                          0000088C
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CHS4                              00000006
CHSN0                             00000000
CHSN1                             00000001
CHSN2                             00000002
CIOCON                            00000F70
CKE                               00000006
CKP                               00000004
CLKSEL                            00000000
CLOCK                             64000000
CLOSECMD                          'C'
CM                                00000005
CM1CON                            00000F5F
CM1CON1                           00000F5F
CM2CON                            00000F5E
CM2CON1                           00000F5E
CMP1IE                            00000004
CMP1IF                            00000004
CMP1IP                            00000004
CMP1MD                            00000000
CMP1OUT                           00000006
CMP2IE                            00000005
CMP2IF                            00000005
CMP2IP                            00000005
CMP2MD                            00000001
CMP2OUT                           00000007
CMPL0                             00000006
CMPL1                             00000007
CMSTAT                            00000FB4
CMSTATUS                          00000FB4
COE                               00000006
COMSTAT                           00000F71
CON                               00000007
CONTROL                           (3)
CPOL                              00000005
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 76


SYMBOL TABLE
  LABEL                             VALUE 

CREF                              00000002
CREN                              00000004
CREN1                             00000004
CREN2                             00000004
CSRC                              00000007
CSRC1                             00000007
CSRC2                             00000007
CTMUCONH                          00000F55
CTMUCONL                          00000F54
CTMUDS                            00000000
CTMUEN                            00000007
CTMUICON                          00000F53
CTMUIE                            00000003
CTMUIF                            00000003
CTMUIP                            00000003
CTMUMD                            00000006
CTMUSIDL                          00000005
CTTRIG                            00000000
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVR4                              00000004
CVRCON                            00000FB5
CVREN                             00000007
CVROE                             00000006
CVRSS                             00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DC3B0                             00000004
DC3B1                             00000005
DC4B0                             00000004
DC4B1                             00000005
DC5B0                             00000004
DC5B1                             00000005
DDR                               DDRB
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DEBUG_BUT                         00000035
DEBUG_TOP                         00000038
DJNZ                              
DLC0                              00000000
DLC1                              00000001
DLC2                              00000002
DLC3                              00000003
DONE                              00000001
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 77


SYMBOL TABLE
  LABEL                             VALUE 

DO_HEARTBEAT                      00000412
DO_PIO                            00000408
D_A                               00000005
D_NOT_A                           00000005
ECANCON                           00000F72
ECANMD                            00000002
ECCP1AS                           00000FBF
ECCP1AS0                          00000004
ECCP1AS1                          00000005
ECCP1AS2                          00000006
ECCP1ASE                          00000007
ECCP1CON                          00000FBB
ECCP1DEL                          00000FBE
ECCP2CON                          00000F50
EDG1POL                           00000004
EDG1SEL0                          00000002
EDG1SEL1                          00000003
EDG1STAT                          00000000
EDG2POL                           00000007
EDG2SEL0                          00000005
EDG2SEL1                          00000006
EDG2STAT                          00000001
EDGEN                             00000003
EDGSEQEN                          00000002
EDI16                             00000000
EDI17                             00000001
EEADR                             00000F74
EEADRH                            00000F75
EECON1                            00000F7F
EECON2                            00000F7E
EEDATA                            00000F73
EEIE                              00000006
EEIF                              00000006
EEIP                              00000006
EEPGD                             00000007
EEPROM_REFRESH                    00000452
EEPROM_REFRESH_LOOP               0000045E
EICODE0                           00000000
EICODE1                           00000001
EICODE1_ICODE0                    00000001
EICODE2                           00000002
EICODE2_ICODE1                    00000002
EICODE3                           00000003
EICODE3_ICODE2                    00000003
EICODE4                           00000004
EID0                              00000000
EID1                              00000001
EID10                             00000002
EID11                             00000003
EID12                             00000004
EID13                             00000005
EID14                             00000006
EID15                             00000007
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 78


SYMBOL TABLE
  LABEL                             VALUE 

EID16                             00000000
EID17                             00000001
EID2                              00000002
EID3                              00000003
EID4                              00000004
EID5                              00000005
EID6                              00000006
EID7                              00000007
EID8                              00000000
EID9                              00000001
ENDRHI                            00000005
EOLNCHAR                          0x0D
ERASE_DATA                        0000047C
ERRIE                             00000005
ERRIF                             00000005
ERRIP                             00000005
EVENTBUF                          00000400
EVENTBUFFER                       00000400
EVENTCNT                          00000053
EVENTPG                           00000056
EVENTPP                           00000054
EVENTTMP                          00000052
EVENTTXCAN                        00000782
EVENTUARTCONT                     0000081E
EVENTUARTFIN                      00000838
EVENTUARTLOOP                     0000082C
EVENT_RING_NORMALIZE              000008AA
EVPOL0                            00000003
EVPOL1                            00000004
EWARN                             00000000
EWIN0                             00000000
EWIN1                             00000001
EWIN2                             00000002
EWIN3                             00000003
EWIN4                             00000004
EXID                              00000003
EXIDE                             00000003
EXIDEN                            00000003
EXTDATA                           'T'
EXTRTR                            'R'
F0BP_0                            00000000
F0BP_1                            00000001
F0BP_2                            00000002
F0BP_3                            00000003
F10BP_0                           00000000
F10BP_1                           00000001
F10BP_2                           00000002
F10BP_3                           00000003
F11BP_0                           00000004
F11BP_1                           00000005
F11BP_2                           00000006
F11BP_3                           00000007
F12BP_0                           00000000
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 79


SYMBOL TABLE
  LABEL                             VALUE 

F12BP_1                           00000001
F12BP_2                           00000002
F12BP_3                           00000003
F13BP_0                           00000004
F13BP_1                           00000005
F13BP_2                           00000006
F13BP_3                           00000007
F14BP_0                           00000000
F14BP_1                           00000001
F14BP_2                           00000002
F14BP_3                           00000003
F15BP_0                           00000004
F15BP_1                           00000005
F15BP_2                           00000006
F15BP_3                           00000007
F1BP_0                            00000004
F1BP_1                            00000005
F1BP_2                            00000006
F1BP_3                            00000007
F2BP_0                            00000000
F2BP_1                            00000001
F2BP_2                            00000002
F2BP_3                            00000003
F3BP_0                            00000004
F3BP_1                            00000005
F3BP_2                            00000006
F3BP_3                            00000007
F4BP_0                            00000000
F4BP_1                            00000001
F4BP_2                            00000002
F4BP_3                            00000003
F5BP_0                            00000004
F5BP_1                            00000005
F5BP_2                            00000006
F5BP_3                            00000007
F6BP_0                            00000000
F6BP_1                            00000001
F6BP_2                            00000002
F6BP_3                            00000003
F7BP_0                            00000004
F7BP_1                            00000005
F7BP_2                            00000006
F7BP_3                            00000007
F8BP_0                            00000000
F8BP_1                            00000001
F8BP_2                            00000002
F8BP_3                            00000003
F9BP_0                            00000004
F9BP_1                            00000005
F9BP_2                            00000006
F9BP_3                            00000007
FAST                              00000001
FERR                              00000002
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 80


SYMBOL TABLE
  LABEL                             VALUE 

FERR1                             00000002
FERR2                             00000002
FIFOWM                            00000005
FIFOWMIE                          00000000
FIFOWMIF                          00000000
FIFOWMIP                          00000000
FIL0_0                            00000000
FIL0_1                            00000001
FIL10_0                           00000004
FIL10_1                           00000005
FIL11_0                           00000006
FIL11_1                           00000007
FIL12_0                           00000000
FIL12_1                           00000001
FIL13_0                           00000002
FIL13_1                           00000003
FIL14_0                           00000004
FIL14_1                           00000005
FIL15_0                           00000006
FIL15_1                           00000007
FIL1_0                            00000002
FIL1_1                            00000003
FIL2_0                            00000004
FIL2_1                            00000005
FIL3_0                            00000006
FIL3_1                            00000007
FIL4_0                            00000000
FIL4_1                            00000001
FIL5_0                            00000002
FIL5_1                            00000003
FIL6_0                            00000004
FIL6_1                            00000005
FIL7_0                            00000006
FIL7_1                            00000007
FIL8_0                            00000000
FIL8_1                            00000001
FIL9_0                            00000002
FIL9_1                            00000003
FILHIT0                           00000000
FILHIT0_TXPRI0                    00000000
FILHIT1                           00000001
FILHIT1_TXPRI1                    00000001
FILHIT2                           00000002
FILHIT2_RTREN                     00000002
FILHIT3                           00000003
FILHIT3_TXREQ                     00000003
FILHIT4                           00000004
FILHIT4_TXERR                     00000004
FIN_WRITE_DATA                    00000498
FLC0                              00000000
FLC1                              00000001
FLC2                              00000002
FLC3                              00000003
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 81


SYMBOL TABLE
  LABEL                             VALUE 

FLC4                              00000004
FP0                               00000000
FP1                               00000001
FP2                               00000002
FP3                               00000003
FREE                              00000004
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
GCEN                              00000007
GENEVENT                          000005AE
GENEVENTLOOP                      000005D4
GETC                              
GETEVENT_P                        
GETEVENT_P_NORM                   
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GIE_GIEH                          00000007
GO                                00000001
GO_NOT_DONE                       00000001
GPIO                              LATB
HEARTBEAT                         0000001E
HFIOFS                            00000002
HLVDCON                           00000FA8
HLVDEN                            00000004
HLVDIE                            00000002
HLVDIF                            00000002
HLVDIP                            00000002
HLVDL0                            00000000
HLVDL1                            00000001
HLVDL2                            00000002
HLVDL3                            00000003
I2CBAUD                           ((((CLOCK / I2CRATE) / 2) - 1) / 2)
I2CINIT                           00000438
I2CRATE                           400000
I2C_DAT                           00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
ICODE0                            00000001
ICODE1                            00000002
ICODE2                            00000003
ICODE20                           00000001
ICODE21                           00000002
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 82


SYMBOL TABLE
  LABEL                             VALUE 

IDISSEN                           00000001
IDLEN                             00000007
ID_H                              00000042
ID_L                              00000043
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INIT                              0000001C
INITCAN                           0000017A
INITCAN1                          00000182
INITCAN2                          000001D4
INITEVENTRING                     000006E6
INITRING                          00000114
INITUART                          00000086
INITUARTAGAIN                     0000009E
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INT3E                             00000005
INT3F                             00000002
INT3IE                            00000005
INT3IF                            00000002
INT3IP                            00000001
INT3P                             00000001
INTCON                            00000FF2
INTCON1                           00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INTEDG3                           00000003
INTSRC                            00000007
IOCB                              00000F5A
IOCB4                             00000004
IOCB5                             00000005
IOCB6                             00000006
IOCB7                             00000007
IPEN                              00000007
IPR1                              00000F9F
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 83


SYMBOL TABLE
  LABEL                             VALUE 

IPR2                              00000FA2
IPR3                              00000FA5
IPR4                              00000FB8
IPR5                              00000F78
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRNG0                             00000000
IRNG1                             00000001
IRVST                             00000005
IRXIE                             00000007
IRXIF                             00000007
IRXIP                             00000007
ISRHIGH                           000000BA
ISRHIGH1                          000000CC
ISRHIGH2                          000000DA
ISRHIGH3                          000000DC
ISRHIGHEND                        000000F0
ISRLOW                            000000F4
ISRLOWEND                         0000010C
ITRIM0                            00000002
ITRIM1                            00000003
ITRIM2                            00000004
ITRIM3                            00000005
ITRIM4                            00000006
ITRIM5                            00000007
JTOFF                             00000001
JTOFF_FILHIT1                     00000001
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA5                             00000005
LATA6                             00000006
LATA7                             00000007
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LATC6                             00000006
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 84


SYMBOL TABLE
  LABEL                             VALUE 

LATC7                             00000007
LATD                              00000F8C
LATD0                             00000000
LATD1                             00000001
LATD2                             00000002
LATD3                             00000003
LATD4                             00000004
LATD5                             00000005
LATD6                             00000006
LATD7                             00000007
LATE                              00000F8D
LATE0                             00000000
LATE1                             00000001
LATE2                             00000002
LED                               1
LEDHIGH                           1
LOAD_PWMMAX                       
LVDIE                             00000002
LVDIF                             00000002
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
MAIN                              00000068
MASK                              00000030
MDSEL0                            00000006
MDSEL1                            00000007
MFIOFS                            00000001
MFIOSEL                           00000000
MSEL0                             00000E79
MSEL1                             00000E7A
MSEL2                             00000E7B
MSEL3                             00000E7C
MSK0                              00000000
MSK1                              00000001
MSK2                              00000002
MSK3                              00000003
MSK4                              00000004
MSK5                              00000005
MSK6                              00000006
MSK7                              00000007
N                                 00000004
NIB2ASC                           
NORM_C1                           0000074A
NORM_C2                           00000852
NORM_POINTER1                     000008B2
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_CM                            00000005
NOT_DONE                          00000001
NOT_FIFOEMPTY                     00000007
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 85


SYMBOL TABLE
  LABEL                             VALUE 

NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_RI                            00000004
NOT_T1DONE                        00000003
NOT_T1SYNC                        00000002
NOT_T3DONE                        00000003
NOT_T3SYNC                        00000002
NOT_TO                            00000003
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
ODCON                             00000F91
OERR                              00000001
OERR1                             00000001
OERR2                             00000001
OPENCMD                           'O'
OPMODE0                           00000005
OPMODE1                           00000006
OPMODE2                           00000007
OSCCON                            00000FD3
OSCCON2                           00000FD2
OSCFIE                            00000007
OSCFIF                            00000007
OSCFIP                            00000007
OSCTUNE                           00000F9B
OSTS                              00000003
OV                                00000003
OVERFLOW                          (256 / 27)
P                                 00000004
P1DC0                             00000000
P1DC1                             00000001
P1DC2                             00000002
P1DC3                             00000003
P1DC4                             00000004
P1DC5                             00000005
P1DC6                             00000006
P1M0                              00000006
P1M1                              00000007
P1RSEN                            00000007
PADCFG1                           00000F56
PC                                00000FF9
PCBV                              2
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PEIE                              00000006
PEIE_GIEL                         00000006
PEN                               00000002
PIE1                              00000F9D
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 86


SYMBOL TABLE
  LABEL                             VALUE 

PIE2                              00000FA0
PIE3                              00000FA3
PIE4                              00000FB6
PIE5                              00000F76
PIO                               1
PIOC_H                            00000044
PIOC_L                            00000045
PIODEBOUNCE                       00000578
PIOGET                            000005E8
PIOINIT                           00000544
PIOINVERT                         1
PIOTCOUNTER                       0000001D
PIOTEMP                           0000002F
PIOTEMP16                         00000032
PIOTIME                           0000001F
PIR1                              00000F9E
PIR2                              00000FA1
PIR3                              00000FA4
PIR4                              00000FB7
PIR5                              00000F77
PLLEN                             00000006
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
PMD0                              00000F59
PMD1                              00000F58
PMD2                              00000F57
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTD                             00000F83
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
PR2                               00000FCB
PR4                               00000FA9
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PRSEG0                            00000000
PRSEG1                            00000001
PRSEG2                            00000002
PSA                               00000003
PSPCON                            00000F46
PSPIE                             00000007
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 87


SYMBOL TABLE
  LABEL                             VALUE 

PSPIF                             00000007
PSPIP                             00000007
PSPMD                             00000007
PSPMODE                           00000004
PSS1AC0                           00000002
PSS1AC1                           00000003
PSS1BD0                           00000000
PSS1BD1                           00000001
PSTR1CON                          00000F9C
PTIMECLLOOP                       00000570
PUTC                              
PUTEVENT                          000006FE
PWM1CON                           00000FBE
PWM1_LOAD_LOW                     0000067A
PWM2_LOAD_LOW                     0000069A
PWM3_LOAD_LOW                     000006BA
PWM4_LOAD_LOW                     000006DA
PWMINIT                           00000610
PWMMAX                            (40000)
PWM_10_HIGH                       ((PWM_PERIOD * 50) / 1000)
PWM_10_LOW                        (PWM_PERIOD - PWM_10_HIGH)
PWM_15_HIGH                       ((PWM_PERIOD * 75) / 1000)
PWM_15_LOW                        (PWM_PERIOD - PWM_15_HIGH)
PWM_20_HIGH                       ((PWM_PERIOD * 100) / 1000)
PWM_20_LOW                        (PWM_PERIOD - PWM_20_HIGH)
PWM_CHANNEL                       00000051
PWM_END                           000006E4
PWM_PERIOD                        (40000)
PWM_TEST                          00000664
PWM_TEST2                         00000684
PWM_TEST3                         000006A4
PWM_TEST4                         000006C4
PWM_VALUE1                        00000049
PWM_VALUE1_HIGH                   00000801
PWM_VALUE1_LOW                    00000800
PWM_VALUE2                        0000004B
PWM_VALUE2_HIGH                   00000803
PWM_VALUE2_LOW                    00000802
PWM_VALUE3                        0000004D
PWM_VALUE3_HIGH                   00000805
PWM_VALUE3_LOW                    00000804
PWM_VALUE4                        0000004F
PWM_VALUE4_LOW                    00000806
PWM_VALUE5_HIGH                   00000807
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA5                               00000005
RA6                               00000006
RA7                               00000007
RB0DBEN                           00000002
RB0DBEN_FILHIT2                   00000002
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 88


SYMBOL TABLE
  LABEL                             VALUE 

RB0_B0DLC                         00000004
RB0_B1DLC                         00000004
RB0_B2DLC                         00000004
RB0_B3DLC                         00000004
RB0_B4DLC                         00000004
RB0_B5DLC                         00000004
RB0_PORTB                         00000000
RB0_RXB0DLC                       00000004
RB0_RXB1DLC                       00000004
RB1_B0DLC                         00000005
RB1_B1DLC                         00000005
RB1_B2DLC                         00000005
RB1_B3DLC                         00000005
RB1_B4DLC                         00000005
RB1_B5DLC                         00000005
RB1_PORTB                         00000001
RB1_RXB0DLC                       00000005
RB1_RXB1DLC                       00000005
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC1IE                             00000005
RC1IF                             00000005
RC1IP                             00000005
RC2                               00000002
RC2IE                             00000005
RC2IF                             00000005
RC2IP                             00000005
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCMT                              00000006
RCON                              00000FD0
RCREG                             00000FAE
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 89


SYMBOL TABLE
  LABEL                             VALUE 

RCREG1                            00000FAE
RCREG2                            00000F7A
RCSTA                             00000FAB
RCSTA1                            00000FAB
RCSTA2                            00000FA6
RD                                00000000
RD0                               00000000
RD1                               00000001
RD16                              00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RDPU                              00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
READCANHASH                       00000524
READSTATUS                        'F'
READUID                           000004BC
READ_WRITE                        00000002
REC0                              00000000
REC1                              00000001
REC2                              00000002
REC3                              00000003
REC4                              00000004
REC5                              00000005
REC6                              00000006
REC7                              00000007
REFOCON                           00000F9A
REGSLP                            00000007
REPU                              00000006
REQOP0                            00000005
REQOP1                            00000006
REQOP2                            00000007
RESETUART                         000000B0
RI                                00000004
RODIV0                            00000000
RODIV1                            00000001
RODIV2                            00000002
RODIV3                            00000003
ROON                              00000007
ROSEL                             00000004
ROSSLP                            00000005
RSEN                              00000001
RTREN                             00000002
RTRRO                             00000005
RTSCLR                            
RTSSET                            
RX9                               00000006
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 90


SYMBOL TABLE
  LABEL                             VALUE 

RX91                              00000006
RX92                              00000006
RX9D                              00000000
RX9D1                             00000000
RX9D2                             00000000
RXB0CON                           00000F60
RXB0D0                            00000F66
RXB0D00                           00000000
RXB0D01                           00000001
RXB0D02                           00000002
RXB0D03                           00000003
RXB0D04                           00000004
RXB0D05                           00000005
RXB0D06                           00000006
RXB0D07                           00000007
RXB0D1                            00000F67
RXB0D10                           00000000
RXB0D11                           00000001
RXB0D12                           00000002
RXB0D13                           00000003
RXB0D14                           00000004
RXB0D15                           00000005
RXB0D16                           00000006
RXB0D17                           00000007
RXB0D2                            00000F68
RXB0D20                           00000000
RXB0D21                           00000001
RXB0D22                           00000002
RXB0D23                           00000003
RXB0D24                           00000004
RXB0D25                           00000005
RXB0D26                           00000006
RXB0D27                           00000007
RXB0D3                            00000F69
RXB0D30                           00000000
RXB0D31                           00000001
RXB0D32                           00000002
RXB0D33                           00000003
RXB0D34                           00000004
RXB0D35                           00000005
RXB0D36                           00000006
RXB0D37                           00000007
RXB0D4                            00000F6A
RXB0D40                           00000000
RXB0D41                           00000001
RXB0D42                           00000002
RXB0D43                           00000003
RXB0D44                           00000004
RXB0D45                           00000005
RXB0D46                           00000006
RXB0D47                           00000007
RXB0D5                            00000F6B
RXB0D50                           00000000
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 91


SYMBOL TABLE
  LABEL                             VALUE 

RXB0D51                           00000001
RXB0D52                           00000002
RXB0D53                           00000003
RXB0D54                           00000004
RXB0D55                           00000005
RXB0D56                           00000006
RXB0D57                           00000007
RXB0D6                            00000F6C
RXB0D60                           00000000
RXB0D61                           00000001
RXB0D62                           00000002
RXB0D63                           00000003
RXB0D64                           00000004
RXB0D65                           00000005
RXB0D66                           00000006
RXB0D67                           00000007
RXB0D7                            00000F6D
RXB0D70                           00000000
RXB0D71                           00000001
RXB0D72                           00000002
RXB0D73                           00000003
RXB0D74                           00000004
RXB0D75                           00000005
RXB0D76                           00000006
RXB0D77                           00000007
RXB0DBEN                          00000002
RXB0DLC                           00000F65
RXB0EIDH                          00000F63
RXB0EIDL                          00000F64
RXB0IE                            00000000
RXB0IF                            00000000
RXB0IP                            00000000
RXB0OVFL                          00000007
RXB0SIDH                          00000F61
RXB0SIDL                          00000F62
RXB1CON                           00000F30
RXB1D0                            00000F36
RXB1D00                           00000000
RXB1D01                           00000001
RXB1D02                           00000002
RXB1D03                           00000003
RXB1D04                           00000004
RXB1D05                           00000005
RXB1D06                           00000006
RXB1D07                           00000007
RXB1D1                            00000F37
RXB1D10                           00000000
RXB1D11                           00000001
RXB1D12                           00000002
RXB1D13                           00000003
RXB1D14                           00000004
RXB1D15                           00000005
RXB1D16                           00000006
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 92


SYMBOL TABLE
  LABEL                             VALUE 

RXB1D17                           00000007
RXB1D2                            00000F38
RXB1D20                           00000000
RXB1D21                           00000001
RXB1D22                           00000002
RXB1D23                           00000003
RXB1D24                           00000004
RXB1D25                           00000005
RXB1D26                           00000006
RXB1D27                           00000007
RXB1D3                            00000F39
RXB1D30                           00000000
RXB1D31                           00000001
RXB1D32                           00000002
RXB1D33                           00000003
RXB1D34                           00000004
RXB1D35                           00000005
RXB1D36                           00000006
RXB1D37                           00000007
RXB1D4                            00000F3A
RXB1D40                           00000000
RXB1D41                           00000001
RXB1D42                           00000002
RXB1D43                           00000003
RXB1D44                           00000004
RXB1D45                           00000005
RXB1D46                           00000006
RXB1D47                           00000007
RXB1D5                            00000F3B
RXB1D50                           00000000
RXB1D51                           00000001
RXB1D52                           00000002
RXB1D53                           00000003
RXB1D54                           00000004
RXB1D55                           00000005
RXB1D56                           00000006
RXB1D57                           00000007
RXB1D6                            00000F3C
RXB1D60                           00000000
RXB1D61                           00000001
RXB1D62                           00000002
RXB1D63                           00000003
RXB1D64                           00000004
RXB1D65                           00000005
RXB1D66                           00000006
RXB1D67                           00000007
RXB1D7                            00000F3D
RXB1D70                           00000000
RXB1D71                           00000001
RXB1D72                           00000002
RXB1D73                           00000003
RXB1D74                           00000004
RXB1D75                           00000005
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 93


SYMBOL TABLE
  LABEL                             VALUE 

RXB1D76                           00000006
RXB1D77                           00000007
RXB1DLC                           00000F35
RXB1EIDH                          00000F33
RXB1EIDL                          00000F34
RXB1IE                            00000001
RXB1IF                            00000001
RXB1IP                            00000001
RXB1OVFL                          00000006
RXB1SIDH                          00000F31
RXB1SIDL                          00000F32
RXBP                              00000003
RXBUF                             00000180
RXBnIE                            00000001
RXBnIF                            00000001
RXBnIP                            00000001
RXCAN                             000001DC
RXCANDLC                          0000028C
RXCANEOLN                         000002D6
RXCANLIMIT                        000001EA
RXCANMESG                         000002AA
RXCNT                             00000006
RXDTP                             00000005
RXERRCNT                          00000E41
RXEXT                             00000242
RXEXT_23_16                       
RXEXT_28_24                       
RXF0EIDH                          00000EE2
RXF0EIDL                          00000EE3
RXF0EN                            00000000
RXF0SIDH                          00000EE0
RXF0SIDL                          00000EE1
RXF10EIDH                         00000E5A
RXF10EIDL                         00000E5B
RXF10EN                           00000002
RXF10SIDH                         00000E58
RXF10SIDL                         00000E59
RXF11EIDH                         00000E5E
RXF11EIDL                         00000E5F
RXF11EN                           00000003
RXF11SIDH                         00000E5C
RXF11SIDL                         00000E5D
RXF12EIDH                         00000E62
RXF12EIDL                         00000E63
RXF12EN                           00000004
RXF12SIDH                         00000E60
RXF12SIDL                         00000E61
RXF13EIDH                         00000E66
RXF13EIDL                         00000E67
RXF13EN                           00000005
RXF13SIDH                         00000E64
RXF13SIDL                         00000E65
RXF14EIDH                         00000E6A
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 94


SYMBOL TABLE
  LABEL                             VALUE 

RXF14EIDL                         00000E6B
RXF14EN                           00000006
RXF14SIDH                         00000E68
RXF14SIDL                         00000E69
RXF15EIDH                         00000E6E
RXF15EIDL                         00000E6F
RXF15EN                           00000007
RXF15SIDH                         00000E6C
RXF15SIDL                         00000E6D
RXF1EIDH                          00000EE6
RXF1EIDL                          00000EE7
RXF1EN                            00000001
RXF1SIDH                          00000EE4
RXF1SIDL                          00000EE5
RXF2EIDH                          00000EEA
RXF2EIDL                          00000EEB
RXF2EN                            00000002
RXF2SIDH                          00000EE8
RXF2SIDL                          00000EE9
RXF3EIDH                          00000EEE
RXF3EIDL                          00000EEF
RXF3EN                            00000003
RXF3SIDH                          00000EEC
RXF3SIDL                          00000EED
RXF4EIDH                          00000EF2
RXF4EIDL                          00000EF3
RXF4EN                            00000004
RXF4SIDH                          00000EF0
RXF4SIDL                          00000EF1
RXF5EIDH                          00000EF6
RXF5EIDL                          00000EF7
RXF5EN                            00000005
RXF5SIDH                          00000EF4
RXF5SIDL                          00000EF5
RXF6EIDH                          00000E4A
RXF6EIDL                          00000E4B
RXF6EN                            00000006
RXF6SIDH                          00000E48
RXF6SIDL                          00000E49
RXF7EIDH                          00000E4E
RXF7EIDL                          00000E4F
RXF7EN                            00000007
RXF7SIDH                          00000E4C
RXF7SIDL                          00000E4D
RXF8EIDH                          00000E52
RXF8EIDL                          00000E53
RXF8EN                            00000000
RXF8SIDH                          00000E50
RXF8SIDL                          00000E51
RXF9EIDH                          00000E56
RXF9EIDL                          00000E57
RXF9EN                            00000001
RXF9SIDH                          00000E54
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 95


SYMBOL TABLE
  LABEL                             VALUE 

RXF9SIDL                          00000E55
RXFBCON0                          00000E71
RXFBCON1                          00000E72
RXFBCON2                          00000E73
RXFBCON3                          00000E74
RXFBCON4                          00000E75
RXFBCON5                          00000E76
RXFBCON6                          00000E77
RXFBCON7                          00000E78
RXFCON0                           00000E46
RXFCON1                           00000E47
RXFUL                             00000007
RXFUL_TXBIF                       00000007
RXGET                             00000003
RXM0                              00000005
RXM0EIDH                          00000EFA
RXM0EIDL                          00000EFB
RXM0SIDH                          00000EF8
RXM0SIDL                          00000EF9
RXM0_RTRRO                        00000005
RXM1                              00000006
RXM1EIDH                          00000EFE
RXM1EIDL                          00000EFF
RXM1SIDH                          00000EFC
RXM1SIDL                          00000EFD
RXM1_TXABT                        00000006
RXOVF                             00000005
RXPACKET                          000001F6
RXPUT                             00000004
RXRTR                             00000006
RXRTRRO_B0CON                     00000005
RXRTRRO_B1CON                     00000005
RXRTRRO_B2CON                     00000005
RXRTRRO_B3CON                     00000005
RXRTRRO_B4CON                     00000005
RXRTRRO_B5CON                     00000005
RXRTRRO_FILHIT3                   00000003
RXRTRRO_RXB0CON                   00000003
RXRTRRO_RXB1CON                   00000003
RXRTRRO_TXLARB                    00000005
RXRTR_TXRTR                       00000006
RXSID_10_8                        
RXSID_7_0                         
RXSTD                             000001FE
RXWARN                            00000001
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
S88C_H                            00000046
S88C_L                            00000047
SAM                               00000006
SBOREN                            00000006
SCAN_INTERVAL                     00000048
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 96


SYMBOL TABLE
  LABEL                             VALUE 

SCHEDULE                          000003FA
SCS0                              00000000
SCS1                              00000001
SDFLC                             00000E70
SEG1PH0                           00000003
SEG1PH1                           00000004
SEG1PH2                           00000005
SEG2PH0                           00000000
SEG2PH1                           00000001
SEG2PH2                           00000002
SEG2PHTS                          00000007
SEN                               00000000
SENDB                             00000003
SENDB1                            00000003
SENDB2                            00000003
SENDEVENT                         00000762
SETLOCIDP                         000004B2
SETUID                            000004EC
SETUP_VALUE                       00000912
SETUP_VALUE_CONT1                 00000922
SETUP_VALUE_CONT2                 00000932
SETUP_VALUE_CONT3                 00000942
SETUP_VALUE_CONT4                 0000094E
SETUP_VALUE_TEST                  00000958
SETUP_VALUE_WRITE                 00000950
SID0                              00000005
SID1                              00000006
SID10                             00000007
SID2                              00000007
SID3                              00000000
SID4                              00000001
SID5                              00000002
SID6                              00000003
SID7                              00000004
SID8                              00000005
SID9                              00000006
SJW0                              00000006
SJW1                              00000007
SLRA                              00000000
SLRB                              00000001
SLRC                              00000002
SLRCON                            00000F90
SLRD                              00000003
SLRE                              00000004
SMP                               00000007
SOSCDRV                           00000004
SOSCEN                            00000003
SOSCGO                            00000003
SOSCRUN                           00000006
SP0                               00000000
SP1                               00000001
SP2                               00000002
SP3                               00000003
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 97


SYMBOL TABLE
  LABEL                             VALUE 

SP4                               00000004
SPBRG                             00000FAF
SPBRG1                            00000FAF
SPBRG2                            00000F7B
SPBRGH1                           00000F7D
SPBRGH2                           00000F7C
SPEN                              00000007
SPEN1                             00000007
SPEN2                             00000007
SREN                              00000005
SREN1                             00000005
SREN2                             00000005
SRETEN                            00000004
SRR                               00000004
SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMD                             00000000
SSPOD                             00000007
SSPOV                             00000006
SSPSTAT                           00000FC7
STATUS                            00000FD8
STATUS_LED_OFF                    00000430
STATUS_LED_ON                     00000434
STDDATA                           't'
STDRTR                            'r'
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
STKUNF                            00000006
STRA                              00000000
STRB                              00000001
STRC                              00000002
STRD                              00000003
STRSYNC                           00000004
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
SYNC1                             00000004
SYNC2                             00000004
SYSYTEM_CMD                       000008CA
SYSYTEM_CMD_NEXT1                 000008DA
SYSYTEM_CMD_OTHER                 000008E6
S_SAVE                            00000001
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 98


SYMBOL TABLE
  LABEL                             VALUE 

T08BIT                            00000006
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1GCON                            00000FAA
T1GGO                             00000003
T1GGO_NOT_T1DONE                  00000003
T1GPOL                            00000006
T1GSPM                            00000004
T1GSS0                            00000000
T1GSS1                            00000001
T1GTM                             00000005
T1GVAL                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
T3GCON                            00000FB0
T3GGO                             00000003
T3GGO_NOT_T3DONE                  00000003
T3GPOL                            00000006
T3GSPM                            00000004
T3GSS0                            00000000
T3GSS1                            00000001
T3GTM                             00000005
T3GVAL                            00000002
T4CKPS0                           00000000
T4CKPS1                           00000001
T4CON                             00000F88
T4OUTPS0                          00000003
T4OUTPS1                          00000004
T4OUTPS2                          00000005
T4OUTPS3                          00000006
TABLAT                            00000FF5
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 99


SYMBOL TABLE
  LABEL                             VALUE 

TCOUNTER                          0000001C
TEC0                              00000000
TEC1                              00000001
TEC2                              00000002
TEC3                              00000003
TEC4                              00000004
TEC5                              00000005
TEC6                              00000006
TEC7                              00000007
TEMP16                            00000800
TGEN                              00000004
THE                               00000A36
TIMER0INIT                        000003EE
TMR0                              00000FD6
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0MD                            00000000
TMR0ON                            00000007
TMR1                              00000FCE
TMR1CS0                           00000006
TMR1CS1                           00000007
TMR1GE                            00000007
TMR1GIE                           00000002
TMR1GIF                           00000002
TMR1GIP                           00000002
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1MD                            00000001
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2MD                            00000002
TMR2ON                            00000002
TMR3                              00000FB2
TMR3CS0                           00000006
TMR3CS1                           00000007
TMR3GE                            00000007
TMR3GIE                           00000000
TMR3GIF                           00000000
TMR3GIP                           00000000
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 100


SYMBOL TABLE
  LABEL                             VALUE 

TMR3MD                            00000003
TMR3ON                            00000000
TMR4                              00000F87
TMR4IE                            00000007
TMR4IF                            00000007
TMR4IP                            00000007
TMR4MD                            00000004
TMR4ON                            00000002
TO                                00000003
TOP_CT0                           00000037
TOP_CT1                           00000039
TOP_VAL_CHG                       0000003E
TOP_VAL_NEW                       0000003D
TOP_VAL_STATE                     0000003F
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TRIGSEL0                          00000006
TRIGSEL1                          00000007
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000F95
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 101


SYMBOL TABLE
  LABEL                             VALUE 

TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000F96
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TRMT1                             00000001
TRMT2                             00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TUN5                              00000005
TX1IE                             00000004
TX1IF                             00000004
TX1IP                             00000004
TX2EN                             00000006
TX2IE                             00000004
TX2IF                             00000004
TX2IP                             00000004
TX2SRC                            00000007
TX8_9                             00000006
TX9                               00000006
TX91                              00000006
TX92                              00000006
TX9D                              00000000
TX9D1                             00000000
TX9D2                             00000000
TXABT                             00000006
TXB0CON                           00000F20
TXB0D0                            00000F26
TXB0D00                           00000000
TXB0D01                           00000001
TXB0D02                           00000002
TXB0D03                           00000003
TXB0D04                           00000004
TXB0D05                           00000005
TXB0D06                           00000006
TXB0D07                           00000007
TXB0D1                            00000F27
TXB0D10                           00000000
TXB0D11                           00000001
TXB0D12                           00000002
TXB0D13                           00000003
TXB0D14                           00000004
TXB0D15                           00000005
TXB0D16                           00000006
TXB0D17                           00000007
TXB0D2                            00000F28
TXB0D20                           00000000
TXB0D21                           00000001
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 102


SYMBOL TABLE
  LABEL                             VALUE 

TXB0D22                           00000002
TXB0D23                           00000003
TXB0D24                           00000004
TXB0D25                           00000005
TXB0D26                           00000006
TXB0D27                           00000007
TXB0D3                            00000F29
TXB0D30                           00000000
TXB0D31                           00000001
TXB0D32                           00000002
TXB0D33                           00000003
TXB0D34                           00000004
TXB0D35                           00000005
TXB0D36                           00000006
TXB0D37                           00000007
TXB0D4                            00000F2A
TXB0D40                           00000000
TXB0D41                           00000001
TXB0D42                           00000002
TXB0D43                           00000003
TXB0D44                           00000004
TXB0D45                           00000005
TXB0D46                           00000006
TXB0D47                           00000007
TXB0D5                            00000F2B
TXB0D50                           00000000
TXB0D51                           00000001
TXB0D52                           00000002
TXB0D53                           00000003
TXB0D54                           00000004
TXB0D55                           00000005
TXB0D56                           00000006
TXB0D57                           00000007
TXB0D6                            00000F2C
TXB0D60                           00000000
TXB0D61                           00000001
TXB0D62                           00000002
TXB0D63                           00000003
TXB0D64                           00000004
TXB0D65                           00000005
TXB0D66                           00000006
TXB0D67                           00000007
TXB0D7                            00000F2D
TXB0D70                           00000000
TXB0D71                           00000001
TXB0D72                           00000002
TXB0D73                           00000003
TXB0D74                           00000004
TXB0D75                           00000005
TXB0D76                           00000006
TXB0D77                           00000007
TXB0DLC                           00000F25
TXB0EIDH                          00000F23
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 103


SYMBOL TABLE
  LABEL                             VALUE 

TXB0EIDL                          00000F24
TXB0IE                            00000002
TXB0IF                            00000002
TXB0IP                            00000002
TXB0SIDH                          00000F21
TXB0SIDL                          00000F22
TXB1CON                           00000F10
TXB1D0                            00000F16
TXB1D00                           00000000
TXB1D01                           00000001
TXB1D02                           00000002
TXB1D03                           00000003
TXB1D04                           00000004
TXB1D05                           00000005
TXB1D06                           00000006
TXB1D07                           00000007
TXB1D1                            00000F17
TXB1D10                           00000000
TXB1D11                           00000001
TXB1D12                           00000002
TXB1D13                           00000003
TXB1D14                           00000004
TXB1D15                           00000005
TXB1D16                           00000006
TXB1D17                           00000007
TXB1D2                            00000F18
TXB1D20                           00000000
TXB1D21                           00000001
TXB1D22                           00000002
TXB1D23                           00000003
TXB1D24                           00000004
TXB1D25                           00000005
TXB1D26                           00000006
TXB1D27                           00000007
TXB1D3                            00000F19
TXB1D30                           00000000
TXB1D31                           00000001
TXB1D32                           00000002
TXB1D33                           00000003
TXB1D34                           00000004
TXB1D35                           00000005
TXB1D36                           00000006
TXB1D37                           00000007
TXB1D4                            00000F1A
TXB1D40                           00000000
TXB1D41                           00000001
TXB1D42                           00000002
TXB1D43                           00000003
TXB1D44                           00000004
TXB1D45                           00000005
TXB1D46                           00000006
TXB1D47                           00000007
TXB1D5                            00000F1B
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 104


SYMBOL TABLE
  LABEL                             VALUE 

TXB1D50                           00000000
TXB1D51                           00000001
TXB1D52                           00000002
TXB1D53                           00000003
TXB1D54                           00000004
TXB1D55                           00000005
TXB1D56                           00000006
TXB1D57                           00000007
TXB1D6                            00000F1C
TXB1D60                           00000000
TXB1D61                           00000001
TXB1D62                           00000002
TXB1D63                           00000003
TXB1D64                           00000004
TXB1D65                           00000005
TXB1D66                           00000006
TXB1D67                           00000007
TXB1D7                            00000F1D
TXB1D70                           00000000
TXB1D71                           00000001
TXB1D72                           00000002
TXB1D73                           00000003
TXB1D74                           00000004
TXB1D75                           00000005
TXB1D76                           00000006
TXB1D77                           00000007
TXB1DLC                           00000F15
TXB1EIDH                          00000F13
TXB1EIDL                          00000F14
TXB1IE                            00000003
TXB1IF                            00000003
TXB1IP                            00000003
TXB1SIDH                          00000F11
TXB1SIDL                          00000F12
TXB2CON                           00000F00
TXB2D0                            00000F06
TXB2D00                           00000000
TXB2D01                           00000001
TXB2D02                           00000002
TXB2D03                           00000003
TXB2D04                           00000004
TXB2D05                           00000005
TXB2D06                           00000006
TXB2D07                           00000007
TXB2D1                            00000F07
TXB2D10                           00000000
TXB2D11                           00000001
TXB2D12                           00000002
TXB2D13                           00000003
TXB2D14                           00000004
TXB2D15                           00000005
TXB2D16                           00000006
TXB2D17                           00000007
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 105


SYMBOL TABLE
  LABEL                             VALUE 

TXB2D2                            00000F08
TXB2D20                           00000000
TXB2D21                           00000001
TXB2D22                           00000002
TXB2D23                           00000003
TXB2D24                           00000004
TXB2D25                           00000005
TXB2D26                           00000006
TXB2D27                           00000007
TXB2D3                            00000F09
TXB2D30                           00000000
TXB2D31                           00000001
TXB2D32                           00000002
TXB2D33                           00000003
TXB2D34                           00000004
TXB2D35                           00000005
TXB2D36                           00000006
TXB2D37                           00000007
TXB2D4                            00000F0A
TXB2D40                           00000000
TXB2D41                           00000001
TXB2D42                           00000002
TXB2D43                           00000003
TXB2D44                           00000004
TXB2D45                           00000005
TXB2D46                           00000006
TXB2D47                           00000007
TXB2D5                            00000F0B
TXB2D50                           00000000
TXB2D51                           00000001
TXB2D52                           00000002
TXB2D53                           00000003
TXB2D54                           00000004
TXB2D55                           00000005
TXB2D56                           00000006
TXB2D57                           00000007
TXB2D6                            00000F0C
TXB2D60                           00000000
TXB2D61                           00000001
TXB2D62                           00000002
TXB2D63                           00000003
TXB2D64                           00000004
TXB2D65                           00000005
TXB2D66                           00000006
TXB2D67                           00000007
TXB2D7                            00000F0D
TXB2D70                           00000000
TXB2D71                           00000001
TXB2D72                           00000002
TXB2D73                           00000003
TXB2D74                           00000004
TXB2D75                           00000005
TXB2D76                           00000006
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 106


SYMBOL TABLE
  LABEL                             VALUE 

TXB2D77                           00000007
TXB2DLC                           00000F05
TXB2EIDH                          00000F03
TXB2EIDL                          00000F04
TXB2IE                            00000004
TXB2IF                            00000004
TXB2IP                            00000004
TXB2SIDH                          00000F01
TXB2SIDL                          00000F02
TXBIE                             00000E7F
TXBIF                             00000007
TXBO                              00000005
TXBP                              00000004
TXBUF                             00000280
TXBnIE                            00000004
TXBnIF                            00000004
TXBnIP                            00000004
TXCAN                             000002EC
TXCAN1                            000002F2
TXCAN2                            0000030A
TXCAN3                            0000039C
TXCAN4                            000003B2
TXCAN5                            000003D8
TXCANEND                          000003DA
TXCANEXT                          00000354
TXCANRET                          000003EC
TXCANSTD                          0000032A
TXCKP                             00000004
TXCNT                             0000000A
TXD8                              00000000
TXEN                              00000005
TXEN1                             00000005
TXEN2                             00000005
TXERR                             00000004
TXERRCNT                          00000E42
TXEXT_17_16                       
TXEXT_20_18                       
TXEXT_23_21                       
TXEXT_28_24                       
TXGET                             00000007
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXLARB                            00000005
TXPRI0                            00000000
TXPRI1                            00000001
TXPUT                             00000008
TXREG                             00000FAD
TXREG1                            00000FAD
TXREG2                            00000F79
TXREQ                             00000003
TXRTR                             00000006
TXSID_10_8                        
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 107


SYMBOL TABLE
  LABEL                             VALUE 

TXSID_2_0                         
TXSID_7_3                         
TXSTA                             00000FAC
TXSTA1                            00000FAC
TXSTA2                            00000FBA
TXTEMP                            00000009
TXWARN                            00000002
U1OD                              00000000
U2OD                              00000001
UA                                00000001
UART                              PORTD
UART1MD                           00000001
UART2MD                           00000002
UARTOVFL                          
UARTRECV                          
UBAUD                             ((((CLOCK / BAUDRATE) / 2) - 1) / 2)
UBAUDCON                          BAUDCON2
UIPR                              IPR3
ULPEN                             00000002
ULPLVL                            00000005
ULPSINK                           00000001
UPIE                              PIE3
UPIR                              PIR3
URCIE                             RC2IE
URCIF                             RC2IF
URCIP                             RC2IP
URCREG                            RCREG2
URCSTA                            RCSTA2
USPBRG                            SPBRG2
USPBRGH                           SPBRGH2
UTXIE                             TX2IE
UTXIF                             TX2IF
UTXIP                             TX2IP
UTXREG                            TXREG2
UTXSTA                            TXSTA2
VCFG0                             00000004
VCFG1                             00000005
VDIRMAG                           00000007
VNCFG                             00000003
W                                 00000000
WAKDIS                            00000007
WAKFIL                            00000006
WAKIE                             00000006
WAKIF                             00000006
WAKIP                             00000006
WCOL                              00000007
WDTCON                            00000FD1
WIN0                              00000001
WIN0_FP1                          00000001
WIN1                              00000002
WIN1_FP2                          00000002
WIN2                              00000003
WIN2_FP3                          00000003
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 108


SYMBOL TABLE
  LABEL                             VALUE 

WPUB                              00000F5B
WPUB0                             00000000
WPUB1                             00000001
WPUB2                             00000002
WPUB3                             00000003
WPUB4                             00000004
WPUB5                             00000005
WPUB6                             00000006
WPUB7                             00000007
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
WUE                               00000001
W_SAVE                            00000002
Z                                 00000002
_BBSIZ_BB1K_4L                    000000EF
_BBSIZ_BB2K_4L                    000000FF
_BOREN_NOSLP_2L                   000000FD
_BOREN_OFF_2L                     000000F9
_BOREN_ON_2L                      000000FB
_BOREN_SBORDIS_2L                 000000FF
_BORPWR_HIGH_2L                   000000DF
_BORPWR_LOW_2L                    0000009F
_BORPWR_MEDIUM_2L                 000000BF
_BORPWR_ZPBORMV_2L                000000FF
_BORV_0_2L                        000000E7
_BORV_1_2L                        000000EF
_BORV_2_2L                        000000F7
_BORV_3_2L                        000000FF
_CANMX_PORTB_3H                   000000FF
_CANMX_PORTC_3H                   000000FE
_CONFIG1H                         00300001
_CONFIG1L                         00300000
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CP2_OFF_5L                       000000FF
_CP2_ON_5L                        000000FB
_CP3_OFF_5L                       000000FF
_CP3_ON_5L                        000000F7
_CPB_OFF_5H                       000000FF
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 109


SYMBOL TABLE
  LABEL                             VALUE 

_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
_CPD_ON_5H                        0000007F
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTR2_OFF_7L                     000000FF
_EBTR2_ON_7L                      000000FB
_EBTR3_OFF_7L                     000000FF
_EBTR3_ON_7L                      000000F7
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_FCMEN_OFF_1H                     000000BF
_FCMEN_ON_1H                      000000FF
_FOSC_EC1IO_1H                    000000FC
_FOSC_EC1_1H                      000000FD
_FOSC_EC2IO_1H                    000000FA
_FOSC_EC2_1H                      000000FB
_FOSC_EC3IO_1H                    000000F4
_FOSC_EC3_1H                      000000F5
_FOSC_HS1_1H                      000000F3
_FOSC_HS2_1H                      000000F2
_FOSC_INTIO1_1H                   000000F9
_FOSC_INTIO2_1H                   000000F8
_FOSC_LP_1H                       000000F0
_FOSC_RCIO_1H                     000000F7
_FOSC_RC_1H                       000000F6
_FOSC_XT_1H                       000000F1
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_INTOSCSEL_HIGH_1L                000000FF
_INTOSCSEL_LOW_1L                 000000FB
_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_MSSPMSK_MSK5_3H                  000000F7
_MSSPMSK_MSK7_3H                  000000FF
_PLLCFG_OFF_1H                    000000EF
_PLLCFG_ON_1H                     000000FF
_PWRTEN_OFF_2L                    000000FF
_PWRTEN_ON_2L                     000000FE
_RETEN_OFF_1L                     000000FF
_RETEN_ON_1L                      000000FE
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 110


SYMBOL TABLE
  LABEL                             VALUE 

_SOSCSEL_DIG_1L                   000000F7
_SOSCSEL_HIGH_1L                  000000FF
_SOSCSEL_LOW_1L                   000000EF
_STVREN_OFF_4L                    000000FE
_STVREN_ON_4L                     000000FF
_WDTEN_NOSLP_2H                   000000FD
_WDTEN_OFF_2H                     000000FC
_WDTEN_ON_2H                      000000FE
_WDTEN_SWDTDIS_2H                 000000FF
_WDTPS_1024_2H                    000000AB
_WDTPS_1048576_2H                 000000FF
_WDTPS_128_2H                     0000009F
_WDTPS_131072_2H                  000000C7
_WDTPS_16384_2H                   000000BB
_WDTPS_16_2H                      00000093
_WDTPS_1_2H                       00000083
_WDTPS_2048_2H                    000000AF
_WDTPS_256_2H                     000000A3
_WDTPS_262144_2H                  000000CB
_WDTPS_2_2H                       00000087
_WDTPS_32768_2H                   000000BF
_WDTPS_32_2H                      00000097
_WDTPS_4096_2H                    000000B3
_WDTPS_4_2H                       0000008B
_WDTPS_512_2H                     000000A7
_WDTPS_524288_2H                  000000CF
_WDTPS_64_2H                      0000009B
_WDTPS_65536_2H                   000000C3
_WDTPS_8192_2H                    000000B7
_WDTPS_8_2H                       0000008F
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRT2_OFF_6L                      000000FF
_WRT2_ON_6L                       000000FB
_WRT3_OFF_6L                      000000FF
_WRT3_ON_6L                       000000F7
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
_WRTD_ON_6H                       0000007F
_XINST_OFF_1L                     000000BF
_XINST_ON_1L                      000000FF
__18F45K80                        00000001
__ACC_RAM_LOW_END                 0000005F
__ACC_RAM_LOW_START               00000000
__CODE_END                        00007FFF
__CODE_START                      00000000
__EEPROM_END                      00F003FF
__EEPROM_START                    00F00000
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 111


SYMBOL TABLE
  LABEL                             VALUE 

__VECTOR_INT_HIGH                 00000008
__VECTOR_INT_LOW                  00000018
__VECTOR_RESET                    00000000


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXX----XXXX---- --------XXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
05C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
06C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
07C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
09C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXX----------
0000 : XXXX-XX-XXXXXX-- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Bytes Used:  2610
gpasm-1.4.0 #1149 (Oct 14 2015) canbuster_4xk   4-17-2016  10:44:16         PAGE 112


SYMBOL TABLE
  LABEL                             VALUE 

Program Memory Bytes Free: 30158


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,   374 suppressed

